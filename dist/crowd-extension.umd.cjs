(function(){"use strict";try{if(typeof document<"u"){var t=document.createElement("style");t.id="crowd-app-io-10.510684466801878",t.appendChild(document.createTextNode(".crowd-prompt{position:fixed}.crowd-prompt iframe{z-index:1100;background-color:transparent!important;background:transparent!important;border:none}.crowd-prompt .prompt-body-frame{width:470px;background:transparent;position:fixed;box-shadow:#00000029 0 5px 5px;-webkit-box-shadow:rgba(0,0,0,.16) 0px 5px 5px;-moz-box-shadow:rgba(0,0,0,.16) 0px 5px 6px;border-radius:10px}@media (max-width: 600px){.crowd-prompt .prompt-body-frame{width:100%!important}}.prompt-body-frame.prompt-panel-bottom-right{position:fixed;right:10px;bottom:10px}.prompt-body-frame.prompt-panel-bottom-left{position:fixed;left:10px;bottom:10px}.prompt-body-frame.prompt-panel-middle-left{position:fixed;left:-2px;top:50%;transform:translate(-50%) rotate(-90deg);transform-origin:50% 0%}.prompt-body-frame.prompt-panel-middle-right{position:fixed;top:50%;right:0;transform:rotate(-90deg) translate(50%,-50%);transform-origin:100% 50%}@media (max-width: 600px){.prompt-body-frame.prompt-panel-bottom-right{right:0;bottom:0}.prompt-body-frame.prompt-panel-bottom-left{left:0;bottom:0}.prompt-body-frame.prompt-panel-middle-left{left:0;transform:translateY(0);top:auto!important;bottom:0}.prompt-body-frame.prompt-panel-middle-right{right:0;transform:translateY(0);top:auto!important;bottom:0}}")),document.head.appendChild(t)}}catch(o){console.error("vite-plugin-css-injected-by-js",o)}})();
(function(r){typeof define=="function"&&define.amd?define(r):r()})(function(){"use strict";var A=Object.defineProperty;var S=(r,i,d)=>i in r?A(r,i,{enumerable:!0,configurable:!0,writable:!0,value:d}):r[i]=d;var l=(r,i,d)=>(S(r,typeof i!="symbol"?i+"":i,d),d);const r="",i=t=>`${t}-${new Date().getTime()}${Math.floor(Math.random()*100)}`,d=()=>{const t=window.location.href,e=new URL(t);return{hostname:e.hostname,origin:e.origin}},I=()=>{const t=navigator.userAgent;return/Android|webOS|iPhone|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)?"Mobile":/Tablet|iPad/i.test(t)?"Tablet":"Desktop"},P=[{label:"Do not reshow",value:"0_hours"},{label:"Reshow after 24 hours",value:"24_hours"},{label:"Reshow after 3 days",value:"72_hours"},{label:"Reshow after 1 week",value:"168_hours"}];var a=(t=>(t.PromptLoaded="PROMPTLOADED",t.GetPromptSize="GETPROMPTSIZE",t.PromptResize="PROMPTRESIZE",t.LastPromptUnmoderatedId="LASTPROMPTUNMODERATEDID",t.RemovePrompt="REMOVEPROMPT",t.CheckDeviceCompatibility="CHECKDEVICECOMPATIBILITY",t.PaginateUnmoderatedTest="PAGINATEUNMODERATEDTEST",t.StoreUserTestId="STOREMODERATEDTESTID",t))(a||{});const g="crowd-ignored-unmoderated-test",u="crowd-answered-unmoderated-test",T=(t,e,n)=>{const o=new Date;o.setTime(o.getTime()+n*24*60*60*1e3);const s=`${t}=${encodeURIComponent(JSON.stringify(e))}; expires=${o.toUTCString()}; path=/`;document.cookie=s},f=t=>{const n=document.cookie.split(";");let o=null;return n.forEach(s=>{const[p,c]=s.trim().split("=");p===t&&(o=JSON.parse(decodeURIComponent(c)))}),o===null?[]:o},y=(t,e)=>{const n=`${g}-${new Date().getTime()}`,o=new Date;o.setTime(o.getTime()+e*24*60*60*1e3);const s=`${n}=${encodeURIComponent(t)}; expires=${o.toUTCString()}; path=/`;document.cookie=s},b=()=>{const t=new RegExp(`^${g}`),n=document.cookie.split(";"),o=[];for(let s of n){const[p,c]=s.split("=").map(m=>m.trim());t.test(p)&&o.push(c)}return o},E=t=>{const e=P.findIndex(n=>n.value===t);if(e!==1){const o=P[e].value.split("_")[0];return Number(o)===0?180:Number(o)/24}else return 180},R=(t,e)=>{const n=window.location.href.replace(/\/$/,""),o=new URL(n);return t==="start_with"?o.pathname.startsWith(e):t==="end_with"?o.pathname.endsWith(e):t==="contains"?o.pathname.includes(e):t==="exactly_matches"?o.pathname===e:t==="is_not"?o.pathname!==e:t==="matches_regex"?new RegExp(e,"i").test(o.pathname):!1},C=t=>{const e=I();return e==="Mobile"&&t.mobile||e==="Desktop"&&t.desktop||e==="Tablet"&&t.tablet},D=async t=>{if(t.visibilityOption==="ALLPAGES")return{position:t.promptPosition};if(t.visibilityOption==="SPECIFICPAGES"){const e=t.targetPages.filter(n=>R(n.optionName,n.optionValue));return C(t.deviceSupported)&&e.length>0?{position:t.promptPosition}:!1}else return!1},h="https://staging.crowdapp.io",U="https://staging.crowdapp.io/crowd-extension/unmoderated-test",k=()=>{if(window.CrowdApp&&window.CrowdApp.crowd_token){const t=window.CrowdApp.crowd_token;new M(t,"prompt").setupWidgetContainer()}else console.error("Crowd App installation failed. Please ensure that you are using the correct code snippet")};class M{constructor(e,n){l(this,"observer");l(this,"integrationToken","");l(this,"elementIdPrefix","");l(this,"deviceIncompatiblePrompt",[]);l(this,"currentlyDisplayedUnmoderatedTest",null);l(this,"promptPanelFrameId",i(`${this.elementIdPrefix}-body`));l(this,"promptParentContainer",null);this.integrationToken=e,this.elementIdPrefix=n,this.observer=new MutationObserver(this.handleMutationsObserver.bind(this))}getPromptElementsReference(){return{panelIframe:document.getElementById(this.promptPanelFrameId)}}getwidgetFrameEndpoint(){return{panelEndpoint:`${U}?token=${this.integrationToken}&domain=${d().hostname}&origin=${d().origin}`}}handleMutationsObserver(e){console.log("Mutation setup");const n=document.querySelector("body");for(let o of e)console.log("Page loaded");this.observer.observe(n,{childList:!0,subtree:!0})}setupWidgetContainer(){this.promptParentContainer=document.createElement("div"),this.promptParentContainer.classList.add("crowd-prompt"),this.setupPromptPanelElement(),document.body.appendChild(this.promptParentContainer),window.addEventListener("message",this.handlePostMessageEvent.bind(this)),this.assignPromptPanelEndpoints()}handlePostMessageEvent(e){e.origin===h&&this.listenAndExecutePostMessageInteration(e)}setupPromptPanelElement(){const e=`<iframe id="${this.promptPanelFrameId}" frameborder="0" class="prompt-body-frame" allowtransparency="true" style="height: 0;"></iframe>`;this.promptParentContainer.innerHTML+=e}assignPromptPanelEndpoints(){const e=this.getPromptElementsReference();e.panelIframe&&e.panelIframe.contentWindow&&(e.panelIframe.contentWindow.location.href=this.getwidgetFrameEndpoint().panelEndpoint)}adjustPromptPanelPositionDimension(e,n){const o=this.getPromptElementsReference();e==="Position"?o.panelIframe.classList.add(`prompt-panel-${n.position.toLowerCase().split("_").join("-")}`):e==="Resize"&&(o.panelIframe.style.height=`${n.height}px`,o.panelIframe.style.width=`${n.width}px`)}sendDisplayedUnmoderatedTestIds(e){var o;const n={eventType:a.LastPromptUnmoderatedId,payload:{ignoredTestIds:b(),answeredTestIds:f(u),incompatibleTestIds:this.deviceIncompatiblePrompt}};(o=e.contentWindow)==null||o.postMessage(n,h)}sendPaginationEventRequest(e){var o;const n={eventType:a.PaginateUnmoderatedTest,payload:{}};(o=e.contentWindow)==null||o.postMessage(n,h)}listenAndExecutePostMessageInteration(e){var o,s,p,c;const n=this.getPromptElementsReference();switch(e.data.eventType){case a.PromptLoaded:{e.data.payload.showPrompt?this.sendDisplayedUnmoderatedTestIds(n.panelIframe):this.clearPromptOnDeactivation();break}case a.CheckDeviceCompatibility:{D(e.data.payload).then(m=>{var w;if(m){this.currentlyDisplayedUnmoderatedTest=e.data.payload,this.adjustPromptPanelPositionDimension("Position",m);const v={eventType:a.GetPromptSize,payload:{}};(w=n.panelIframe.contentWindow)==null||w.postMessage(v,h)}else this.deviceIncompatiblePrompt.push(e.data.payload.id),this.sendPaginationEventRequest(n.panelIframe)});break}case a.PromptResize:{this.adjustPromptPanelPositionDimension("Resize",e.data.payload);break}case a.RemovePrompt:{this.clearPromptOnDeactivation();break}case a.StoreUserTestId:if(e.data.payload.onCloseAction==="ANSWER"){const m=f(u);((o=this.currentlyDisplayedUnmoderatedTest)==null?void 0:o.id)!==void 0&&(m.push((s=this.currentlyDisplayedUnmoderatedTest)==null?void 0:s.id),T(u,m,30),this.sendPaginationEventRequest(n.panelIframe))}else e.data.payload.onCloseAction==="IGNORE"&&((p=this.currentlyDisplayedUnmoderatedTest)==null?void 0:p.id)!==void 0&&(y((c=this.currentlyDisplayedUnmoderatedTest)==null?void 0:c.id,E(this.currentlyDisplayedUnmoderatedTest.reshowPrompt)),this.sendPaginationEventRequest(n.panelIframe))}}clearPromptOnDeactivation(){this.promptParentContainer&&this.promptParentContainer.remove()}}k()});
