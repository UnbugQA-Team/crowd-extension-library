(function(){"use strict";try{if(typeof document<"u"){var t=document.createElement("style");t.id="crowd-app-io-58.33460204398797",t.appendChild(document.createTextNode('.crowd-prompt{position:fixed}.crowd-prompt iframe{z-index:1100;background-color:transparent!important;background:transparent!important;border:none}.crowd-prompt .prompt-body-frame{width:470px;background:transparent;position:fixed;box-shadow:#00000029 0 5px 5px;-webkit-box-shadow:rgba(0,0,0,.16) 0px 5px 5px;-moz-box-shadow:rgba(0,0,0,.16) 0px 5px 6px;border-radius:10px}.crowd-prompt .prompt-body-iframe{width:470px;background:transparent;position:fixed;border-radius:10px}@media (max-width: 600px){.crowd-prompt .prompt-body-frame,.crowd-prompt .prompt-body-iframe{width:100%!important}}.crowd-prompt .close-prompt-panel-btn{width:35px!important;height:35px!important;background:#111827!important;position:absolute!important;border-radius:50%!important;right:10px!important;top:-20px;z-index:1110;display:flex;justify-content:center!important;align-items:center!important;cursor:pointer;border:none!important}.crowd-prompt .close-prompt-panel-btn svg{width:25px!important;height:25px!important}.crowd-prompt .close-prompt-panel-btn svg path{stroke-width:2.5px!important}.prompt-body-frame.prompt-panel-container-bottom-right{position:fixed;right:10px;bottom:10px}.prompt-body-frame.prompt-panel-container-bottom-left{position:fixed;left:10px;bottom:10px}.prompt-body-frame.prompt-panel-container-middle-left{position:fixed;left:-2px;top:50%;transform:translate(-50%) rotate(-90deg);transform-origin:50% 0%}.prompt-body-frame.prompt-panel-container-middle-right{position:fixed;top:50%;right:0;transform:rotate(-90deg) translate(50%,-50%);transform-origin:100% 50%}@media (max-width: 600px){.prompt-body-frame.prompt-panel-container-bottom-right{right:0;bottom:0}.prompt-body-frame.prompt-panel-container-bottom-left{left:0;bottom:0}.prompt-body-frame.prompt-panel-container-middle-left{left:0;transform:translateY(0);top:auto!important;bottom:0}.prompt-body-frame.prompt-panel-container-middle-right{right:0;transform:translateY(0);top:auto!important;bottom:0}}.prompt-body-frame.prompt-panel-bottom-right{position:fixed;right:10px;bottom:10px}.prompt-body-frame.prompt-panel-bottom-left{position:fixed;left:10px;bottom:10px}.prompt-body-frame.prompt-panel-middle-left{position:fixed;left:-2px;top:50%;transform:translate(-50%) rotate(-90deg);transform-origin:50% 0%}.prompt-body-frame.prompt-panel-middle-right{position:fixed;top:50%;right:0;transform:rotate(-90deg) translate(50%,-50%);transform-origin:100% 50%}@media (max-width: 600px){.prompt-body-frame.prompt-panel-bottom-right{right:0;bottom:0}.prompt-body-frame.prompt-panel-bottom-left{left:0;bottom:0}.prompt-body-frame.prompt-panel-middle-left{left:0;transform:translateY(0);top:auto!important;bottom:0}.prompt-body-frame.prompt-panel-middle-right{right:0;transform:translateY(0);top:auto!important;bottom:0}}.crowd-widget{position:fixed;z-index:5000}.crowd-widget iframe{z-index:1100;background-color:transparent;border:none}.crowd-widget .crowd-widget-body-frame{width:400px;background:transparent;position:fixed;box-shadow:#00000029 0 5px 5px;-webkit-box-shadow:rgba(0,0,0,.16) 0px 5px 5px;-moz-box-shadow:rgba(0,0,0,.16) 0px 5px 6px;border-radius:10px}.crowd-widget .crowd-widget-body-iframe{width:400px;background:transparent;position:fixed;border-radius:10px}@media (max-width: 500px){.crowd-widget .crowd-widget-body-frame,.crowd-widget .crowd-widget-body-iframe{width:100%}}.crowd-widget .crowd-widget-body-frame,.crowd-widget .crowd-widget-launcher-frame,.crowd-widget .crowd-widget-body-iframe{opacity:1;transition:visibility 0s,opacity .9s}.crowd-widget .close-widget-panel-btn{width:35px!important;height:35px!important;background:#111827!important;position:absolute!important;border-radius:50%!important;right:5px!important;top:-20px;z-index:1110;display:flex;justify-content:center!important;align-items:center!important;cursor:pointer;border:none!important}.crowd-widget .close-widget-panel-btn svg{width:25px!important;height:25px!important}.crowd-widget .close-widget-panel-btn svg path{stroke-width:2.5px!important}.crowd-widget-body-frame.widget-panel-container-bottom-right{position:fixed;right:10px;bottom:10px}.crowd-widget-body-frame.widget-panel-container-bottom-left{position:fixed;left:10px;bottom:10px}.crowd-widget-body-frame.widget-panel-container-middle-left{position:fixed;top:50%;left:10px;transform:translateY(-50%)}.crowd-widget-body-frame.widget-panel-container-middle-right{position:fixed;top:50%;right:10px;transform:translateY(-50%)}.crowd-widget-body-frame.widget-panel-bottom-right{position:fixed;right:10px;bottom:10px}.crowd-widget-body-frame.widget-panel-bottom-left{position:fixed;left:10px;bottom:10px}.crowd-widget-body-frame.widget-panel-middle-left{position:fixed;top:50%;left:10px;transform:translateY(-50%)}.crowd-widget-body-frame.widget-panel-middle-right{position:fixed;top:50%;right:10px;transform:translateY(-50%)}.crowd-widget-launcher-frame.widget-launcher-bottom-right{position:fixed;right:0;bottom:0}.crowd-widget-launcher-frame.widget-launcher-bottom-left{position:fixed;left:0;bottom:0}.crowd-widget-launcher-frame.widget-launcher-middle-left{position:fixed;left:-2px;top:50%;transform:translate(-50%) rotate(-90deg);transform-origin:50% 0%}.crowd-widget-launcher-frame.widget-launcher-middle-right{position:fixed;top:50%;right:0;transform:rotate(-90deg) translate(50%,-50%);transform-origin:100% 50%}@media (max-width: 500px){.crowd-widget-body-frame.widget-panel-container-bottom-right{right:0;bottom:0}.crowd-widget-body-frame.widget-panel-container-bottom-left{left:0;bottom:0}.crowd-widget-body-frame.widget-panel-container-middle-left{left:0;transform:translateY(0);top:auto!important;bottom:0}.crowd-widget-body-frame.widget-panel-container-middle-right{right:0;transform:translateY(0);top:auto!important;bottom:0}.crowd-widget-body-frame.widget-panel-bottom-right{right:0;bottom:0}.crowd-widget-body-frame.widget-panel-bottom-left{left:0;bottom:0}.crowd-widget-body-frame.widget-panel-middle-left{left:0;transform:translateY(0);top:auto!important;bottom:0}.crowd-widget-body-frame.widget-panel-middle-right{right:0;transform:translateY(0);top:auto!important;bottom:0}}.controller-frame{position:fixed;bottom:15px;left:calc(50% - 135px);right:calc(50% - 135px);padding:0;transform-origin:50% 50%;cursor:move}.controller-frame .controller-wrapper{display:flex;justify-content:center;align-items:center;width:300px;min-width:300px;max-width:300px;border-radius:7px;height:60px!important}.controller-frame .controller-drag{height:30px;width:30px}.controller-frame svg{height:30px;width:30px;stroke:#000}.controller-frame iframe{position:relative;height:60px!important;width:250px!important}.crowd-recording-frame{padding:10px}.crowd-recording-frame .recording-frame{position:fixed;border:4px solid red;top:0;left:0;right:0;bottom:0;z-index:9999;display:flex;justify-content:center;align-items:center;pointer-events:none}body.show-crowd-player{overflow:hidden!important}.crowd-widget .record-player-frame{position:fixed!important;background:rgba(0,0,0,.72)!important;width:100vw!important;height:100vh!important;padding:80px 100px!important;top:0!important;left:0!important;right:0!important;bottom:0!important;display:flex!important;justify-content:center!important;flex-direction:column!important;align-items:center!important;gap:20px!important}.crowd-widget .player-action{width:100%!important;height:50px!important;min-height:50px!important;display:flex!important;flex-direction:row!important;justify-content:center!important;align-items:center!important;gap:20px!important}.crowd-widget .player-action button{display:flex!important;padding:8px 16px!important;justify-content:center!important;align-items:center!important;gap:10px!important;min-width:130px!important;width:130px!important;border-radius:4px!important;color:#fff!important;border:1px solid #fff!important}.crowd-widget .crowd-player-container{width:100%;display:flex;justify-content:center}@media (max-width: 500px){.crowd-widget .record-player-frame{padding:40px 20px}}.replayer-wrapper{position:relative}.replayer-mouse{position:absolute;width:20px;height:20px;transition:left .05s linear,top .05s linear;background-size:contain;background-position:50%;background-repeat:no-repeat;background-image:url(data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9IjMwMCIgd2lkdGg9IjMwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBkYXRhLW5hbWU9IkxheWVyIDEiIHZpZXdCb3g9IjAgMCA1MCA1MCI+PHBhdGggZD0iTTQ4LjcxIDQyLjkxTDM0LjA4IDI4LjI5IDQ0LjMzIDE4YTEgMSAwIDAwLS4zMy0xLjYxTDIuMzUgMS4wNmExIDEgMCAwMC0xLjI5IDEuMjlMMTYuMzkgNDRhMSAxIDAgMDAxLjY1LjM2bDEwLjI1LTEwLjI4IDE0LjYyIDE0LjYzYTEgMSAwIDAwMS40MSAwbDQuMzgtNC4zOGExIDEgMCAwMC4wMS0xLjQyem0tNS4wOSAzLjY3TDI5IDMyYTEgMSAwIDAwLTEuNDEgMGwtOS44NSA5Ljg1TDMuNjkgMy42OWwzOC4xMiAxNEwzMiAyNy41OEExIDEgMCAwMDMyIDI5bDE0LjU5IDE0LjYyeiIvPjwvc3ZnPg==);border-color:transparent}.replayer-mouse:after{content:"";display:inline-block;width:20px;height:20px;background:#4950f6;border-radius:100%;transform:translate(-50%,-50%);opacity:.3}.replayer-mouse.active:after{animation:click .2s ease-in-out 1}.replayer-mouse.touch-device{background-image:none;width:70px;height:70px;border-radius:100%;margin-left:-37px;margin-top:-37px;border:4px solid rgba(73,80,246,0);transition:left 0s linear,top 0s linear,border-color .2s ease-in-out}.replayer-mouse.touch-device.touch-active{border-color:#4950f6;transition:left .25s linear,top .25s linear,border-color .2s ease-in-out}.replayer-mouse.touch-device:after{opacity:0}.replayer-mouse.touch-device.active:after{animation:touch-click .2s ease-in-out 1}.replayer-mouse-tail{position:absolute;pointer-events:none}@keyframes click{0%{opacity:.3;width:20px;height:20px}50%{opacity:.5;width:10px;height:10px}}@keyframes touch-click{0%{opacity:0;width:20px;height:20px}50%{opacity:.5;width:10px;height:10px}}.rr-player{position:relative;background:white;float:left;border-radius:5px;box-shadow:0 24px 48px #11103e1f}.rr-player__frame{overflow:hidden}.replayer-wrapper{float:left;clear:both;transform-origin:top left;left:50%;top:50%}.replayer-wrapper>iframe{border:none}.rr-controller.svelte-19ke1iv.svelte-19ke1iv{width:100%;height:80px;background:#fff;display:flex;flex-direction:column;justify-content:space-around;align-items:center;border-radius:0 0 5px 5px}.rr-timeline.svelte-19ke1iv.svelte-19ke1iv{width:80%;display:flex;align-items:center}.rr-timeline__time.svelte-19ke1iv.svelte-19ke1iv{display:inline-block;width:100px;text-align:center;color:#11103e}.rr-progress.svelte-19ke1iv.svelte-19ke1iv{flex:1;height:12px;background:#eee;position:relative;border-radius:3px;cursor:pointer;box-sizing:border-box;border-top:solid 4px #fff;border-bottom:solid 4px #fff}.rr-progress.disabled.svelte-19ke1iv.svelte-19ke1iv{cursor:not-allowed}.rr-progress__step.svelte-19ke1iv.svelte-19ke1iv{height:100%;position:absolute;left:0;top:0;background:#e0e1fe}.rr-progress__handler.svelte-19ke1iv.svelte-19ke1iv{width:20px;height:20px;border-radius:10px;position:absolute;top:2px;transform:translate(-50%,-50%);background:rgb(73,80,246)}.rr-controller__btns.svelte-19ke1iv.svelte-19ke1iv{display:flex;align-items:center;justify-content:center;font-size:13px}.rr-controller__btns.svelte-19ke1iv button.svelte-19ke1iv{width:32px;height:32px;display:flex;padding:0;align-items:center;justify-content:center;background:none;border:none;border-radius:50%;cursor:pointer}.rr-controller__btns.svelte-19ke1iv button.svelte-19ke1iv:active{background:#e0e1fe}.rr-controller__btns.svelte-19ke1iv button.active.svelte-19ke1iv{color:#fff;background:rgb(73,80,246)}.rr-controller__btns.svelte-19ke1iv button.svelte-19ke1iv:disabled{cursor:not-allowed}.switch.svelte-9brlez.svelte-9brlez.svelte-9brlez{height:1em;display:flex;align-items:center}.switch.disabled.svelte-9brlez.svelte-9brlez.svelte-9brlez{opacity:.5}.label.svelte-9brlez.svelte-9brlez.svelte-9brlez{margin:0 8px}.switch.svelte-9brlez input[type=checkbox].svelte-9brlez.svelte-9brlez{position:absolute;opacity:0}.switch.svelte-9brlez label.svelte-9brlez.svelte-9brlez{width:2em;height:1em;position:relative;cursor:pointer;display:block}.switch.disabled.svelte-9brlez label.svelte-9brlez.svelte-9brlez{cursor:not-allowed}.switch.svelte-9brlez label.svelte-9brlez.svelte-9brlez:before{content:"";position:absolute;width:2em;height:1em;left:.1em;transition:background .1s ease;background:rgba(73,80,246,.5);border-radius:50px}.switch.svelte-9brlez label.svelte-9brlez.svelte-9brlez:after{content:"";position:absolute;width:1em;height:1em;border-radius:50px;left:0;transition:all .2s ease;box-shadow:0 2px 5px #0000004d;background:#fcfff4;animation:switch-off .2s ease-out;z-index:2}.switch.svelte-9brlez input[type=checkbox].svelte-9brlez:checked+label.svelte-9brlez:before{background:rgb(73,80,246)}.switch.svelte-9brlez input[type=checkbox].svelte-9brlez:checked+label.svelte-9brlez:after{animation:switch-on .2s ease-out;left:1.1em}')),document.head.appendChild(t)}}catch(e){console.error("vite-plugin-css-injected-by-js",e)}})();
(function(Me){typeof define=="function"&&define.amd?define(Me):Me()})(function(){"use strict";var tl=Object.defineProperty;var nl=(Me,Le,$e)=>Le in Me?tl(Me,Le,{enumerable:!0,configurable:!0,writable:!0,value:$e}):Me[Le]=$e;var Ee=(Me,Le,$e)=>(nl(Me,typeof Le!="symbol"?Le+"":Le,$e),$e);const Me="",Le="",ze="https://extension.crowdapp.io",ni=`${ze}/extension/unmoderated-test`,Xt=`${ze}/extension/widget`,Ne=e=>`${e}-${new Date().getTime()}${Math.floor(Math.random()*100)}`,ri=()=>window.CrowdApp&&window.CrowdApp.environment?window.CrowdApp.environment:(window.CrowdApp,"production"),qt=()=>{const e=window.location.href,t=new URL(e);return{hostname:encodeURIComponent(t.hostname),host:encodeURIComponent(t.host),protocol:encodeURIComponent(t.protocol),origin:encodeURIComponent(t.origin)}},Tt=e=>`?token=${encodeURIComponent(e)}&domain=${encodeURIComponent(qt().hostname)}&host_origin=${encodeURIComponent(qt().host)}&protocol=${encodeURIComponent(qt().protocol)}&env=${ri()}`,Wn=()=>{const e=navigator.userAgent;return/Android|webOS|iPhone|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e)?"Mobile":/Tablet|iPad/i.test(e)?"Tablet":"Desktop"},Bn=[{label:"Do not reshow",value:"0_hours"},{label:"Reshow after 24 hours",value:"24_hours"},{label:"Reshow after 3 days",value:"72_hours"},{label:"Reshow after 1 week",value:"168_hours"}],Pn=(e,t)=>{const n=window.location.href.replace(/\/$/,""),r=new URL(n);return e==="start_with"?r.pathname.startsWith(t):e==="end_with"?r.pathname.endsWith(t):e==="contains"?r.pathname.includes(t):e==="exactly_matches"?r.pathname===t:e==="is_not"?r.pathname!==t:e==="matches_regex"?new RegExp(t,"i").test(r.pathname):!1};var ke=(e=>(e.PromptLoaded="PROMPTLOADED",e.GetPromptSize="GETPROMPTSIZE",e.PromptResize="PROMPTRESIZE",e.LastPromptUnmoderatedId="LASTPROMPTUNMODERATEDID",e.RemovePrompt="REMOVEPROMPT",e.CheckDeviceCompatibility="CHECKDEVICECOMPATIBILITY",e.PaginateUnmoderatedTest="PAGINATEUNMODERATEDTEST",e.StoreUserTestId="STOREMODERATEDTESTID",e))(ke||{});const Vn="crowd-ignored-unmoderated-test",en="crowd-answered-unmoderated-test",oi=(e,t,n)=>{const r=new Date;r.setTime(r.getTime()+n*24*60*60*1e3);const o=`${e}=${encodeURIComponent(JSON.stringify(t))}; expires=${r.toUTCString()}; path=/`;document.cookie=o},Un=e=>{const n=document.cookie.split(";");let r=null;return n.forEach(o=>{const[i,s]=o.trim().split("=");i===e&&(r=JSON.parse(decodeURIComponent(s)))}),r===null?[]:r},_n=(e,t)=>{const n=`${Vn}-${new Date().getTime()}`,r=new Date;r.setTime(r.getTime()+t*24*60*60*1e3);const o=`${n}=${encodeURIComponent(e)}; expires=${r.toUTCString()}; path=/`;document.cookie=o},ii=()=>{const e=new RegExp(`^${Vn}`),n=document.cookie.split(";"),r=[];for(let o of n){const[i,s]=o.split("=").map(a=>a.trim());e.test(i)&&r.push(s)}return r},Gn=e=>{const t=Bn.findIndex(n=>n.value===e);if(t!==1){const r=Bn[t].value.split("_")[0];return Number(r)===0?180:Number(r)/24}else return 180},si=e=>{const t=Wn();return t==="Mobile"&&e.mobile||t==="Desktop"&&e.desktop||t==="Tablet"&&e.tablet},ai=async e=>{if(e.visibilityOption==="ALLPAGES")return{position:e.promptPosition};if(e.visibilityOption==="SPECIFICPAGES"){const t=e.targetPages.filter(n=>Pn(n.optionName,n.optionValue));return si(e.deviceSupported)&&t.length>0?{position:e.promptPosition}:!1}else return!1},Rt=ze,li=ni,ci=()=>{if(!document.getElementsByClassName("crowd-prompt").length)if(window.CrowdApp&&window.CrowdApp.crowd_token){const t=window.CrowdApp.crowd_token;new di(t,"prompt").setupWidgetContainer()}else console.error("Crowd App installation failed. Please ensure that you are using the correct code snippet")};class di{constructor(t,n){Ee(this,"observer");Ee(this,"integrationToken","");Ee(this,"elementIdPrefix","");Ee(this,"deviceIncompatiblePrompt",[]);Ee(this,"currentlyDisplayedUnmoderatedTest",null);Ee(this,"promptPanelContainerFrameId",Ne(`${this.elementIdPrefix}-body-container`));Ee(this,"promptPanelFrameId",Ne(`${this.elementIdPrefix}-body`));Ee(this,"promptParentContainer",null);this.integrationToken=t,this.elementIdPrefix=n,this.observer=new MutationObserver(this.handleMutationsObserver.bind(this))}getPromptElementsReference(){const t=document.getElementById(this.promptPanelContainerFrameId),n=document.getElementById(this.promptPanelFrameId);return{panelContainer:t,panelIframe:n}}getwidgetFrameEndpoint(){return{panelEndpoint:`${li}/${Tt(this.integrationToken)}`}}handleMutationsObserver(t){const n=document.querySelector("body");for(let r of t);this.observer.observe(n,{childList:!0,subtree:!0})}setupWidgetContainer(){var t;this.promptParentContainer=document.createElement("div"),this.promptParentContainer.classList.add("crowd-prompt"),this.setupPromptPanelElement(),document.body.appendChild(this.promptParentContainer),window.addEventListener("message",this.handlePostMessageEvent.bind(this)),this.assignPromptPanelEndpoints(),(t=document.getElementById("close-prompt-panel-btn"))==null||t.addEventListener("click",()=>{_n(this.currentlyDisplayedUnmoderatedTest.id,Gn(this.currentlyDisplayedUnmoderatedTest.reshowPrompt)),this.sendPaginationEventRequest(this.getPromptElementsReference().panelIframe)}),window.addEventListener("popstate",this.triggerPromptOnLinkHash.bind(this))}handlePostMessageEvent(t){t.origin===Rt&&this.listenAndExecutePostMessageInteration(t)}setupPromptPanelElement(){const t=`<div id="${this.promptPanelContainerFrameId}" class="prompt-body-frame" style="height: 0; visibility: hidden;"> <button type="button" id="close-prompt-panel-btn" class="close-prompt-panel-btn"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M4 12L12 4M4 4L12 12" stroke="#F9FAFB" stroke-width="1.13" stroke-linecap="round" stroke-linejoin="round"/>
    </svg></button><iframe id="${this.promptPanelFrameId}" frameborder="0" class="prompt-body-iframe" allowtransparency="true" style="height: 0;"></iframe></div>`;this.promptParentContainer.innerHTML+=t}assignPromptPanelEndpoints(){const t=this.getPromptElementsReference();t.panelIframe&&t.panelIframe.contentWindow&&(t.panelIframe.contentWindow.location.href=this.getwidgetFrameEndpoint().panelEndpoint)}adjustPromptPanelPositionDimension(t,n){const r=this.getPromptElementsReference();t==="Position"?(r.panelIframe.classList.add(`prompt-panel-${n.position.toLowerCase().split("_").join("-")}`),r.panelContainer.classList.add(`prompt-panel-container-${n.position.toLowerCase().split("_").join("-")}`)):t==="Resize"&&(r.panelIframe.style.height=`${n.height}px`,r.panelIframe.style.width=`${n.width}px`,r.panelContainer.style.height=`${n.height}px`,r.panelContainer.style.width=`${n.width}px`,r.panelContainer.style.visibility="visible")}sendDisplayedUnmoderatedTestIds(t){var r;const n={eventType:ke.LastPromptUnmoderatedId,payload:{ignoredTestIds:ii(),answeredTestIds:Un(en),incompatibleTestIds:this.deviceIncompatiblePrompt}};(r=t.contentWindow)==null||r.postMessage(n,Rt)}sendPaginationEventRequest(t){var r;const n={eventType:ke.PaginateUnmoderatedTest,payload:{}};(r=t.contentWindow)==null||r.postMessage(n,Rt)}checkCompabilityForPrompt(){const t=this.getPromptElementsReference();this.currentlyDisplayedUnmoderatedTest!==null&&ai(this.currentlyDisplayedUnmoderatedTest).then(n=>{var r;if(n){this.adjustPromptPanelPositionDimension("Position",n);const o={eventType:ke.GetPromptSize,payload:{}};(r=t.panelIframe.contentWindow)==null||r.postMessage(o,Rt)}else this.deviceIncompatiblePrompt.push(this.currentlyDisplayedUnmoderatedTest.id),this.sendPaginationEventRequest(t.panelIframe)})}listenAndExecutePostMessageInteration(t){var r,o,i,s;const n=this.getPromptElementsReference();switch(t.data.eventType){case ke.PromptLoaded:{t.data.payload.showPrompt?this.sendDisplayedUnmoderatedTestIds(n.panelIframe):this.clearPromptOnDeactivation();break}case ke.CheckDeviceCompatibility:{this.currentlyDisplayedUnmoderatedTest=t.data.payload,this.checkCompabilityForPrompt();break}case ke.PromptResize:{this.adjustPromptPanelPositionDimension("Resize",t.data.payload);break}case ke.RemovePrompt:{this.clearPromptOnDeactivation();break}case ke.StoreUserTestId:if(t.data.payload.onCloseAction==="ANSWER"){const a=Un(en);((r=this.currentlyDisplayedUnmoderatedTest)==null?void 0:r.id)!==void 0&&(a.push((o=this.currentlyDisplayedUnmoderatedTest)==null?void 0:o.id),oi(en,a,30),this.sendPaginationEventRequest(n.panelIframe))}else t.data.payload.onCloseAction==="IGNORE"&&((i=this.currentlyDisplayedUnmoderatedTest)==null?void 0:i.id)!==void 0&&(_n((s=this.currentlyDisplayedUnmoderatedTest)==null?void 0:s.id,Gn(this.currentlyDisplayedUnmoderatedTest.reshowPrompt)),this.sendPaginationEventRequest(n.panelIframe))}}triggerPromptOnLinkHash(){try{this.checkCompabilityForPrompt()}catch{window.removeEventListener("popstate",this.triggerPromptOnLinkHash.bind(this))}}clearPromptOnDeactivation(){this.promptParentContainer&&this.promptParentContainer.remove()}}var ve=(e=>(e.LauncherLoaded="LAUNCHERLOADED",e.LauncherResize="LAUNCHERRESIZE",e.PanelLoaded="PANELLOADED",e.PanelResize="PANELRESIZE",e.OpenPanel="OPENPANEL",e.WidgetImpression="WIDGETIMPRESSION",e.ImpressionRecorded="IMPRESSIONRECORDED",e.StartScreenRecord="STARTSCREENRECORD",e.StopScreenRecord="STOPSCREENRECORD",e.ScreenRecordDone="SCREENRECORDDONE",e.StartCountDown="STARTCOUNTDOWN",e))(ve||{});const ui=Symbol(),Zn=Object.getPrototypeOf,tn=new WeakMap,hi=e=>e&&(tn.has(e)?tn.get(e):Zn(e)===Object.prototype||Zn(e)===Array.prototype),pi=e=>hi(e)&&e[ui]||null,Kn=(e,t=!0)=>{tn.set(e,t)},nn=e=>typeof e=="object"&&e!==null,Ve=new WeakMap,Mt=new WeakSet,mi=(e=Object.is,t=(c,d)=>new Proxy(c,d),n=c=>nn(c)&&!Mt.has(c)&&(Array.isArray(c)||!(Symbol.iterator in c))&&!(c instanceof WeakMap)&&!(c instanceof WeakSet)&&!(c instanceof Error)&&!(c instanceof Number)&&!(c instanceof Date)&&!(c instanceof String)&&!(c instanceof RegExp)&&!(c instanceof ArrayBuffer),r=c=>{switch(c.status){case"fulfilled":return c.value;case"rejected":throw c.reason;default:throw c}},o=new WeakMap,i=(c,d,u=r)=>{const p=o.get(c);if((p==null?void 0:p[0])===d)return p[1];const g=Array.isArray(c)?[]:Object.create(Object.getPrototypeOf(c));return Kn(g,!0),o.set(c,[d,g]),Reflect.ownKeys(c).forEach(h=>{if(Object.getOwnPropertyDescriptor(g,h))return;const m=Reflect.get(c,h),{enumerable:I}=Reflect.getOwnPropertyDescriptor(c,h),y={value:m,enumerable:I,configurable:!0};if(Mt.has(m))Kn(m,!1);else if(m instanceof Promise)delete y.value,y.get=()=>u(m);else if(Ve.has(m)){const[f,w]=Ve.get(m);y.value=i(f,w(),u)}Object.defineProperty(g,h,y)}),Object.preventExtensions(g)},s=new WeakMap,a=[1,1],l=c=>{if(!nn(c))throw new Error("object required");const d=s.get(c);if(d)return d;let u=a[0];const p=new Set,g=(v,E=++a[0])=>{u!==E&&(u=E,p.forEach(C=>C(v,E)))};let h=a[1];const m=(v=++a[1])=>(h!==v&&!p.size&&(h=v,y.forEach(([E])=>{const C=E[1](v);C>u&&(u=C)})),u),I=v=>(E,C)=>{const b=[...E];b[1]=[v,...b[1]],g(b,C)},y=new Map,f=(v,E)=>{if(p.size){const C=E[3](I(v));y.set(v,[E,C])}else y.set(v,[E])},w=v=>{var E;const C=y.get(v);C&&(y.delete(v),(E=C[1])==null||E.call(C))},A=v=>(p.add(v),p.size===1&&y.forEach(([C,b],M)=>{const T=C[3](I(M));y.set(M,[C,T])}),()=>{p.delete(v),p.size===0&&y.forEach(([C,b],M)=>{b&&(b(),y.set(M,[C]))})}),L=Array.isArray(c)?[]:Object.create(Object.getPrototypeOf(c)),W=t(L,{deleteProperty(v,E){const C=Reflect.get(v,E);w(E);const b=Reflect.deleteProperty(v,E);return b&&g(["delete",[E],C]),b},set(v,E,C,b){const M=Reflect.has(v,E),T=Reflect.get(v,E,b);if(M&&(e(T,C)||s.has(C)&&e(T,s.get(C))))return!0;w(E),nn(C)&&(C=pi(C)||C);let V=C;if(C instanceof Promise)C.then(x=>{C.status="fulfilled",C.value=x,g(["resolve",[E],x])}).catch(x=>{C.status="rejected",C.reason=x,g(["reject",[E],x])});else{!Ve.has(C)&&n(C)&&(V=l(C));const x=!Mt.has(V)&&Ve.get(V);x&&f(E,x)}return Reflect.set(v,E,V,b),g(["set",[E],C,T]),!0}});s.set(c,W);const k=[L,m,i,A];return Ve.set(W,k),Reflect.ownKeys(c).forEach(v=>{const E=Object.getOwnPropertyDescriptor(c,v);"value"in E&&(W[v]=c[v],delete E.value,delete E.writable),Object.defineProperty(L,v,E)}),W})=>[l,Ve,Mt,e,t,n,r,o,i,s,a],[gi]=mi();function fi(e={}){return gi(e)}function yi(e,t,n){const r=Ve.get(e);let o;const i=[],s=r[3];let a=!1;const c=s(d=>{if(i.push(d),n){t(i.splice(0));return}o||(o=Promise.resolve().then(()=>{o=void 0,a&&t(i.splice(0))}))});return a=!0,()=>{a=!1,c()}}const ee=fi({isElementsMounted:!1,isPanelVisible:!1,isLauncherVisible:!1,isControllerVisible:!1,isRecordPlayerVisible:!1,shouldShowLauncher:!1,isLauncherFrameLoaded:!1,isPanelFrameLoaded:!1,isControllerFrameLoaded:!1,widgetContainerId:"",panelFrameWrapperId:"",panelFrameId:"",launcherFrameId:"",controllerFrameWrapperId:"",controllerFrameId:"",screenRecordPlayerFrameId:"",widgetDisplayRule:null}),B={modules:{widget:{state:ee,action:{generateElementIds(e){ee.widgetContainerId=Ne(`${e}-container`),ee.panelFrameWrapperId=Ne(`${e}-container`),ee.panelFrameId=Ne(`${e}-body`),ee.launcherFrameId=Ne(`${e}-launcher`),ee.controllerFrameWrapperId=Ne(`${e}-controller-wrapper`),ee.controllerFrameId=Ne(`${e}-controller`),ee.screenRecordPlayerFrameId=Ne(`${e}-record-player-frame`)},updateIframeLoaded(e){ee.isLauncherFrameLoaded=e.isLauncherFrameLoaded??ee.isLauncherFrameLoaded,ee.isPanelFrameLoaded=e.isPanelFrameLoaded??ee.isPanelFrameLoaded,ee.isControllerFrameLoaded=e.isControllerFrameLoaded??ee.isControllerFrameLoaded},updateDisplayRules(e){ee.widgetDisplayRule=e},updateWidgetSectionVisibility(e){ee.isElementsMounted=e.isElementsMounted??ee.isElementsMounted,ee.isPanelVisible=e.isPanelVisible??ee.isPanelVisible,ee.isLauncherVisible=e.isLauncherVisible??ee.isLauncherVisible,ee.isControllerVisible=e.isControllerVisible??ee.isControllerVisible,ee.isRecordPlayerVisible=e.isRecordPlayerVisible??ee.isRecordPlayerVisible},updateShouldShowLauncher(e){ee.shouldShowLauncher=e}}}},strict:!1,state:()=>({})},Ii=30,rn="crowd-widget",Yn="crowd-recording-frame";let lt;function kt(e,t){let n=!0;const r=new Set,o=new Map,i=()=>{n&&(n=!1,r.forEach(a=>a()),r.clear(),o.forEach(a=>a()),o.clear())},s=async()=>{if(!n)return;r.forEach(c=>c()),r.clear();const a=new Set,l=lt;lt=r;try{const c=e(u=>{if(a.add(u),n&&!o.has(u)){const p=yi(u,s,t==null?void 0:t.sync);o.set(u,p)}return u}),d=c&&c instanceof Promise?await c:c;d&&(n?r.add(d):i())}finally{lt=l}o.forEach((c,d)=>{a.has(d)||(o.delete(d),c())})};return lt&&lt.add(i),s(),i}const Ue=(e,t)=>{if(e==="id")return document.getElementById(t);if(e==="class"){const n=document.getElementsByClassName(t);if(n.length>0)return n[0]}else return null},Ci=()=>{const e=new Date;e.setTime(e.getTime()+Number(Ii)*60*1e3);const t=`${rn}-user-session`,n=encodeURIComponent(Ne("crowd-widget-user-session")),r=e.toUTCString(),i=`${t}=${n}; expires=${r}; path=/`;document.cookie=i},vi=()=>{const e=`${rn}-user-session`,n=document.cookie.split(";");let r=null;return n.forEach(o=>{const[i,s]=o.trim().split("=");i===e&&(r=decodeURIComponent(s))}),r!==null},be=()=>{const e=B.modules.widget.state.widgetContainerId,t=B.modules.widget.state.panelFrameWrapperId,n=B.modules.widget.state.panelFrameId,r=B.modules.widget.state.launcherFrameId,o=B.modules.widget.state.controllerFrameId,i=B.modules.widget.state.controllerFrameWrapperId,s=B.modules.widget.state.screenRecordPlayerFrameId,a=Ue("id",e);if(!a)throw new Error(`Element with ID "${e}" not found`);const l=Ue("id",t);if(!l)throw new Error(`Element with ID "${t}" not found`);const c=Ue("id",n);if(!c)throw new Error(`Element with ID "${n}" not found`);const d=Ue("id",r);if(!d)throw new Error(`Element with ID "${r}" not found`);const u=Ue("id",i);if(!u)throw new Error(`Element with ID "${i}" not found`);const p=Ue("id",o);if(!p)throw new Error(`Element with ID "${o}" not found`);const g=Ue("id",s);if(!g)throw new Error(`Element with ID "${s}" not found`);return{widgetWrapper:a,panelContainerElement:l,panelIframe:c,launcherIframe:d,controllerWapper:u,controllerIframe:p,playerFrame:g}},$n=e=>({panelEndpoint:`${Xt}/${Tt(e)}`,launcherEndpoint:`${Xt}/launcher/${Tt(e)}`,controllerEndpoint:`${Xt}/recorder-controller/${Tt(e)}`}),on=e=>{const t=Wn().toLowerCase();return e.includes(t)},bi=async e=>{if(on(e.devices)&&e.visibilityOption==="ALLPAGES")return{position:e.position,showAfter:e.showWidgetAfter};if(on(e.devices)&&e.visibilityOption==="SPECIFICPAGES"){const n=JSON.parse(e.targetPages).filter(r=>Pn(r.optionName,r.optionValue));return on(e.devices)&&n.length>0?{position:e.position,showAfter:e.showWidgetAfter}:!1}else return!1},zn=()=>{const e=be();B.modules.widget.state.widgetDisplayRule!==null&&bi(B.modules.widget.state.widgetDisplayRule).then(t=>{t&&B.modules.widget.state.shouldShowLauncher?(e.widgetWrapper.style.visibility="visible",B.modules.widget.action.updateWidgetSectionVisibility({isLauncherVisible:B.modules.widget.state.shouldShowLauncher}),setTimeout(()=>{var n;if(Hn("Position",t),!vi()){const r={eventType:ve.WidgetImpression,payload:{}};(n=e.launcherIframe.contentWindow)==null||n.postMessage(r,ze)}},t.showAfter)):t&&!B.modules.widget.state.shouldShowLauncher?(e.widgetWrapper.style.visibility="visible",B.modules.widget.action.updateWidgetSectionVisibility({isLauncherVisible:!1})):e.widgetWrapper.style.visibility="hidden"})},wi=()=>{const e=be().controllerWapper;let t=0,n=0,r=0,o=0;function i(l){l=l||window.event,l.preventDefault(),r=l.clientX,o=l.clientY,document.onmouseup=a,document.onmousemove=s}function s(l){l=l||window.event,l.preventDefault(),t=r-l.clientX,n=o-l.clientY,r=l.clientX,o=l.clientY,e.style.top=e.offsetTop-n+"px",e.style.left=e.offsetLeft-t+"px"}function a(){document.onmouseup=null,document.onmousemove=null}e.onmousedown=i},Si=()=>(kt(e=>{const t=e(B.modules.widget.state).isLauncherVisible,n=e(B.modules.widget.state).shouldShowLauncher;if(!B.modules.widget.state.isElementsMounted)return;const r=be();r.launcherIframe.style.visibility=!n||!t?"hidden":"visible"}),`<iframe id="${B.modules.widget.state.launcherFrameId}" frameborder="0" class="crowd-widget-launcher-frame" allowtransparency="true" style="height: 0;"></iframe>`),Hn=(e,t)=>{const n=be();if(e==="Position"){const r=t.position.toLowerCase().split("_").join("-");n.launcherIframe.classList.add(`widget-launcher-${r}`)}else e==="Resize"&&(t.height!==void 0&&(n.launcherIframe.style.height=`${t.height}px`),t.width!==void 0&&(n.launcherIframe.style.width=`${t.width}px`))},Qn="close-widget-panel-btn",Ai=()=>{kt(n=>{const r=n(B.modules.widget.state).isPanelVisible;if(!B.modules.widget.state.isElementsMounted)return;const o=be();o.panelContainerElement.style.visibility=r?"visible":"hidden"});const{panelFrameWrapperId:e,panelFrameId:t}=B.modules.widget.state;return`<div id="${e}" class="crowd-widget-body-frame" style="height: 0; visibility: hidden;"> 
            <button type="button" id="${Qn}" class="close-widget-panel-btn">
                <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M4 12L12 4M4 4L12 12" stroke="#F9FAFB" stroke-width="1.13" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
            </button> 
            <iframe id="${t}" frameborder="0" class="crowd-widget-body-iframe" allowtransparency="true" style="height: 0;"></iframe>
        </div>`},Ei=()=>{var e;(e=document.getElementById(Qn))==null||e.addEventListener("click",()=>{B.modules.widget.action.updateWidgetSectionVisibility({isPanelVisible:!1,isLauncherVisible:B.modules.widget.state.shouldShowLauncher}),window.location.hash&&history.pushState("",document.title,window.location.pathname+window.location.search)})},Jn=(e,t)=>{const n=be();if(e==="Position"){const r=`widget-panel-${t.position.toLowerCase().split("_").join("-")}`,o=`widget-panel-container-${t.position.toLowerCase().split("_").join("-")}`;n.panelIframe.classList.add(r),n.panelContainerElement.classList.add(o)}else e==="Resize"&&(n.panelIframe.style.height=`${t.height}px`,n.panelContainerElement.style.height=`${t.height}px`)},sn=()=>{const e="#crowd-widget";try{zn();const t=window.location.hash;t!==e&&B.modules.widget.state.isPanelVisible?B.modules.widget.action.updateWidgetSectionVisibility({isPanelVisible:!1,isLauncherVisible:B.modules.widget.state.shouldShowLauncher}):t===e&&!B.modules.widget.state.isPanelVisible&&B.modules.widget.action.updateWidgetSectionVisibility({isPanelVisible:!0,isLauncherVisible:!1})}catch{window.removeEventListener("popstate",sn.bind(void 0))}};var ue;(function(e){e[e.Document=0]="Document",e[e.DocumentType=1]="DocumentType",e[e.Element=2]="Element",e[e.Text=3]="Text",e[e.CDATA=4]="CDATA",e[e.Comment=5]="Comment"})(ue||(ue={}));function Ni(e){return e.nodeType===e.ELEMENT_NODE}function ct(e){var t=e==null?void 0:e.host;return(t==null?void 0:t.shadowRoot)===e}function dt(e){return Object.prototype.toString.call(e)==="[object ShadowRoot]"}function Ti(e){return e.includes(" background-clip: text;")&&!e.includes(" -webkit-background-clip: text;")&&(e=e.replace(" background-clip: text;"," -webkit-background-clip: text; background-clip: text;")),e}function an(e){try{var t=e.rules||e.cssRules;return t?Ti(Array.from(t).map(jn).join("")):null}catch{return null}}function jn(e){var t=e.cssText;if(Ri(e))try{t=an(e.styleSheet)||t}catch{}return t}function Ri(e){return"styleSheet"in e}var Xn=function(){function e(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}return e.prototype.getId=function(t){var n;if(!t)return-1;var r=(n=this.getMeta(t))===null||n===void 0?void 0:n.id;return r??-1},e.prototype.getNode=function(t){return this.idNodeMap.get(t)||null},e.prototype.getIds=function(){return Array.from(this.idNodeMap.keys())},e.prototype.getMeta=function(t){return this.nodeMetaMap.get(t)||null},e.prototype.removeNodeFromMap=function(t){var n=this,r=this.getId(t);this.idNodeMap.delete(r),t.childNodes&&t.childNodes.forEach(function(o){return n.removeNodeFromMap(o)})},e.prototype.has=function(t){return this.idNodeMap.has(t)},e.prototype.hasNode=function(t){return this.nodeMetaMap.has(t)},e.prototype.add=function(t,n){var r=n.id;this.idNodeMap.set(r,t),this.nodeMetaMap.set(t,n)},e.prototype.replace=function(t,n){var r=this.getNode(t);if(r){var o=this.nodeMetaMap.get(r);o&&this.nodeMetaMap.set(n,o)}this.idNodeMap.set(t,n)},e.prototype.reset=function(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap},e}();function Mi(){return new Xn}function ln(e){var t=e.maskInputOptions,n=e.tagName,r=e.type,o=e.value,i=e.maskInputFn,s=o||"";return(t[n.toLowerCase()]||t[r])&&(i?s=i(s):s="*".repeat(s.length)),s}var qn="__rrweb_original__";function ki(e){var t=e.getContext("2d");if(!t)return!0;for(var n=50,r=0;r<e.width;r+=n)for(var o=0;o<e.height;o+=n){var i=t.getImageData,s=qn in i?i[qn]:i,a=new Uint32Array(s.call(t,r,o,Math.min(n,e.width-r),Math.min(n,e.height-o)).data.buffer);if(a.some(function(l){return l!==0}))return!1}return!0}var Di=1,Fi=new RegExp("[^a-z0-9-_:]"),ut=-2;function er(){return Di++}function xi(e){if(e instanceof HTMLFormElement)return"form";var t=e.tagName.toLowerCase().trim();return Fi.test(t)?"div":t}function Li(e){return e.cssRules?Array.from(e.cssRules).map(function(t){return t.cssText||""}).join(""):""}function Oi(e){var t="";return e.indexOf("//")>-1?t=e.split("/").slice(0,3).join("/"):t=e.split("/")[0],t=t.split("?")[0],t}var He,tr,Wi=/url\((?:(')([^']*)'|(")(.*?)"|([^)]*))\)/gm,Bi=/^(?!www\.|(?:http|ftp)s?:\/\/|[A-Za-z]:\\|\/\/|#).*/,Pi=/^(data:)([^,]*),(.*)/i;function Dt(e,t){return(e||"").replace(Wi,function(n,r,o,i,s,a){var l=o||s||a,c=r||i||"";if(!l)return n;if(!Bi.test(l)||Pi.test(l))return"url(".concat(c).concat(l).concat(c,")");if(l[0]==="/")return"url(".concat(c).concat(Oi(t)+l).concat(c,")");var d=t.split("/"),u=l.split("/");d.pop();for(var p=0,g=u;p<g.length;p++){var h=g[p];h!=="."&&(h===".."?d.pop():d.push(h))}return"url(".concat(c).concat(d.join("/")).concat(c,")")})}var Vi=/^[^ \t\n\r\u000c]+/,Ui=/^[, \t\n\r\u000c]+/;function _i(e,t){if(t.trim()==="")return t;var n=0;function r(c){var d,u=c.exec(t.substring(n));return u?(d=u[0],n+=d.length,d):""}for(var o=[];r(Ui),!(n>=t.length);){var i=r(Vi);if(i.slice(-1)===",")i=Qe(e,i.substring(0,i.length-1)),o.push(i);else{var s="";i=Qe(e,i);for(var a=!1;;){var l=t.charAt(n);if(l===""){o.push((i+s).trim());break}else if(a)l===")"&&(a=!1);else if(l===","){n+=1,o.push((i+s).trim());break}else l==="("&&(a=!0);s+=l,n+=1}}}return o.join(", ")}function Qe(e,t){if(!t||t.trim()==="")return t;var n=e.createElement("a");return n.href=t,n.href}function Gi(e){return!!(e.tagName==="svg"||e.ownerSVGElement)}function cn(){var e=document.createElement("a");return e.href="",e.href}function nr(e,t,n,r){return n==="src"||n==="href"&&r&&!(t==="use"&&r[0]==="#")||n==="xlink:href"&&r&&r[0]!=="#"||n==="background"&&r&&(t==="table"||t==="td"||t==="th")?Qe(e,r):n==="srcset"&&r?_i(e,r):n==="style"&&r?Dt(r,cn()):t==="object"&&n==="data"&&r?Qe(e,r):r}function Zi(e,t,n){if(typeof t=="string"){if(e.classList.contains(t))return!0}else for(var r=e.classList.length;r--;){var o=e.classList[r];if(t.test(o))return!0}return n?e.matches(n):!1}function Ft(e,t,n){if(!e)return!1;if(e.nodeType!==e.ELEMENT_NODE)return n?Ft(e.parentNode,t,n):!1;for(var r=e.classList.length;r--;){var o=e.classList[r];if(t.test(o))return!0}return n?Ft(e.parentNode,t,n):!1}function rr(e,t,n){var r=e.nodeType===e.ELEMENT_NODE?e:e.parentElement;if(r===null)return!1;if(typeof t=="string"){if(r.classList.contains(t)||r.closest(".".concat(t)))return!0}else if(Ft(r,t,!0))return!0;return!!(n&&(r.matches(n)||r.closest(n)))}function Ki(e,t,n){var r=e.contentWindow;if(r){var o=!1,i;try{i=r.document.readyState}catch{return}if(i!=="complete"){var s=setTimeout(function(){o||(t(),o=!0)},n);e.addEventListener("load",function(){clearTimeout(s),o=!0,t()});return}var a="about:blank";if(r.location.href!==a||e.src===a||e.src==="")return setTimeout(t,0),e.addEventListener("load",t);e.addEventListener("load",t)}}function Yi(e,t,n){var r=!1,o;try{o=e.sheet}catch{return}if(!o){var i=setTimeout(function(){r||(t(),r=!0)},n);e.addEventListener("load",function(){clearTimeout(i),r=!0,t()})}}function $i(e,t){var n=t.doc,r=t.mirror,o=t.blockClass,i=t.blockSelector,s=t.maskTextClass,a=t.maskTextSelector,l=t.inlineStylesheet,c=t.maskInputOptions,d=c===void 0?{}:c,u=t.maskTextFn,p=t.maskInputFn,g=t.dataURLOptions,h=g===void 0?{}:g,m=t.inlineImages,I=t.recordCanvas,y=t.keepIframeSrcFn,f=t.newlyAddedElement,w=f===void 0?!1:f,A=zi(n,r);switch(e.nodeType){case e.DOCUMENT_NODE:return e.compatMode!=="CSS1Compat"?{type:ue.Document,childNodes:[],compatMode:e.compatMode}:{type:ue.Document,childNodes:[]};case e.DOCUMENT_TYPE_NODE:return{type:ue.DocumentType,name:e.name,publicId:e.publicId,systemId:e.systemId,rootId:A};case e.ELEMENT_NODE:return Qi(e,{doc:n,blockClass:o,blockSelector:i,inlineStylesheet:l,maskInputOptions:d,maskInputFn:p,dataURLOptions:h,inlineImages:m,recordCanvas:I,keepIframeSrcFn:y,newlyAddedElement:w,rootId:A});case e.TEXT_NODE:return Hi(e,{maskTextClass:s,maskTextSelector:a,maskTextFn:u,rootId:A});case e.CDATA_SECTION_NODE:return{type:ue.CDATA,textContent:"",rootId:A};case e.COMMENT_NODE:return{type:ue.Comment,textContent:e.textContent||"",rootId:A};default:return!1}}function zi(e,t){if(t.hasNode(e)){var n=t.getId(e);return n===1?void 0:n}}function Hi(e,t){var n,r=t.maskTextClass,o=t.maskTextSelector,i=t.maskTextFn,s=t.rootId,a=e.parentNode&&e.parentNode.tagName,l=e.textContent,c=a==="STYLE"?!0:void 0,d=a==="SCRIPT"?!0:void 0;if(c&&l){try{e.nextSibling||e.previousSibling||!((n=e.parentNode.sheet)===null||n===void 0)&&n.cssRules&&(l=Li(e.parentNode.sheet))}catch(u){console.warn("Cannot get CSS styles from text's parentNode. Error: ".concat(u),e)}l=Dt(l,cn())}return d&&(l="SCRIPT_PLACEHOLDER"),!c&&!d&&l&&rr(e,r,o)&&(l=i?i(l):l.replace(/[\S]/g,"*")),{type:ue.Text,textContent:l||"",isStyle:c,rootId:s}}function Qi(e,t){for(var n=t.doc,r=t.blockClass,o=t.blockSelector,i=t.inlineStylesheet,s=t.maskInputOptions,a=s===void 0?{}:s,l=t.maskInputFn,c=t.dataURLOptions,d=c===void 0?{}:c,u=t.inlineImages,p=t.recordCanvas,g=t.keepIframeSrcFn,h=t.newlyAddedElement,m=h===void 0?!1:h,I=t.rootId,y=Zi(e,r,o),f=xi(e),w={},A=e.attributes.length,L=0;L<A;L++){var O=e.attributes[L];w[O.name]=nr(n,f,O.name,O.value)}if(f==="link"&&i){var W=Array.from(n.styleSheets).find(function(G){return G.href===e.href}),k=null;W&&(k=an(W)),k&&(delete w.rel,delete w.href,w._cssText=Dt(k,W.href))}if(f==="style"&&e.sheet&&!(e.innerText||e.textContent||"").trim().length){var k=an(e.sheet);k&&(w._cssText=Dt(k,cn()))}if(f==="input"||f==="textarea"||f==="select"){var v=e.value,E=e.checked;w.type!=="radio"&&w.type!=="checkbox"&&w.type!=="submit"&&w.type!=="button"&&v?w.value=ln({type:w.type,tagName:f,value:v,maskInputOptions:a,maskInputFn:l}):E&&(w.checked=E)}if(f==="option"&&(e.selected&&!a.select?w.selected=!0:delete w.selected),f==="canvas"&&p){if(e.__context==="2d")ki(e)||(w.rr_dataURL=e.toDataURL(d.type,d.quality));else if(!("__context"in e)){var C=e.toDataURL(d.type,d.quality),b=document.createElement("canvas");b.width=e.width,b.height=e.height;var M=b.toDataURL(d.type,d.quality);C!==M&&(w.rr_dataURL=C)}}if(f==="img"&&u){He||(He=n.createElement("canvas"),tr=He.getContext("2d"));var T=e,V=T.crossOrigin;T.crossOrigin="anonymous";var x=function(){try{He.width=T.naturalWidth,He.height=T.naturalHeight,tr.drawImage(T,0,0),w.rr_dataURL=He.toDataURL(d.type,d.quality)}catch(G){console.warn("Cannot inline img src=".concat(T.currentSrc,"! Error: ").concat(G))}V?w.crossOrigin=V:T.removeAttribute("crossorigin")};T.complete&&T.naturalWidth!==0?x():T.onload=x}if((f==="audio"||f==="video")&&(w.rr_mediaState=e.paused?"paused":"played",w.rr_mediaCurrentTime=e.currentTime),m||(e.scrollLeft&&(w.rr_scrollLeft=e.scrollLeft),e.scrollTop&&(w.rr_scrollTop=e.scrollTop)),y){var S=e.getBoundingClientRect(),U=S.width,F=S.height;w={class:w.class,rr_width:"".concat(U,"px"),rr_height:"".concat(F,"px")}}return f==="iframe"&&!g(w.src)&&(e.contentDocument||(w.rr_src=w.src),delete w.src),{type:ue.Element,tagName:f,attributes:w,childNodes:[],isSVG:Gi(e)||void 0,needBlock:y,rootId:I}}function te(e){return e===void 0?"":e.toLowerCase()}function Ji(e,t){if(t.comment&&e.type===ue.Comment)return!0;if(e.type===ue.Element){if(t.script&&(e.tagName==="script"||e.tagName==="link"&&e.attributes.rel==="preload"&&e.attributes.as==="script"||e.tagName==="link"&&e.attributes.rel==="prefetch"&&typeof e.attributes.href=="string"&&e.attributes.href.endsWith(".js")))return!0;if(t.headFavicon&&(e.tagName==="link"&&e.attributes.rel==="shortcut icon"||e.tagName==="meta"&&(te(e.attributes.name).match(/^msapplication-tile(image|color)$/)||te(e.attributes.name)==="application-name"||te(e.attributes.rel)==="icon"||te(e.attributes.rel)==="apple-touch-icon"||te(e.attributes.rel)==="shortcut icon")))return!0;if(e.tagName==="meta"){if(t.headMetaDescKeywords&&te(e.attributes.name).match(/^description|keywords$/))return!0;if(t.headMetaSocial&&(te(e.attributes.property).match(/^(og|twitter|fb):/)||te(e.attributes.name).match(/^(og|twitter):/)||te(e.attributes.name)==="pinterest"))return!0;if(t.headMetaRobots&&(te(e.attributes.name)==="robots"||te(e.attributes.name)==="googlebot"||te(e.attributes.name)==="bingbot"))return!0;if(t.headMetaHttpEquiv&&e.attributes["http-equiv"]!==void 0)return!0;if(t.headMetaAuthorship&&(te(e.attributes.name)==="author"||te(e.attributes.name)==="generator"||te(e.attributes.name)==="framework"||te(e.attributes.name)==="publisher"||te(e.attributes.name)==="progid"||te(e.attributes.property).match(/^article:/)||te(e.attributes.property).match(/^product:/)))return!0;if(t.headMetaVerification&&(te(e.attributes.name)==="google-site-verification"||te(e.attributes.name)==="yandex-verification"||te(e.attributes.name)==="csrf-token"||te(e.attributes.name)==="p:domain_verify"||te(e.attributes.name)==="verify-v1"||te(e.attributes.name)==="verification"||te(e.attributes.name)==="shopify-checkout-api-token"))return!0}}return!1}function Je(e,t){var n=t.doc,r=t.mirror,o=t.blockClass,i=t.blockSelector,s=t.maskTextClass,a=t.maskTextSelector,l=t.skipChild,c=l===void 0?!1:l,d=t.inlineStylesheet,u=d===void 0?!0:d,p=t.maskInputOptions,g=p===void 0?{}:p,h=t.maskTextFn,m=t.maskInputFn,I=t.slimDOMOptions,y=t.dataURLOptions,f=y===void 0?{}:y,w=t.inlineImages,A=w===void 0?!1:w,L=t.recordCanvas,O=L===void 0?!1:L,W=t.onSerialize,k=t.onIframeLoad,v=t.iframeLoadTimeout,E=v===void 0?5e3:v,C=t.onStylesheetLoad,b=t.stylesheetLoadTimeout,M=b===void 0?5e3:b,T=t.keepIframeSrcFn,V=T===void 0?function(){return!1}:T,x=t.newlyAddedElement,S=x===void 0?!1:x,U=t.preserveWhiteSpace,F=U===void 0?!0:U,G=$i(e,{doc:n,mirror:r,blockClass:o,blockSelector:i,maskTextClass:s,maskTextSelector:a,inlineStylesheet:u,maskInputOptions:g,maskTextFn:h,maskInputFn:m,dataURLOptions:f,inlineImages:A,recordCanvas:O,keepIframeSrcFn:V,newlyAddedElement:S});if(!G)return console.warn(e,"not serialized"),null;var q;r.hasNode(e)?q=r.getId(e):Ji(G,I)||!F&&G.type===ue.Text&&!G.isStyle&&!G.textContent.replace(/^\s+|\s+$/gm,"").length?q=ut:q=er();var j=Object.assign(G,{id:q});if(r.add(e,j),q===ut)return null;W&&W(e);var J=!c;if(j.type===ue.Element){J=J&&!j.needBlock,delete j.needBlock;var N=e.shadowRoot;N&&dt(N)&&(j.isShadowHost=!0)}if((j.type===ue.Document||j.type===ue.Element)&&J){I.headWhitespace&&j.type===ue.Element&&j.tagName==="head"&&(F=!1);for(var _={doc:n,mirror:r,blockClass:o,blockSelector:i,maskTextClass:s,maskTextSelector:a,skipChild:c,inlineStylesheet:u,maskInputOptions:g,maskTextFn:h,maskInputFn:m,slimDOMOptions:I,dataURLOptions:f,inlineImages:A,recordCanvas:O,preserveWhiteSpace:F,onSerialize:W,onIframeLoad:k,iframeLoadTimeout:E,onStylesheetLoad:C,stylesheetLoadTimeout:M,keepIframeSrcFn:V},R=0,ne=Array.from(e.childNodes);R<ne.length;R++){var D=ne[R],Y=Je(D,_);Y&&j.childNodes.push(Y)}if(Ni(e)&&e.shadowRoot)for(var he=0,$=Array.from(e.shadowRoot.childNodes);he<$.length;he++){var D=$[he],Y=Je(D,_);Y&&(dt(e.shadowRoot)&&(Y.isShadow=!0),j.childNodes.push(Y))}}return e.parentNode&&ct(e.parentNode)&&dt(e.parentNode)&&(j.isShadow=!0),j.type===ue.Element&&j.tagName==="iframe"&&Ki(e,function(){var ye=e.contentDocument;if(ye&&k){var Nt=Je(ye,{doc:ye,mirror:r,blockClass:o,blockSelector:i,maskTextClass:s,maskTextSelector:a,skipChild:!1,inlineStylesheet:u,maskInputOptions:g,maskTextFn:h,maskInputFn:m,slimDOMOptions:I,dataURLOptions:f,inlineImages:A,recordCanvas:O,preserveWhiteSpace:F,onSerialize:W,onIframeLoad:k,iframeLoadTimeout:E,onStylesheetLoad:C,stylesheetLoadTimeout:M,keepIframeSrcFn:V});Nt&&k(e,Nt)}},E),j.type===ue.Element&&j.tagName==="link"&&j.attributes.rel==="stylesheet"&&Yi(e,function(){if(C){var ye=Je(e,{doc:n,mirror:r,blockClass:o,blockSelector:i,maskTextClass:s,maskTextSelector:a,skipChild:!1,inlineStylesheet:u,maskInputOptions:g,maskTextFn:h,maskInputFn:m,slimDOMOptions:I,dataURLOptions:f,inlineImages:A,recordCanvas:O,preserveWhiteSpace:F,onSerialize:W,onIframeLoad:k,iframeLoadTimeout:E,onStylesheetLoad:C,stylesheetLoadTimeout:M,keepIframeSrcFn:V});ye&&C(e,ye)}},M),j}function ji(e,t){var n=t||{},r=n.mirror,o=r===void 0?new Xn:r,i=n.blockClass,s=i===void 0?"rr-block":i,a=n.blockSelector,l=a===void 0?null:a,c=n.maskTextClass,d=c===void 0?"rr-mask":c,u=n.maskTextSelector,p=u===void 0?null:u,g=n.inlineStylesheet,h=g===void 0?!0:g,m=n.inlineImages,I=m===void 0?!1:m,y=n.recordCanvas,f=y===void 0?!1:y,w=n.maskAllInputs,A=w===void 0?!1:w,L=n.maskTextFn,O=n.maskInputFn,W=n.slimDOM,k=W===void 0?!1:W,v=n.dataURLOptions,E=n.preserveWhiteSpace,C=n.onSerialize,b=n.onIframeLoad,M=n.iframeLoadTimeout,T=n.onStylesheetLoad,V=n.stylesheetLoadTimeout,x=n.keepIframeSrcFn,S=x===void 0?function(){return!1}:x,U=A===!0?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,password:!0}:A===!1?{password:!0}:A,F=k===!0||k==="all"?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaDescKeywords:k==="all",headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaAuthorship:!0,headMetaVerification:!0}:k===!1?{}:k;return Je(e,{doc:e,mirror:o,blockClass:s,blockSelector:l,maskTextClass:d,maskTextSelector:p,skipChild:!1,inlineStylesheet:h,maskInputOptions:U,maskTextFn:L,maskInputFn:O,slimDOMOptions:F,dataURLOptions:v,inlineImages:I,recordCanvas:f,preserveWhiteSpace:E,onSerialize:C,onIframeLoad:b,iframeLoadTimeout:M,onStylesheetLoad:T,stylesheetLoadTimeout:V,keepIframeSrcFn:S,newlyAddedElement:!1})}function pe(e,t,n=document){const r={capture:!0,passive:!0};return n.addEventListener(e,t,r),()=>n.removeEventListener(e,t,r)}const je=`Please stop import mirror directly. Instead of that,\r
now you can use replayer.getMirror() to access the mirror instance of a replayer,\r
or you can use record.mirror to access the mirror instance during recording.`;let or={map:{},getId(){return console.error(je),-1},getNode(){return console.error(je),null},removeNodeFromMap(){console.error(je)},has(){return console.error(je),!1},reset(){console.error(je)}};typeof window<"u"&&window.Proxy&&window.Reflect&&(or=new Proxy(or,{get(e,t,n){return t==="map"&&console.error(je),Reflect.get(e,t,n)}}));function ht(e,t,n={}){let r=null,o=0;return function(...i){const s=Date.now();!o&&n.leading===!1&&(o=s);const a=t-(s-o),l=this;a<=0||a>t?(r&&(clearTimeout(r),r=null),o=s,e.apply(l,i)):!r&&n.trailing!==!1&&(r=setTimeout(()=>{o=n.leading===!1?0:Date.now(),r=null,e.apply(l,i)},a))}}function xt(e,t,n,r,o=window){const i=o.Object.getOwnPropertyDescriptor(e,t);return o.Object.defineProperty(e,t,r?n:{set(s){setTimeout(()=>{n.set.call(this,s)},0),i&&i.set&&i.set.call(this,s)}}),()=>xt(e,t,i||{},!0)}function Xe(e,t,n){try{if(!(t in e))return()=>{};const r=e[t],o=n(r);return typeof o=="function"&&(o.prototype=o.prototype||{},Object.defineProperties(o,{__rrweb_original__:{enumerable:!1,value:r}})),e[t]=o,()=>{e[t]=r}}catch{return()=>{}}}function ir(){return window.innerHeight||document.documentElement&&document.documentElement.clientHeight||document.body&&document.body.clientHeight}function sr(){return window.innerWidth||document.documentElement&&document.documentElement.clientWidth||document.body&&document.body.clientWidth}function me(e,t,n,r){if(!e)return!1;const o=e.nodeType===e.ELEMENT_NODE?e:e.parentElement;if(!o)return!1;if(typeof t=="string"){if(o.classList.contains(t)||r&&o.closest("."+t)!==null)return!0}else if(Ft(o,t,r))return!0;return!!(n&&(e.matches(n)||r&&o.closest(n)!==null))}function Xi(e,t){return t.getId(e)!==-1}function dn(e,t){return t.getId(e)===ut}function ar(e,t){if(ct(e))return!1;const n=t.getId(e);return t.has(n)?e.parentNode&&e.parentNode.nodeType===e.DOCUMENT_NODE?!1:e.parentNode?ar(e.parentNode,t):!0:!0}function lr(e){return!!e.changedTouches}function qi(e=window){"NodeList"in e&&!e.NodeList.prototype.forEach&&(e.NodeList.prototype.forEach=Array.prototype.forEach),"DOMTokenList"in e&&!e.DOMTokenList.prototype.forEach&&(e.DOMTokenList.prototype.forEach=Array.prototype.forEach),Node.prototype.contains||(Node.prototype.contains=(...t)=>{let n=t[0];if(!(0 in t))throw new TypeError("1 argument is required");do if(this===n)return!0;while(n=n&&n.parentNode);return!1})}function cr(e,t){return!!(e.nodeName==="IFRAME"&&t.getMeta(e))}function dr(e,t){return!!(e.nodeName==="LINK"&&e.nodeType===e.ELEMENT_NODE&&e.getAttribute&&e.getAttribute("rel")==="stylesheet"&&t.getMeta(e))}function ur(e){return!!(e!=null&&e.shadowRoot)}class es{constructor(){this.id=1,this.styleIDMap=new WeakMap,this.idStyleMap=new Map}getId(t){var n;return(n=this.styleIDMap.get(t))!==null&&n!==void 0?n:-1}has(t){return this.styleIDMap.has(t)}add(t,n){if(this.has(t))return this.getId(t);let r;return n===void 0?r=this.id++:r=n,this.styleIDMap.set(t,r),this.idStyleMap.set(r,t),r}getStyle(t){return this.idStyleMap.get(t)||null}reset(){this.styleIDMap=new WeakMap,this.idStyleMap=new Map,this.id=1}generateId(){return this.id++}}var z=(e=>(e[e.DomContentLoaded=0]="DomContentLoaded",e[e.Load=1]="Load",e[e.FullSnapshot=2]="FullSnapshot",e[e.IncrementalSnapshot=3]="IncrementalSnapshot",e[e.Meta=4]="Meta",e[e.Custom=5]="Custom",e[e.Plugin=6]="Plugin",e))(z||{}),K=(e=>(e[e.Mutation=0]="Mutation",e[e.MouseMove=1]="MouseMove",e[e.MouseInteraction=2]="MouseInteraction",e[e.Scroll=3]="Scroll",e[e.ViewportResize=4]="ViewportResize",e[e.Input=5]="Input",e[e.TouchMove=6]="TouchMove",e[e.MediaInteraction=7]="MediaInteraction",e[e.StyleSheetRule=8]="StyleSheetRule",e[e.CanvasMutation=9]="CanvasMutation",e[e.Font=10]="Font",e[e.Log=11]="Log",e[e.Drag=12]="Drag",e[e.StyleDeclaration=13]="StyleDeclaration",e[e.Selection=14]="Selection",e[e.AdoptedStyleSheet=15]="AdoptedStyleSheet",e))(K||{}),un=(e=>(e[e.MouseUp=0]="MouseUp",e[e.MouseDown=1]="MouseDown",e[e.Click=2]="Click",e[e.ContextMenu=3]="ContextMenu",e[e.DblClick=4]="DblClick",e[e.Focus=5]="Focus",e[e.Blur=6]="Blur",e[e.TouchStart=7]="TouchStart",e[e.TouchMove_Departed=8]="TouchMove_Departed",e[e.TouchEnd=9]="TouchEnd",e[e.TouchCancel=10]="TouchCancel",e))(un||{}),qe=(e=>(e[e["2D"]=0]="2D",e[e.WebGL=1]="WebGL",e[e.WebGL2=2]="WebGL2",e))(qe||{});function hr(e){return"__ln"in e}class ts{constructor(){this.length=0,this.head=null}get(t){if(t>=this.length)throw new Error("Position outside of list range");let n=this.head;for(let r=0;r<t;r++)n=(n==null?void 0:n.next)||null;return n}addNode(t){const n={value:t,previous:null,next:null};if(t.__ln=n,t.previousSibling&&hr(t.previousSibling)){const r=t.previousSibling.__ln.next;n.next=r,n.previous=t.previousSibling.__ln,t.previousSibling.__ln.next=n,r&&(r.previous=n)}else if(t.nextSibling&&hr(t.nextSibling)&&t.nextSibling.__ln.previous){const r=t.nextSibling.__ln.previous;n.previous=r,n.next=t.nextSibling.__ln,t.nextSibling.__ln.previous=n,r&&(r.next=n)}else this.head&&(this.head.previous=n),n.next=this.head,this.head=n;this.length++}removeNode(t){const n=t.__ln;this.head&&(n.previous?(n.previous.next=n.next,n.next&&(n.next.previous=n.previous)):(this.head=n.next,this.head&&(this.head.previous=null)),t.__ln&&delete t.__ln,this.length--)}}const pr=(e,t)=>`${e}@${t}`;class ns{constructor(){this.frozen=!1,this.locked=!1,this.texts=[],this.attributes=[],this.removes=[],this.mapRemoves=[],this.movedMap={},this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.processMutations=t=>{t.forEach(this.processMutation),this.emit()},this.emit=()=>{if(this.frozen||this.locked)return;const t=[],n=new ts,r=a=>{let l=a,c=ut;for(;c===ut;)l=l&&l.nextSibling,c=l&&this.mirror.getId(l);return c},o=a=>{var l,c,d,u;let p=null;((c=(l=a.getRootNode)===null||l===void 0?void 0:l.call(a))===null||c===void 0?void 0:c.nodeType)===Node.DOCUMENT_FRAGMENT_NODE&&a.getRootNode().host&&(p=a.getRootNode().host);let g=p;for(;((u=(d=g==null?void 0:g.getRootNode)===null||d===void 0?void 0:d.call(g))===null||u===void 0?void 0:u.nodeType)===Node.DOCUMENT_FRAGMENT_NODE&&g.getRootNode().host;)g=g.getRootNode().host;const h=!this.doc.contains(a)&&(!g||!this.doc.contains(g));if(!a.parentNode||h)return;const m=ct(a.parentNode)?this.mirror.getId(p):this.mirror.getId(a.parentNode),I=r(a);if(m===-1||I===-1)return n.addNode(a);const y=Je(a,{doc:this.doc,mirror:this.mirror,blockClass:this.blockClass,blockSelector:this.blockSelector,maskTextClass:this.maskTextClass,maskTextSelector:this.maskTextSelector,skipChild:!0,newlyAddedElement:!0,inlineStylesheet:this.inlineStylesheet,maskInputOptions:this.maskInputOptions,maskTextFn:this.maskTextFn,maskInputFn:this.maskInputFn,slimDOMOptions:this.slimDOMOptions,dataURLOptions:this.dataURLOptions,recordCanvas:this.recordCanvas,inlineImages:this.inlineImages,onSerialize:f=>{cr(f,this.mirror)&&this.iframeManager.addIframe(f),dr(f,this.mirror)&&this.stylesheetManager.trackLinkElement(f),ur(a)&&this.shadowDomManager.addShadowRoot(a.shadowRoot,this.doc)},onIframeLoad:(f,w)=>{this.iframeManager.attachIframe(f,w),this.shadowDomManager.observeAttachShadow(f)},onStylesheetLoad:(f,w)=>{this.stylesheetManager.attachLinkElement(f,w)}});y&&t.push({parentId:m,nextId:I,node:y})};for(;this.mapRemoves.length;)this.mirror.removeNodeFromMap(this.mapRemoves.shift());for(const a of Array.from(this.movedSet.values()))mr(this.removes,a,this.mirror)&&!this.movedSet.has(a.parentNode)||o(a);for(const a of Array.from(this.addedSet.values()))!fr(this.droppedSet,a)&&!mr(this.removes,a,this.mirror)||fr(this.movedSet,a)?o(a):this.droppedSet.add(a);let i=null;for(;n.length;){let a=null;if(i){const l=this.mirror.getId(i.value.parentNode),c=r(i.value);l!==-1&&c!==-1&&(a=i)}if(!a)for(let l=n.length-1;l>=0;l--){const c=n.get(l);if(c){const d=this.mirror.getId(c.value.parentNode);if(r(c.value)===-1)continue;if(d!==-1){a=c;break}else{const p=c.value;if(p.parentNode&&p.parentNode.nodeType===Node.DOCUMENT_FRAGMENT_NODE){const g=p.parentNode.host;if(this.mirror.getId(g)!==-1){a=c;break}}}}}if(!a){for(;n.head;)n.removeNode(n.head.value);break}i=a.previous,n.removeNode(a.value),o(a.value)}const s={texts:this.texts.map(a=>({id:this.mirror.getId(a.node),value:a.value})).filter(a=>this.mirror.has(a.id)),attributes:this.attributes.map(a=>({id:this.mirror.getId(a.node),attributes:a.attributes})).filter(a=>this.mirror.has(a.id)),removes:this.removes,adds:t};!s.texts.length&&!s.attributes.length&&!s.removes.length&&!s.adds.length||(this.texts=[],this.attributes=[],this.removes=[],this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.movedMap={},this.mutationCb(s))},this.processMutation=t=>{if(!dn(t.target,this.mirror))switch(t.type){case"characterData":{const n=t.target.textContent;!me(t.target,this.blockClass,this.blockSelector,!1)&&n!==t.oldValue&&this.texts.push({value:rr(t.target,this.maskTextClass,this.maskTextSelector)&&n?this.maskTextFn?this.maskTextFn(n):n.replace(/[\S]/g,"*"):n,node:t.target});break}case"attributes":{const n=t.target;let r=t.target.getAttribute(t.attributeName);if(t.attributeName==="value"&&(r=ln({maskInputOptions:this.maskInputOptions,tagName:t.target.tagName,type:t.target.getAttribute("type"),value:r,maskInputFn:this.maskInputFn})),me(t.target,this.blockClass,this.blockSelector,!1)||r===t.oldValue)return;let o=this.attributes.find(i=>i.node===t.target);if(n.tagName==="IFRAME"&&t.attributeName==="src"&&!this.keepIframeSrcFn(r))if(!n.contentDocument)t.attributeName="rr_src";else return;if(o||(o={node:t.target,attributes:{}},this.attributes.push(o)),t.attributeName==="style"){const i=this.doc.createElement("span");t.oldValue&&i.setAttribute("style",t.oldValue),(o.attributes.style===void 0||o.attributes.style===null)&&(o.attributes.style={});const s=o.attributes.style;for(const a of Array.from(n.style)){const l=n.style.getPropertyValue(a),c=n.style.getPropertyPriority(a);(l!==i.style.getPropertyValue(a)||c!==i.style.getPropertyPriority(a))&&(c===""?s[a]=l:s[a]=[l,c])}for(const a of Array.from(i.style))n.style.getPropertyValue(a)===""&&(s[a]=!1)}else o.attributes[t.attributeName]=nr(this.doc,n.tagName,t.attributeName,r);break}case"childList":{if(me(t.target,this.blockClass,this.blockSelector,!0))return;t.addedNodes.forEach(n=>this.genAdds(n,t.target)),t.removedNodes.forEach(n=>{const r=this.mirror.getId(n),o=ct(t.target)?this.mirror.getId(t.target.host):this.mirror.getId(t.target);me(t.target,this.blockClass,this.blockSelector,!1)||dn(n,this.mirror)||!Xi(n,this.mirror)||(this.addedSet.has(n)?(hn(this.addedSet,n),this.droppedSet.add(n)):this.addedSet.has(t.target)&&r===-1||ar(t.target,this.mirror)||(this.movedSet.has(n)&&this.movedMap[pr(r,o)]?hn(this.movedSet,n):this.removes.push({parentId:o,id:r,isShadow:ct(t.target)&&dt(t.target)?!0:void 0})),this.mapRemoves.push(n))});break}}},this.genAdds=(t,n)=>{if(this.mirror.hasNode(t)){if(dn(t,this.mirror))return;this.movedSet.add(t);let r=null;n&&this.mirror.hasNode(n)&&(r=this.mirror.getId(n)),r&&r!==-1&&(this.movedMap[pr(this.mirror.getId(t),r)]=!0)}else this.addedSet.add(t),this.droppedSet.delete(t);me(t,this.blockClass,this.blockSelector,!1)||t.childNodes.forEach(r=>this.genAdds(r))}}init(t){["mutationCb","blockClass","blockSelector","maskTextClass","maskTextSelector","inlineStylesheet","maskInputOptions","maskTextFn","maskInputFn","keepIframeSrcFn","recordCanvas","inlineImages","slimDOMOptions","dataURLOptions","doc","mirror","iframeManager","stylesheetManager","shadowDomManager","canvasManager"].forEach(n=>{this[n]=t[n]})}freeze(){this.frozen=!0,this.canvasManager.freeze()}unfreeze(){this.frozen=!1,this.canvasManager.unfreeze(),this.emit()}isFrozen(){return this.frozen}lock(){this.locked=!0,this.canvasManager.lock()}unlock(){this.locked=!1,this.canvasManager.unlock(),this.emit()}reset(){this.shadowDomManager.reset(),this.canvasManager.reset()}}function hn(e,t){e.delete(t),t.childNodes.forEach(n=>hn(e,n))}function mr(e,t,n){return e.length===0?!1:gr(e,t,n)}function gr(e,t,n){const{parentNode:r}=t;if(!r)return!1;const o=n.getId(r);return e.some(i=>i.id===o)?!0:gr(e,r,n)}function fr(e,t){return e.size===0?!1:yr(e,t)}function yr(e,t){const{parentNode:n}=t;return n?e.has(n)?!0:yr(e,n):!1}const _e=[],Ir=typeof CSSGroupingRule<"u",Cr=typeof CSSMediaRule<"u",vr=typeof CSSSupportsRule<"u",br=typeof CSSConditionRule<"u";function pt(e){try{if("composedPath"in e){const t=e.composedPath();if(t.length)return t[0]}else if("path"in e&&e.path.length)return e.path[0];return e.target}catch{return e.target}}function wr(e,t){var n,r;const o=new ns;_e.push(o),o.init(e);let i=window.MutationObserver||window.__rrMutationObserver;const s=(r=(n=window==null?void 0:window.Zone)===null||n===void 0?void 0:n.__symbol__)===null||r===void 0?void 0:r.call(n,"MutationObserver");s&&window[s]&&(i=window[s]);const a=new i(o.processMutations.bind(o));return a.observe(t,{attributes:!0,attributeOldValue:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0}),a}function rs({mousemoveCb:e,sampling:t,doc:n,mirror:r}){if(t.mousemove===!1)return()=>{};const o=typeof t.mousemove=="number"?t.mousemove:50,i=typeof t.mousemoveCallback=="number"?t.mousemoveCallback:500;let s=[],a;const l=ht(u=>{const p=Date.now()-a;e(s.map(g=>(g.timeOffset-=p,g)),u),s=[],a=null},i),c=ht(u=>{const p=pt(u),{clientX:g,clientY:h}=lr(u)?u.changedTouches[0]:u;a||(a=Date.now()),s.push({x:g,y:h,id:r.getId(p),timeOffset:Date.now()-a}),l(typeof DragEvent<"u"&&u instanceof DragEvent?K.Drag:u instanceof MouseEvent?K.MouseMove:K.TouchMove)},o,{trailing:!1}),d=[pe("mousemove",c,n),pe("touchmove",c,n),pe("drag",c,n)];return()=>{d.forEach(u=>u())}}function os({mouseInteractionCb:e,doc:t,mirror:n,blockClass:r,blockSelector:o,sampling:i}){if(i.mouseInteraction===!1)return()=>{};const s=i.mouseInteraction===!0||i.mouseInteraction===void 0?{}:i.mouseInteraction,a=[],l=c=>d=>{const u=pt(d);if(me(u,r,o,!0))return;const p=lr(d)?d.changedTouches[0]:d;if(!p)return;const g=n.getId(u),{clientX:h,clientY:m}=p;e({type:un[c],id:g,x:h,y:m})};return Object.keys(un).filter(c=>Number.isNaN(Number(c))&&!c.endsWith("_Departed")&&s[c]!==!1).forEach(c=>{const d=c.toLowerCase(),u=l(c);a.push(pe(d,u,t))}),()=>{a.forEach(c=>c())}}function Sr({scrollCb:e,doc:t,mirror:n,blockClass:r,blockSelector:o,sampling:i}){const s=ht(a=>{const l=pt(a);if(!l||me(l,r,o,!0))return;const c=n.getId(l);if(l===t){const d=t.scrollingElement||t.documentElement;e({id:c,x:d.scrollLeft,y:d.scrollTop})}else e({id:c,x:l.scrollLeft,y:l.scrollTop})},i.scroll||100);return pe("scroll",s,t)}function is({viewportResizeCb:e}){let t=-1,n=-1;const r=ht(()=>{const o=ir(),i=sr();(t!==o||n!==i)&&(e({width:Number(i),height:Number(o)}),t=o,n=i)},200);return pe("resize",r,window)}function Ar(e,t){const n=Object.assign({},e);return t||delete n.userTriggered,n}const ss=["INPUT","TEXTAREA","SELECT"],Er=new WeakMap;function as({inputCb:e,doc:t,mirror:n,blockClass:r,blockSelector:o,ignoreClass:i,maskInputOptions:s,maskInputFn:a,sampling:l,userTriggeredOnInput:c}){function d(y){let f=pt(y);const w=y.isTrusted;if(f&&f.tagName==="OPTION"&&(f=f.parentElement),!f||!f.tagName||ss.indexOf(f.tagName)<0||me(f,r,o,!0))return;const A=f.type;if(f.classList.contains(i))return;let L=f.value,O=!1;A==="radio"||A==="checkbox"?O=f.checked:(s[f.tagName.toLowerCase()]||s[A])&&(L=ln({maskInputOptions:s,tagName:f.tagName,type:A,value:L,maskInputFn:a})),u(f,Ar({text:L,isChecked:O,userTriggered:w},c));const W=f.name;A==="radio"&&W&&O&&t.querySelectorAll(`input[type="radio"][name="${W}"]`).forEach(k=>{k!==f&&u(k,Ar({text:k.value,isChecked:!O,userTriggered:!1},c))})}function u(y,f){const w=Er.get(y);if(!w||w.text!==f.text||w.isChecked!==f.isChecked){Er.set(y,f);const A=n.getId(y);e(Object.assign(Object.assign({},f),{id:A}))}}const g=(l.input==="last"?["change"]:["input","change"]).map(y=>pe(y,d,t)),h=t.defaultView;if(!h)return()=>{g.forEach(y=>y())};const m=h.Object.getOwnPropertyDescriptor(h.HTMLInputElement.prototype,"value"),I=[[h.HTMLInputElement.prototype,"value"],[h.HTMLInputElement.prototype,"checked"],[h.HTMLSelectElement.prototype,"value"],[h.HTMLTextAreaElement.prototype,"value"],[h.HTMLSelectElement.prototype,"selectedIndex"],[h.HTMLOptionElement.prototype,"selected"]];return m&&m.set&&g.push(...I.map(y=>xt(y[0],y[1],{set(){d({target:this})}},!1,h))),()=>{g.forEach(y=>y())}}function Lt(e){const t=[];function n(r,o){if(Ir&&r.parentRule instanceof CSSGroupingRule||Cr&&r.parentRule instanceof CSSMediaRule||vr&&r.parentRule instanceof CSSSupportsRule||br&&r.parentRule instanceof CSSConditionRule){const s=Array.from(r.parentRule.cssRules).indexOf(r);o.unshift(s)}else if(r.parentStyleSheet){const s=Array.from(r.parentStyleSheet.cssRules).indexOf(r);o.unshift(s)}return o}return n(e,t)}function Oe(e,t,n){let r,o;return e?(e.ownerNode?r=t.getId(e.ownerNode):o=n.getId(e),{styleId:o,id:r}):{}}function ls({styleSheetRuleCb:e,mirror:t,stylesheetManager:n},{win:r}){const o=r.CSSStyleSheet.prototype.insertRule;r.CSSStyleSheet.prototype.insertRule=function(d,u){const{id:p,styleId:g}=Oe(this,t,n.styleMirror);return(p&&p!==-1||g&&g!==-1)&&e({id:p,styleId:g,adds:[{rule:d,index:u}]}),o.apply(this,[d,u])};const i=r.CSSStyleSheet.prototype.deleteRule;r.CSSStyleSheet.prototype.deleteRule=function(d){const{id:u,styleId:p}=Oe(this,t,n.styleMirror);return(u&&u!==-1||p&&p!==-1)&&e({id:u,styleId:p,removes:[{index:d}]}),i.apply(this,[d])};let s;r.CSSStyleSheet.prototype.replace&&(s=r.CSSStyleSheet.prototype.replace,r.CSSStyleSheet.prototype.replace=function(d){const{id:u,styleId:p}=Oe(this,t,n.styleMirror);return(u&&u!==-1||p&&p!==-1)&&e({id:u,styleId:p,replace:d}),s.apply(this,[d])});let a;r.CSSStyleSheet.prototype.replaceSync&&(a=r.CSSStyleSheet.prototype.replaceSync,r.CSSStyleSheet.prototype.replaceSync=function(d){const{id:u,styleId:p}=Oe(this,t,n.styleMirror);return(u&&u!==-1||p&&p!==-1)&&e({id:u,styleId:p,replaceSync:d}),a.apply(this,[d])});const l={};Ir?l.CSSGroupingRule=r.CSSGroupingRule:(Cr&&(l.CSSMediaRule=r.CSSMediaRule),br&&(l.CSSConditionRule=r.CSSConditionRule),vr&&(l.CSSSupportsRule=r.CSSSupportsRule));const c={};return Object.entries(l).forEach(([d,u])=>{c[d]={insertRule:u.prototype.insertRule,deleteRule:u.prototype.deleteRule},u.prototype.insertRule=function(p,g){const{id:h,styleId:m}=Oe(this.parentStyleSheet,t,n.styleMirror);return(h&&h!==-1||m&&m!==-1)&&e({id:h,styleId:m,adds:[{rule:p,index:[...Lt(this),g||0]}]}),c[d].insertRule.apply(this,[p,g])},u.prototype.deleteRule=function(p){const{id:g,styleId:h}=Oe(this.parentStyleSheet,t,n.styleMirror);return(g&&g!==-1||h&&h!==-1)&&e({id:g,styleId:h,removes:[{index:[...Lt(this),p]}]}),c[d].deleteRule.apply(this,[p])}}),()=>{r.CSSStyleSheet.prototype.insertRule=o,r.CSSStyleSheet.prototype.deleteRule=i,s&&(r.CSSStyleSheet.prototype.replace=s),a&&(r.CSSStyleSheet.prototype.replaceSync=a),Object.entries(l).forEach(([d,u])=>{u.prototype.insertRule=c[d].insertRule,u.prototype.deleteRule=c[d].deleteRule})}}function Nr({mirror:e,stylesheetManager:t},n){var r,o,i;let s=null;n.nodeName==="#document"?s=e.getId(n):s=e.getId(n.host);const a=n.nodeName==="#document"?(r=n.defaultView)===null||r===void 0?void 0:r.Document:(i=(o=n.ownerDocument)===null||o===void 0?void 0:o.defaultView)===null||i===void 0?void 0:i.ShadowRoot,l=Object.getOwnPropertyDescriptor(a==null?void 0:a.prototype,"adoptedStyleSheets");return s===null||s===-1||!a||!l?()=>{}:(Object.defineProperty(n,"adoptedStyleSheets",{configurable:l.configurable,enumerable:l.enumerable,get(){var c;return(c=l.get)===null||c===void 0?void 0:c.call(this)},set(c){var d;const u=(d=l.set)===null||d===void 0?void 0:d.call(this,c);if(s!==null&&s!==-1)try{t.adoptStyleSheets(c,s)}catch{}return u}}),()=>{Object.defineProperty(n,"adoptedStyleSheets",{configurable:l.configurable,enumerable:l.enumerable,get:l.get,set:l.set})})}function cs({styleDeclarationCb:e,mirror:t,ignoreCSSAttributes:n,stylesheetManager:r},{win:o}){const i=o.CSSStyleDeclaration.prototype.setProperty;o.CSSStyleDeclaration.prototype.setProperty=function(a,l,c){var d;if(n.has(a))return i.apply(this,[a,l,c]);const{id:u,styleId:p}=Oe((d=this.parentRule)===null||d===void 0?void 0:d.parentStyleSheet,t,r.styleMirror);return(u&&u!==-1||p&&p!==-1)&&e({id:u,styleId:p,set:{property:a,value:l,priority:c},index:Lt(this.parentRule)}),i.apply(this,[a,l,c])};const s=o.CSSStyleDeclaration.prototype.removeProperty;return o.CSSStyleDeclaration.prototype.removeProperty=function(a){var l;if(n.has(a))return s.apply(this,[a]);const{id:c,styleId:d}=Oe((l=this.parentRule)===null||l===void 0?void 0:l.parentStyleSheet,t,r.styleMirror);return(c&&c!==-1||d&&d!==-1)&&e({id:c,styleId:d,remove:{property:a},index:Lt(this.parentRule)}),s.apply(this,[a])},()=>{o.CSSStyleDeclaration.prototype.setProperty=i,o.CSSStyleDeclaration.prototype.removeProperty=s}}function ds({mediaInteractionCb:e,blockClass:t,blockSelector:n,mirror:r,sampling:o}){const i=a=>ht(l=>{const c=pt(l);if(!c||me(c,t,n,!0))return;const{currentTime:d,volume:u,muted:p,playbackRate:g}=c;e({type:a,id:r.getId(c),currentTime:d,volume:u,muted:p,playbackRate:g})},o.media||500),s=[pe("play",i(0)),pe("pause",i(1)),pe("seeked",i(2)),pe("volumechange",i(3)),pe("ratechange",i(4))];return()=>{s.forEach(a=>a())}}function us({fontCb:e,doc:t}){const n=t.defaultView;if(!n)return()=>{};const r=[],o=new WeakMap,i=n.FontFace;n.FontFace=function(l,c,d){const u=new i(l,c,d);return o.set(u,{family:l,buffer:typeof c!="string",descriptors:d,fontSource:typeof c=="string"?c:JSON.stringify(Array.from(new Uint8Array(c)))}),u};const s=Xe(t.fonts,"add",function(a){return function(l){return setTimeout(()=>{const c=o.get(l);c&&(e(c),o.delete(l))},0),a.apply(this,[l])}});return r.push(()=>{n.FontFace=i}),r.push(s),()=>{r.forEach(a=>a())}}function hs(e){const{doc:t,mirror:n,blockClass:r,blockSelector:o,selectionCb:i}=e;let s=!0;const a=()=>{const l=t.getSelection();if(!l||s&&(l!=null&&l.isCollapsed))return;s=l.isCollapsed||!1;const c=[],d=l.rangeCount||0;for(let u=0;u<d;u++){const p=l.getRangeAt(u),{startContainer:g,startOffset:h,endContainer:m,endOffset:I}=p;me(g,r,o,!0)||me(m,r,o,!0)||c.push({start:n.getId(g),startOffset:h,end:n.getId(m),endOffset:I})}i({ranges:c})};return a(),pe("selectionchange",a)}function ps(e,t){const{mutationCb:n,mousemoveCb:r,mouseInteractionCb:o,scrollCb:i,viewportResizeCb:s,inputCb:a,mediaInteractionCb:l,styleSheetRuleCb:c,styleDeclarationCb:d,canvasMutationCb:u,fontCb:p,selectionCb:g}=e;e.mutationCb=(...h)=>{t.mutation&&t.mutation(...h),n(...h)},e.mousemoveCb=(...h)=>{t.mousemove&&t.mousemove(...h),r(...h)},e.mouseInteractionCb=(...h)=>{t.mouseInteraction&&t.mouseInteraction(...h),o(...h)},e.scrollCb=(...h)=>{t.scroll&&t.scroll(...h),i(...h)},e.viewportResizeCb=(...h)=>{t.viewportResize&&t.viewportResize(...h),s(...h)},e.inputCb=(...h)=>{t.input&&t.input(...h),a(...h)},e.mediaInteractionCb=(...h)=>{t.mediaInteaction&&t.mediaInteaction(...h),l(...h)},e.styleSheetRuleCb=(...h)=>{t.styleSheetRule&&t.styleSheetRule(...h),c(...h)},e.styleDeclarationCb=(...h)=>{t.styleDeclaration&&t.styleDeclaration(...h),d(...h)},e.canvasMutationCb=(...h)=>{t.canvasMutation&&t.canvasMutation(...h),u(...h)},e.fontCb=(...h)=>{t.font&&t.font(...h),p(...h)},e.selectionCb=(...h)=>{t.selection&&t.selection(...h),g(...h)}}function ms(e,t={}){const n=e.doc.defaultView;if(!n)return()=>{};ps(e,t);const r=wr(e,e.doc),o=rs(e),i=os(e),s=Sr(e),a=is(e),l=as(e),c=ds(e),d=ls(e,{win:n}),u=Nr(e,e.doc),p=cs(e,{win:n}),g=e.collectFonts?us(e):()=>{},h=hs(e),m=[];for(const I of e.plugins)m.push(I.observer(I.callback,n,I.options));return()=>{_e.forEach(I=>I.reset()),r.disconnect(),o(),i(),s(),a(),l(),c(),d(),u(),p(),g(),h(),m.forEach(I=>I())}}class Tr{constructor(t){this.generateIdFn=t,this.iframeIdToRemoteIdMap=new WeakMap,this.iframeRemoteIdToIdMap=new WeakMap}getId(t,n,r,o){const i=r||this.getIdToRemoteIdMap(t),s=o||this.getRemoteIdToIdMap(t);let a=i.get(n);return a||(a=this.generateIdFn(),i.set(n,a),s.set(a,n)),a}getIds(t,n){const r=this.getIdToRemoteIdMap(t),o=this.getRemoteIdToIdMap(t);return n.map(i=>this.getId(t,i,r,o))}getRemoteId(t,n,r){const o=r||this.getRemoteIdToIdMap(t);if(typeof n!="number")return n;const i=o.get(n);return i||-1}getRemoteIds(t,n){const r=this.getRemoteIdToIdMap(t);return n.map(o=>this.getRemoteId(t,o,r))}reset(t){if(!t){this.iframeIdToRemoteIdMap=new WeakMap,this.iframeRemoteIdToIdMap=new WeakMap;return}this.iframeIdToRemoteIdMap.delete(t),this.iframeRemoteIdToIdMap.delete(t)}getIdToRemoteIdMap(t){let n=this.iframeIdToRemoteIdMap.get(t);return n||(n=new Map,this.iframeIdToRemoteIdMap.set(t,n)),n}getRemoteIdToIdMap(t){let n=this.iframeRemoteIdToIdMap.get(t);return n||(n=new Map,this.iframeRemoteIdToIdMap.set(t,n)),n}}class gs{constructor(t){this.iframes=new WeakMap,this.crossOriginIframeMap=new WeakMap,this.crossOriginIframeMirror=new Tr(er),this.mutationCb=t.mutationCb,this.wrappedEmit=t.wrappedEmit,this.stylesheetManager=t.stylesheetManager,this.recordCrossOriginIframes=t.recordCrossOriginIframes,this.crossOriginIframeStyleMirror=new Tr(this.stylesheetManager.styleMirror.generateId.bind(this.stylesheetManager.styleMirror)),this.mirror=t.mirror,this.recordCrossOriginIframes&&window.addEventListener("message",this.handleMessage.bind(this))}addIframe(t){this.iframes.set(t,!0),t.contentWindow&&this.crossOriginIframeMap.set(t.contentWindow,t)}addLoadListener(t){this.loadListener=t}attachIframe(t,n){var r;this.mutationCb({adds:[{parentId:this.mirror.getId(t),nextId:null,node:n}],removes:[],texts:[],attributes:[],isAttachIframe:!0}),(r=this.loadListener)===null||r===void 0||r.call(this,t),t.contentDocument&&t.contentDocument.adoptedStyleSheets&&t.contentDocument.adoptedStyleSheets.length>0&&this.stylesheetManager.adoptStyleSheets(t.contentDocument.adoptedStyleSheets,this.mirror.getId(t.contentDocument))}handleMessage(t){if(t.data.type==="rrweb"){if(!t.source)return;const r=this.crossOriginIframeMap.get(t.source);if(!r)return;const o=this.transformCrossOriginEvent(r,t.data.event);o&&this.wrappedEmit(o,t.data.isCheckout)}}transformCrossOriginEvent(t,n){var r;switch(n.type){case z.FullSnapshot:return this.crossOriginIframeMirror.reset(t),this.crossOriginIframeStyleMirror.reset(t),this.replaceIdOnNode(n.data.node,t),{timestamp:n.timestamp,type:z.IncrementalSnapshot,data:{source:K.Mutation,adds:[{parentId:this.mirror.getId(t),nextId:null,node:n.data.node}],removes:[],texts:[],attributes:[],isAttachIframe:!0}};case z.Meta:case z.Load:case z.DomContentLoaded:return!1;case z.Plugin:return n;case z.Custom:return this.replaceIds(n.data.payload,t,["id","parentId","previousId","nextId"]),n;case z.IncrementalSnapshot:switch(n.data.source){case K.Mutation:return n.data.adds.forEach(o=>{this.replaceIds(o,t,["parentId","nextId","previousId"]),this.replaceIdOnNode(o.node,t)}),n.data.removes.forEach(o=>{this.replaceIds(o,t,["parentId","id"])}),n.data.attributes.forEach(o=>{this.replaceIds(o,t,["id"])}),n.data.texts.forEach(o=>{this.replaceIds(o,t,["id"])}),n;case K.Drag:case K.TouchMove:case K.MouseMove:return n.data.positions.forEach(o=>{this.replaceIds(o,t,["id"])}),n;case K.ViewportResize:return!1;case K.MediaInteraction:case K.MouseInteraction:case K.Scroll:case K.CanvasMutation:case K.Input:return this.replaceIds(n.data,t,["id"]),n;case K.StyleSheetRule:case K.StyleDeclaration:return this.replaceIds(n.data,t,["id"]),this.replaceStyleIds(n.data,t,["styleId"]),n;case K.Font:return n;case K.Selection:return n.data.ranges.forEach(o=>{this.replaceIds(o,t,["start","end"])}),n;case K.AdoptedStyleSheet:return this.replaceIds(n.data,t,["id"]),this.replaceStyleIds(n.data,t,["styleIds"]),(r=n.data.styles)===null||r===void 0||r.forEach(o=>{this.replaceStyleIds(o,t,["styleId"])}),n}}}replace(t,n,r,o){for(const i of o)!Array.isArray(n[i])&&typeof n[i]!="number"||(Array.isArray(n[i])?n[i]=t.getIds(r,n[i]):n[i]=t.getId(r,n[i]));return n}replaceIds(t,n,r){return this.replace(this.crossOriginIframeMirror,t,n,r)}replaceStyleIds(t,n,r){return this.replace(this.crossOriginIframeStyleMirror,t,n,r)}replaceIdOnNode(t,n){this.replaceIds(t,n,["id"]),"childNodes"in t&&t.childNodes.forEach(r=>{this.replaceIdOnNode(r,n)})}}class fs{constructor(t){this.shadowDoms=new WeakSet,this.restorePatches=[],this.mutationCb=t.mutationCb,this.scrollCb=t.scrollCb,this.bypassOptions=t.bypassOptions,this.mirror=t.mirror;const n=this;this.restorePatches.push(Xe(Element.prototype,"attachShadow",function(r){return function(o){const i=r.call(this,o);return this.shadowRoot&&n.addShadowRoot(this.shadowRoot,this.ownerDocument),i}}))}addShadowRoot(t,n){dt(t)&&(this.shadowDoms.has(t)||(this.shadowDoms.add(t),wr(Object.assign(Object.assign({},this.bypassOptions),{doc:n,mutationCb:this.mutationCb,mirror:this.mirror,shadowDomManager:this}),t),Sr(Object.assign(Object.assign({},this.bypassOptions),{scrollCb:this.scrollCb,doc:t,mirror:this.mirror})),setTimeout(()=>{t.adoptedStyleSheets&&t.adoptedStyleSheets.length>0&&this.bypassOptions.stylesheetManager.adoptStyleSheets(t.adoptedStyleSheets,this.mirror.getId(t.host)),Nr({mirror:this.mirror,stylesheetManager:this.bypassOptions.stylesheetManager},t)},0)))}observeAttachShadow(t){if(t.contentWindow){const n=this;this.restorePatches.push(Xe(t.contentWindow.HTMLElement.prototype,"attachShadow",function(r){return function(o){const i=r.call(this,o);return this.shadowRoot&&n.addShadowRoot(this.shadowRoot,t.contentDocument),i}}))}}reset(){this.restorePatches.forEach(t=>t()),this.shadowDoms=new WeakSet}}/*! *****************************************************************************
  Copyright (c) Microsoft Corporation.

  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.

  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** */function ys(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]]);return n}function Is(e,t,n,r){function o(i){return i instanceof n?i:new n(function(s){s(i)})}return new(n||(n=Promise))(function(i,s){function a(d){try{c(r.next(d))}catch(u){s(u)}}function l(d){try{c(r.throw(d))}catch(u){s(u)}}function c(d){d.done?i(d.value):o(d.value).then(a,l)}c((r=r.apply(e,t||[])).next())})}for(var et="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Cs=typeof Uint8Array>"u"?[]:new Uint8Array(256),Ot=0;Ot<et.length;Ot++)Cs[et.charCodeAt(Ot)]=Ot;var vs=function(e){var t=new Uint8Array(e),n,r=t.length,o="";for(n=0;n<r;n+=3)o+=et[t[n]>>2],o+=et[(t[n]&3)<<4|t[n+1]>>4],o+=et[(t[n+1]&15)<<2|t[n+2]>>6],o+=et[t[n+2]&63];return r%3===2?o=o.substring(0,o.length-1)+"=":r%3===1&&(o=o.substring(0,o.length-2)+"=="),o};const Rr=new Map;function bs(e,t){let n=Rr.get(e);return n||(n=new Map,Rr.set(e,n)),n.has(t)||n.set(t,[]),n.get(t)}const Mr=(e,t,n)=>{if(!e||!(Dr(e,t)||typeof e=="object"))return;const r=e.constructor.name,o=bs(n,r);let i=o.indexOf(e);return i===-1&&(i=o.length,o.push(e)),i};function Wt(e,t,n){if(e instanceof Array)return e.map(r=>Wt(r,t,n));if(e===null)return e;if(e instanceof Float32Array||e instanceof Float64Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Int16Array||e instanceof Int8Array||e instanceof Uint8ClampedArray)return{rr_type:e.constructor.name,args:[Object.values(e)]};if(e instanceof ArrayBuffer){const r=e.constructor.name,o=vs(e);return{rr_type:r,base64:o}}else{if(e instanceof DataView)return{rr_type:e.constructor.name,args:[Wt(e.buffer,t,n),e.byteOffset,e.byteLength]};if(e instanceof HTMLImageElement){const r=e.constructor.name,{src:o}=e;return{rr_type:r,src:o}}else if(e instanceof HTMLCanvasElement){const r="HTMLImageElement",o=e.toDataURL();return{rr_type:r,src:o}}else{if(e instanceof ImageData)return{rr_type:e.constructor.name,args:[Wt(e.data,t,n),e.width,e.height]};if(Dr(e,t)||typeof e=="object"){const r=e.constructor.name,o=Mr(e,t,n);return{rr_type:r,index:o}}}}return e}const kr=(e,t,n)=>[...e].map(r=>Wt(r,t,n)),Dr=(e,t)=>!!["WebGLActiveInfo","WebGLBuffer","WebGLFramebuffer","WebGLProgram","WebGLRenderbuffer","WebGLShader","WebGLShaderPrecisionFormat","WebGLTexture","WebGLUniformLocation","WebGLVertexArrayObject","WebGLVertexArrayObjectOES"].filter(o=>typeof t[o]=="function").find(o=>e instanceof t[o]);function ws(e,t,n,r){const o=[],i=Object.getOwnPropertyNames(t.CanvasRenderingContext2D.prototype);for(const s of i)try{if(typeof t.CanvasRenderingContext2D.prototype[s]!="function")continue;const a=Xe(t.CanvasRenderingContext2D.prototype,s,function(l){return function(...c){return me(this.canvas,n,r,!0)||setTimeout(()=>{const d=kr([...c],t,this);e(this.canvas,{type:qe["2D"],property:s,args:d})},0),l.apply(this,c)}});o.push(a)}catch{const l=xt(t.CanvasRenderingContext2D.prototype,s,{set(c){e(this.canvas,{type:qe["2D"],property:s,args:[c],setter:!0})}});o.push(l)}return()=>{o.forEach(s=>s())}}function Fr(e,t,n){const r=[];try{const o=Xe(e.HTMLCanvasElement.prototype,"getContext",function(i){return function(s,...a){return me(this,t,n,!0)||"__context"in this||(this.__context=s),i.apply(this,[s,...a])}});r.push(o)}catch{console.error("failed to patch HTMLCanvasElement.prototype.getContext")}return()=>{r.forEach(o=>o())}}function xr(e,t,n,r,o,i,s){const a=[],l=Object.getOwnPropertyNames(e);for(const c of l)if(!["isContextLost","canvas","drawingBufferWidth","drawingBufferHeight"].includes(c))try{if(typeof e[c]!="function")continue;const d=Xe(e,c,function(u){return function(...p){const g=u.apply(this,p);if(Mr(g,s,this),!me(this.canvas,r,o,!0)){const h=kr([...p],s,this),m={type:t,property:c,args:h};n(this.canvas,m)}return g}});a.push(d)}catch{const u=xt(e,c,{set(p){n(this.canvas,{type:t,property:c,args:[p],setter:!0})}});a.push(u)}return a}function Ss(e,t,n,r,o){const i=[];return i.push(...xr(t.WebGLRenderingContext.prototype,qe.WebGL,e,n,r,o,t)),typeof t.WebGL2RenderingContext<"u"&&i.push(...xr(t.WebGL2RenderingContext.prototype,qe.WebGL2,e,n,r,o,t)),()=>{i.forEach(s=>s())}}var Lr=null;try{var As=typeof module<"u"&&typeof module.require=="function"&&module.require("worker_threads")||typeof __non_webpack_require__=="function"&&__non_webpack_require__("worker_threads")||typeof require=="function"&&require("worker_threads");Lr=As.Worker}catch{}function Es(e,t){return Buffer.from(e,"base64").toString(t?"utf16":"utf8")}function Ns(e,t,n){var r=t===void 0?null:t,o=n===void 0?!1:n,i=Es(e,o),s=i.indexOf(`
`,10)+1,a=i.substring(s)+(r?"//# sourceMappingURL="+r:"");return function(c){return new Lr(a,Object.assign({},c,{eval:!0}))}}function Ts(e,t){var n=atob(e);if(t){for(var r=new Uint8Array(n.length),o=0,i=n.length;o<i;++o)r[o]=n.charCodeAt(o);return String.fromCharCode.apply(null,new Uint16Array(r.buffer))}return n}function Rs(e,t,n){var r=t===void 0?null:t,o=n===void 0?!1:n,i=Ts(e,o),s=i.indexOf(`
`,10)+1,a=i.substring(s)+(r?"//# sourceMappingURL="+r:""),l=new Blob([a],{type:"application/javascript"});return URL.createObjectURL(l)}function Ms(e,t,n){var r;return function(i){return r=r||Rs(e,t,n),new Worker(r,i)}}var ks=Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]";function Ds(){return ks}function Fs(e,t,n){return Ds()?Ns(e,t,n):Ms(e,t,n)}var xs=Fs("Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwooZnVuY3Rpb24gKCkgewogICAgJ3VzZSBzdHJpY3QnOwoKICAgIC8qISAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KICAgIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLg0KDQogICAgUGVybWlzc2lvbiB0byB1c2UsIGNvcHksIG1vZGlmeSwgYW5kL29yIGRpc3RyaWJ1dGUgdGhpcyBzb2Z0d2FyZSBmb3IgYW55DQogICAgcHVycG9zZSB3aXRoIG9yIHdpdGhvdXQgZmVlIGlzIGhlcmVieSBncmFudGVkLg0KDQogICAgVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEICJBUyBJUyIgQU5EIFRIRSBBVVRIT1IgRElTQ0xBSU1TIEFMTCBXQVJSQU5USUVTIFdJVEgNCiAgICBSRUdBUkQgVE8gVEhJUyBTT0ZUV0FSRSBJTkNMVURJTkcgQUxMIElNUExJRUQgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFkNCiAgICBBTkQgRklUTkVTUy4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUiBCRSBMSUFCTEUgRk9SIEFOWSBTUEVDSUFMLCBESVJFQ1QsDQogICAgSU5ESVJFQ1QsIE9SIENPTlNFUVVFTlRJQUwgREFNQUdFUyBPUiBBTlkgREFNQUdFUyBXSEFUU09FVkVSIFJFU1VMVElORyBGUk9NDQogICAgTE9TUyBPRiBVU0UsIERBVEEgT1IgUFJPRklUUywgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIE5FR0xJR0VOQ0UgT1INCiAgICBPVEhFUiBUT1JUSU9VUyBBQ1RJT04sIEFSSVNJTkcgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgVVNFIE9SDQogICAgUEVSRk9STUFOQ0UgT0YgVEhJUyBTT0ZUV0FSRS4NCiAgICAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiAqLw0KDQogICAgZnVuY3Rpb24gX19hd2FpdGVyKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikgew0KICAgICAgICBmdW5jdGlvbiBhZG9wdCh2YWx1ZSkgeyByZXR1cm4gdmFsdWUgaW5zdGFuY2VvZiBQID8gdmFsdWUgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHZhbHVlKTsgfSk7IH0NCiAgICAgICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7DQogICAgICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9DQogICAgICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvclsidGhyb3ciXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9DQogICAgICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IGFkb3B0KHJlc3VsdC52YWx1ZSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfQ0KICAgICAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpOw0KICAgICAgICB9KTsNCiAgICB9CgogICAgLyoKICAgICAqIGJhc2U2NC1hcnJheWJ1ZmZlciAxLjAuMSA8aHR0cHM6Ly9naXRodWIuY29tL25pa2xhc3ZoL2Jhc2U2NC1hcnJheWJ1ZmZlcj4KICAgICAqIENvcHlyaWdodCAoYykgMjAyMSBOaWtsYXMgdm9uIEhlcnR6ZW4gPGh0dHBzOi8vaGVydHplbi5jb20+CiAgICAgKiBSZWxlYXNlZCB1bmRlciBNSVQgTGljZW5zZQogICAgICovCiAgICB2YXIgY2hhcnMgPSAnQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkrLyc7CiAgICAvLyBVc2UgYSBsb29rdXAgdGFibGUgdG8gZmluZCB0aGUgaW5kZXguCiAgICB2YXIgbG9va3VwID0gdHlwZW9mIFVpbnQ4QXJyYXkgPT09ICd1bmRlZmluZWQnID8gW10gOiBuZXcgVWludDhBcnJheSgyNTYpOwogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjaGFycy5sZW5ndGg7IGkrKykgewogICAgICAgIGxvb2t1cFtjaGFycy5jaGFyQ29kZUF0KGkpXSA9IGk7CiAgICB9CiAgICB2YXIgZW5jb2RlID0gZnVuY3Rpb24gKGFycmF5YnVmZmVyKSB7CiAgICAgICAgdmFyIGJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkoYXJyYXlidWZmZXIpLCBpLCBsZW4gPSBieXRlcy5sZW5ndGgsIGJhc2U2NCA9ICcnOwogICAgICAgIGZvciAoaSA9IDA7IGkgPCBsZW47IGkgKz0gMykgewogICAgICAgICAgICBiYXNlNjQgKz0gY2hhcnNbYnl0ZXNbaV0gPj4gMl07CiAgICAgICAgICAgIGJhc2U2NCArPSBjaGFyc1soKGJ5dGVzW2ldICYgMykgPDwgNCkgfCAoYnl0ZXNbaSArIDFdID4+IDQpXTsKICAgICAgICAgICAgYmFzZTY0ICs9IGNoYXJzWygoYnl0ZXNbaSArIDFdICYgMTUpIDw8IDIpIHwgKGJ5dGVzW2kgKyAyXSA+PiA2KV07CiAgICAgICAgICAgIGJhc2U2NCArPSBjaGFyc1tieXRlc1tpICsgMl0gJiA2M107CiAgICAgICAgfQogICAgICAgIGlmIChsZW4gJSAzID09PSAyKSB7CiAgICAgICAgICAgIGJhc2U2NCA9IGJhc2U2NC5zdWJzdHJpbmcoMCwgYmFzZTY0Lmxlbmd0aCAtIDEpICsgJz0nOwogICAgICAgIH0KICAgICAgICBlbHNlIGlmIChsZW4gJSAzID09PSAxKSB7CiAgICAgICAgICAgIGJhc2U2NCA9IGJhc2U2NC5zdWJzdHJpbmcoMCwgYmFzZTY0Lmxlbmd0aCAtIDIpICsgJz09JzsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGJhc2U2NDsKICAgIH07CgogICAgY29uc3QgbGFzdEJsb2JNYXAgPSBuZXcgTWFwKCk7DQogICAgY29uc3QgdHJhbnNwYXJlbnRCbG9iTWFwID0gbmV3IE1hcCgpOw0KICAgIGZ1bmN0aW9uIGdldFRyYW5zcGFyZW50QmxvYkZvcih3aWR0aCwgaGVpZ2h0LCBkYXRhVVJMT3B0aW9ucykgew0KICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkgew0KICAgICAgICAgICAgY29uc3QgaWQgPSBgJHt3aWR0aH0tJHtoZWlnaHR9YDsNCiAgICAgICAgICAgIGlmICgnT2Zmc2NyZWVuQ2FudmFzJyBpbiBnbG9iYWxUaGlzKSB7DQogICAgICAgICAgICAgICAgaWYgKHRyYW5zcGFyZW50QmxvYk1hcC5oYXMoaWQpKQ0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJhbnNwYXJlbnRCbG9iTWFwLmdldChpZCk7DQogICAgICAgICAgICAgICAgY29uc3Qgb2Zmc2NyZWVuID0gbmV3IE9mZnNjcmVlbkNhbnZhcyh3aWR0aCwgaGVpZ2h0KTsNCiAgICAgICAgICAgICAgICBvZmZzY3JlZW4uZ2V0Q29udGV4dCgnMmQnKTsNCiAgICAgICAgICAgICAgICBjb25zdCBibG9iID0geWllbGQgb2Zmc2NyZWVuLmNvbnZlcnRUb0Jsb2IoZGF0YVVSTE9wdGlvbnMpOw0KICAgICAgICAgICAgICAgIGNvbnN0IGFycmF5QnVmZmVyID0geWllbGQgYmxvYi5hcnJheUJ1ZmZlcigpOw0KICAgICAgICAgICAgICAgIGNvbnN0IGJhc2U2NCA9IGVuY29kZShhcnJheUJ1ZmZlcik7DQogICAgICAgICAgICAgICAgdHJhbnNwYXJlbnRCbG9iTWFwLnNldChpZCwgYmFzZTY0KTsNCiAgICAgICAgICAgICAgICByZXR1cm4gYmFzZTY0Ow0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgZWxzZSB7DQogICAgICAgICAgICAgICAgcmV0dXJuICcnOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9KTsNCiAgICB9DQogICAgY29uc3Qgd29ya2VyID0gc2VsZjsNCiAgICB3b3JrZXIub25tZXNzYWdlID0gZnVuY3Rpb24gKGUpIHsNCiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHsNCiAgICAgICAgICAgIGlmICgnT2Zmc2NyZWVuQ2FudmFzJyBpbiBnbG9iYWxUaGlzKSB7DQogICAgICAgICAgICAgICAgY29uc3QgeyBpZCwgYml0bWFwLCB3aWR0aCwgaGVpZ2h0LCBkYXRhVVJMT3B0aW9ucyB9ID0gZS5kYXRhOw0KICAgICAgICAgICAgICAgIGNvbnN0IHRyYW5zcGFyZW50QmFzZTY0ID0gZ2V0VHJhbnNwYXJlbnRCbG9iRm9yKHdpZHRoLCBoZWlnaHQsIGRhdGFVUkxPcHRpb25zKTsNCiAgICAgICAgICAgICAgICBjb25zdCBvZmZzY3JlZW4gPSBuZXcgT2Zmc2NyZWVuQ2FudmFzKHdpZHRoLCBoZWlnaHQpOw0KICAgICAgICAgICAgICAgIGNvbnN0IGN0eCA9IG9mZnNjcmVlbi5nZXRDb250ZXh0KCcyZCcpOw0KICAgICAgICAgICAgICAgIGN0eC5kcmF3SW1hZ2UoYml0bWFwLCAwLCAwKTsNCiAgICAgICAgICAgICAgICBiaXRtYXAuY2xvc2UoKTsNCiAgICAgICAgICAgICAgICBjb25zdCBibG9iID0geWllbGQgb2Zmc2NyZWVuLmNvbnZlcnRUb0Jsb2IoZGF0YVVSTE9wdGlvbnMpOw0KICAgICAgICAgICAgICAgIGNvbnN0IHR5cGUgPSBibG9iLnR5cGU7DQogICAgICAgICAgICAgICAgY29uc3QgYXJyYXlCdWZmZXIgPSB5aWVsZCBibG9iLmFycmF5QnVmZmVyKCk7DQogICAgICAgICAgICAgICAgY29uc3QgYmFzZTY0ID0gZW5jb2RlKGFycmF5QnVmZmVyKTsNCiAgICAgICAgICAgICAgICBpZiAoIWxhc3RCbG9iTWFwLmhhcyhpZCkgJiYgKHlpZWxkIHRyYW5zcGFyZW50QmFzZTY0KSA9PT0gYmFzZTY0KSB7DQogICAgICAgICAgICAgICAgICAgIGxhc3RCbG9iTWFwLnNldChpZCwgYmFzZTY0KTsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHdvcmtlci5wb3N0TWVzc2FnZSh7IGlkIH0pOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpZiAobGFzdEJsb2JNYXAuZ2V0KGlkKSA9PT0gYmFzZTY0KQ0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gd29ya2VyLnBvc3RNZXNzYWdlKHsgaWQgfSk7DQogICAgICAgICAgICAgICAgd29ya2VyLnBvc3RNZXNzYWdlKHsNCiAgICAgICAgICAgICAgICAgICAgaWQsDQogICAgICAgICAgICAgICAgICAgIHR5cGUsDQogICAgICAgICAgICAgICAgICAgIGJhc2U2NCwNCiAgICAgICAgICAgICAgICAgICAgd2lkdGgsDQogICAgICAgICAgICAgICAgICAgIGhlaWdodCwNCiAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICBsYXN0QmxvYk1hcC5zZXQoaWQsIGJhc2U2NCk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBlbHNlIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gd29ya2VyLnBvc3RNZXNzYWdlKHsgaWQ6IGUuZGF0YS5pZCB9KTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSk7DQogICAgfTsKCn0pKCk7Cgo=",null,!1);class Ls{constructor(t){this.pendingCanvasMutations=new Map,this.rafStamps={latestId:0,invokeId:null},this.frozen=!1,this.locked=!1,this.processMutation=(l,c)=>{(this.rafStamps.invokeId&&this.rafStamps.latestId!==this.rafStamps.invokeId||!this.rafStamps.invokeId)&&(this.rafStamps.invokeId=this.rafStamps.latestId),this.pendingCanvasMutations.has(l)||this.pendingCanvasMutations.set(l,[]),this.pendingCanvasMutations.get(l).push(c)};const{sampling:n="all",win:r,blockClass:o,blockSelector:i,recordCanvas:s,dataURLOptions:a}=t;this.mutationCb=t.mutationCb,this.mirror=t.mirror,s&&n==="all"&&this.initCanvasMutationObserver(r,o,i),s&&typeof n=="number"&&this.initCanvasFPSObserver(n,r,o,i,{dataURLOptions:a})}reset(){this.pendingCanvasMutations.clear(),this.resetObservers&&this.resetObservers()}freeze(){this.frozen=!0}unfreeze(){this.frozen=!1}lock(){this.locked=!0}unlock(){this.locked=!1}initCanvasFPSObserver(t,n,r,o,i){const s=Fr(n,r,o),a=new Map,l=new xs;l.onmessage=h=>{const{id:m}=h.data;if(a.set(m,!1),!("base64"in h.data))return;const{base64:I,type:y,width:f,height:w}=h.data;this.mutationCb({id:m,type:qe["2D"],commands:[{property:"clearRect",args:[0,0,f,w]},{property:"drawImage",args:[{rr_type:"ImageBitmap",args:[{rr_type:"Blob",data:[{rr_type:"ArrayBuffer",base64:I}],type:y}]},0,0]}]})};const c=1e3/t;let d=0,u;const p=()=>{const h=[];return n.document.querySelectorAll("canvas").forEach(m=>{me(m,r,o,!0)||h.push(m)}),h},g=h=>{if(d&&h-d<c){u=requestAnimationFrame(g);return}d=h,p().forEach(m=>Is(this,void 0,void 0,function*(){var I;const y=this.mirror.getId(m);if(a.get(y))return;if(a.set(y,!0),["webgl","webgl2"].includes(m.__context)){const w=m.getContext(m.__context);((I=w==null?void 0:w.getContextAttributes())===null||I===void 0?void 0:I.preserveDrawingBuffer)===!1&&(w==null||w.clear(w.COLOR_BUFFER_BIT))}const f=yield createImageBitmap(m);l.postMessage({id:y,bitmap:f,width:m.width,height:m.height,dataURLOptions:i.dataURLOptions},[f])})),u=requestAnimationFrame(g)};u=requestAnimationFrame(g),this.resetObservers=()=>{s(),cancelAnimationFrame(u)}}initCanvasMutationObserver(t,n,r){this.startRAFTimestamping(),this.startPendingCanvasMutationFlusher();const o=Fr(t,n,r),i=ws(this.processMutation.bind(this),t,n,r),s=Ss(this.processMutation.bind(this),t,n,r,this.mirror);this.resetObservers=()=>{o(),i(),s()}}startPendingCanvasMutationFlusher(){requestAnimationFrame(()=>this.flushPendingCanvasMutations())}startRAFTimestamping(){const t=n=>{this.rafStamps.latestId=n,requestAnimationFrame(t)};requestAnimationFrame(t)}flushPendingCanvasMutations(){this.pendingCanvasMutations.forEach((t,n)=>{const r=this.mirror.getId(n);this.flushPendingCanvasMutationFor(n,r)}),requestAnimationFrame(()=>this.flushPendingCanvasMutations())}flushPendingCanvasMutationFor(t,n){if(this.frozen||this.locked)return;const r=this.pendingCanvasMutations.get(t);if(!r||n===-1)return;const o=r.map(s=>ys(s,["type"])),{type:i}=r[0];this.mutationCb({id:n,type:i,commands:o}),this.pendingCanvasMutations.delete(t)}}class Os{constructor(t){this.trackedLinkElements=new WeakSet,this.styleMirror=new es,this.mutationCb=t.mutationCb,this.adoptedStyleSheetCb=t.adoptedStyleSheetCb}attachLinkElement(t,n){"_cssText"in n.attributes&&this.mutationCb({adds:[],removes:[],texts:[],attributes:[{id:n.id,attributes:n.attributes}]}),this.trackLinkElement(t)}trackLinkElement(t){this.trackedLinkElements.has(t)||(this.trackedLinkElements.add(t),this.trackStylesheetInLinkElement(t))}adoptStyleSheets(t,n){if(t.length===0)return;const r={id:n,styleIds:[]},o=[];for(const i of t){let s;if(this.styleMirror.has(i))s=this.styleMirror.getId(i);else{s=this.styleMirror.add(i);const a=Array.from(i.rules||CSSRule);o.push({styleId:s,rules:a.map((l,c)=>({rule:jn(l),index:c}))})}r.styleIds.push(s)}o.length>0&&(r.styles=o),this.adoptedStyleSheetCb(r)}reset(){this.styleMirror.reset(),this.trackedLinkElements=new WeakSet}trackStylesheetInLinkElement(t){}}function le(e){return Object.assign(Object.assign({},e),{timestamp:Date.now()})}let se,Bt,pn,Pt=!1;const we=Mi();function mt(e={}){const{emit:t,checkoutEveryNms:n,checkoutEveryNth:r,blockClass:o="rr-block",blockSelector:i=null,ignoreClass:s="rr-ignore",maskTextClass:a="rr-mask",maskTextSelector:l=null,inlineStylesheet:c=!0,maskAllInputs:d,maskInputOptions:u,slimDOMOptions:p,maskInputFn:g,maskTextFn:h,hooks:m,packFn:I,sampling:y={},dataURLOptions:f={},mousemoveWait:w,recordCanvas:A=!1,recordCrossOriginIframes:L=!1,userTriggeredOnInput:O=!1,collectFonts:W=!1,inlineImages:k=!1,plugins:v,keepIframeSrcFn:E=()=>!1,ignoreCSSAttributes:C=new Set([])}=e,b=L?window.parent===window:!0;let M=!1;if(!b)try{window.parent.document,M=!1}catch{M=!0}if(b&&!t)throw new Error("emit function is required");w!==void 0&&y.mousemove===void 0&&(y.mousemove=w),we.reset();const T=d===!0?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,password:!0}:u!==void 0?u:{password:!0},V=p===!0||p==="all"?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaVerification:!0,headMetaAuthorship:p==="all",headMetaDescKeywords:p==="all"}:p||{};qi();let x,S=0;const U=R=>{for(const ne of v||[])ne.eventProcessor&&(R=ne.eventProcessor(R));return I&&(R=I(R)),R};se=(R,ne)=>{var D;if(!((D=_e[0])===null||D===void 0)&&D.isFrozen()&&R.type!==z.FullSnapshot&&!(R.type===z.IncrementalSnapshot&&R.data.source===K.Mutation)&&_e.forEach(Y=>Y.unfreeze()),b)t==null||t(U(R),ne);else if(M){const Y={type:"rrweb",event:U(R),isCheckout:ne};window.parent.postMessage(Y,"*")}if(R.type===z.FullSnapshot)x=R,S=0;else if(R.type===z.IncrementalSnapshot){if(R.data.source===K.Mutation&&R.data.isAttachIframe)return;S++;const Y=r&&S>=r,he=n&&R.timestamp-x.timestamp>n;(Y||he)&&Bt(!0)}};const F=R=>{se(le({type:z.IncrementalSnapshot,data:Object.assign({source:K.Mutation},R)}))},G=R=>se(le({type:z.IncrementalSnapshot,data:Object.assign({source:K.Scroll},R)})),q=R=>se(le({type:z.IncrementalSnapshot,data:Object.assign({source:K.CanvasMutation},R)})),j=R=>se(le({type:z.IncrementalSnapshot,data:Object.assign({source:K.AdoptedStyleSheet},R)})),J=new Os({mutationCb:F,adoptedStyleSheetCb:j}),N=new gs({mirror:we,mutationCb:F,stylesheetManager:J,recordCrossOriginIframes:L,wrappedEmit:se});for(const R of v||[])R.getMirror&&R.getMirror({nodeMirror:we,crossOriginIframeMirror:N.crossOriginIframeMirror,crossOriginIframeStyleMirror:N.crossOriginIframeStyleMirror});pn=new Ls({recordCanvas:A,mutationCb:q,win:window,blockClass:o,blockSelector:i,mirror:we,sampling:y.canvas,dataURLOptions:f});const _=new fs({mutationCb:F,scrollCb:G,bypassOptions:{blockClass:o,blockSelector:i,maskTextClass:a,maskTextSelector:l,inlineStylesheet:c,maskInputOptions:T,dataURLOptions:f,maskTextFn:h,maskInputFn:g,recordCanvas:A,inlineImages:k,sampling:y,slimDOMOptions:V,iframeManager:N,stylesheetManager:J,canvasManager:pn,keepIframeSrcFn:E},mirror:we});Bt=(R=!1)=>{var ne,D,Y,he,$,ye;se(le({type:z.Meta,data:{href:window.location.href,width:sr(),height:ir()}}),R),J.reset(),_e.forEach(fe=>fe.lock());const Nt=ji(document,{mirror:we,blockClass:o,blockSelector:i,maskTextClass:a,maskTextSelector:l,inlineStylesheet:c,maskAllInputs:T,maskTextFn:h,slimDOM:V,dataURLOptions:f,recordCanvas:A,inlineImages:k,onSerialize:fe=>{cr(fe,we)&&N.addIframe(fe),dr(fe,we)&&J.trackLinkElement(fe),ur(fe)&&_.addShadowRoot(fe.shadowRoot,document)},onIframeLoad:(fe,On)=>{N.attachIframe(fe,On),_.observeAttachShadow(fe)},onStylesheetLoad:(fe,On)=>{J.attachLinkElement(fe,On)},keepIframeSrcFn:E});if(!Nt)return console.warn("Failed to snapshot the document");se(le({type:z.FullSnapshot,data:{node:Nt,initialOffset:{left:window.pageXOffset!==void 0?window.pageXOffset:(document==null?void 0:document.documentElement.scrollLeft)||((D=(ne=document==null?void 0:document.body)===null||ne===void 0?void 0:ne.parentElement)===null||D===void 0?void 0:D.scrollLeft)||((Y=document==null?void 0:document.body)===null||Y===void 0?void 0:Y.scrollLeft)||0,top:window.pageYOffset!==void 0?window.pageYOffset:(document==null?void 0:document.documentElement.scrollTop)||(($=(he=document==null?void 0:document.body)===null||he===void 0?void 0:he.parentElement)===null||$===void 0?void 0:$.scrollTop)||((ye=document==null?void 0:document.body)===null||ye===void 0?void 0:ye.scrollTop)||0}}})),_e.forEach(fe=>fe.unlock()),document.adoptedStyleSheets&&document.adoptedStyleSheets.length>0&&J.adoptStyleSheets(document.adoptedStyleSheets,we.getId(document))};try{const R=[];R.push(pe("DOMContentLoaded",()=>{se(le({type:z.DomContentLoaded,data:{}}))}));const ne=Y=>{var he;return ms({mutationCb:F,mousemoveCb:($,ye)=>se(le({type:z.IncrementalSnapshot,data:{source:ye,positions:$}})),mouseInteractionCb:$=>se(le({type:z.IncrementalSnapshot,data:Object.assign({source:K.MouseInteraction},$)})),scrollCb:G,viewportResizeCb:$=>se(le({type:z.IncrementalSnapshot,data:Object.assign({source:K.ViewportResize},$)})),inputCb:$=>se(le({type:z.IncrementalSnapshot,data:Object.assign({source:K.Input},$)})),mediaInteractionCb:$=>se(le({type:z.IncrementalSnapshot,data:Object.assign({source:K.MediaInteraction},$)})),styleSheetRuleCb:$=>se(le({type:z.IncrementalSnapshot,data:Object.assign({source:K.StyleSheetRule},$)})),styleDeclarationCb:$=>se(le({type:z.IncrementalSnapshot,data:Object.assign({source:K.StyleDeclaration},$)})),canvasMutationCb:q,fontCb:$=>se(le({type:z.IncrementalSnapshot,data:Object.assign({source:K.Font},$)})),selectionCb:$=>{se(le({type:z.IncrementalSnapshot,data:Object.assign({source:K.Selection},$)}))},blockClass:o,ignoreClass:s,maskTextClass:a,maskTextSelector:l,maskInputOptions:T,inlineStylesheet:c,sampling:y,recordCanvas:A,inlineImages:k,userTriggeredOnInput:O,collectFonts:W,doc:Y,maskInputFn:g,maskTextFn:h,keepIframeSrcFn:E,blockSelector:i,slimDOMOptions:V,dataURLOptions:f,mirror:we,iframeManager:N,stylesheetManager:J,shadowDomManager:_,canvasManager:pn,ignoreCSSAttributes:C,plugins:((he=v==null?void 0:v.filter($=>$.observer))===null||he===void 0?void 0:he.map($=>({observer:$.observer,options:$.options,callback:ye=>se(le({type:z.Plugin,data:{plugin:$.name,payload:ye}}))})))||[]},m)};N.addLoadListener(Y=>{R.push(ne(Y.contentDocument))});const D=()=>{Bt(),R.push(ne(document)),Pt=!0};return document.readyState==="interactive"||document.readyState==="complete"?D():R.push(pe("load",()=>{se(le({type:z.Load,data:{}})),D()},window)),()=>{R.forEach(Y=>Y()),Pt=!1}}catch(R){console.warn(R)}}mt.addCustomEvent=(e,t)=>{if(!Pt)throw new Error("please add custom event after start recording");se(le({type:z.Custom,data:{tag:e,payload:t}}))},mt.freezePage=()=>{_e.forEach(e=>e.freeze())},mt.takeFullSnapshot=e=>{if(!Pt)throw new Error("please take full snapshot after start recording");Bt(e)},mt.mirror=we;function Vt(){}function Or(e,t){for(const n in t)e[n]=t[n];return e}function Wr(e){return e()}function Br(){return Object.create(null)}function tt(e){e.forEach(Wr)}function Ws(e){return typeof e=="function"}function mn(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}function Pr(e){const t={};for(const n in e)n[0]!=="$"&&(t[n]=e[n]);return t}function H(e,t){e.appendChild(t)}function De(e,t,n){e.insertBefore(t,n||null)}function Te(e){e.parentNode.removeChild(e)}function gn(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function ce(e){return document.createElement(e)}function Ut(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function Ge(e){return document.createTextNode(e)}function Ie(){return Ge(" ")}function gt(e,t,n,r){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n,r)}function P(e,t,n){n==null?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function _t(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function ae(e,t,n,r){n===null?e.style.removeProperty(t):e.style.setProperty(t,n,r?"important":"")}function nt(e,t,n){e.classList[n?"add":"remove"](t)}let ft;function yt(e){ft=e}function Gt(){if(!ft)throw new Error("Function called outside component initialization");return ft}function Vr(e){Gt().$$.on_mount.push(e)}function Ur(e){Gt().$$.on_destroy.push(e)}function Bs(){const e=Gt();return(t,n,{cancelable:r=!1}={})=>{const o=e.$$.callbacks[t];if(o){const i=function(s,a,{bubbles:l=!1,cancelable:c=!1}={}){const d=document.createEvent("CustomEvent");return d.initCustomEvent(s,l,c,a),d}(t,n,{cancelable:r});return o.slice().forEach(s=>{s.call(e,i)}),!i.defaultPrevented}return!0}}const It=[],We=[],Zt=[],fn=[],Ps=Promise.resolve();let yn=!1;function In(e){Zt.push(e)}const Cn=new Set;let Kt=0;function _r(){const e=ft;do{for(;Kt<It.length;){const t=It[Kt];Kt++,yt(t),Vs(t.$$)}for(yt(null),It.length=0,Kt=0;We.length;)We.pop()();for(let t=0;t<Zt.length;t+=1){const n=Zt[t];Cn.has(n)||(Cn.add(n),n())}Zt.length=0}while(It.length);for(;fn.length;)fn.pop()();yn=!1,Cn.clear(),yt(e)}function Vs(e){if(e.fragment!==null){e.update(),tt(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(In)}}const Yt=new Set;let Ze;function Gr(){Ze={r:0,c:[],p:Ze}}function Zr(){Ze.r||tt(Ze.c),Ze=Ze.p}function Fe(e,t){e&&e.i&&(Yt.delete(e),e.i(t))}function rt(e,t,n,r){if(e&&e.o){if(Yt.has(e))return;Yt.add(e),Ze.c.push(()=>{Yt.delete(e),r&&(n&&e.d(1),r())}),e.o(t)}else r&&r()}function Kr(e){e&&e.c()}function vn(e,t,n,r){const{fragment:o,on_mount:i,on_destroy:s,after_update:a}=e.$$;o&&o.m(t,n),r||In(()=>{const l=i.map(Wr).filter(Ws);s?s.push(...l):tt(l),e.$$.on_mount=[]}),a.forEach(In)}function bn(e,t){const n=e.$$;n.fragment!==null&&(tt(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function Us(e,t){e.$$.dirty[0]===-1&&(It.push(e),yn||(yn=!0,Ps.then(_r)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function wn(e,t,n,r,o,i,s,a=[-1]){const l=ft;yt(e);const c=e.$$={fragment:null,ctx:null,props:i,update:Vt,not_equal:o,bound:Br(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(l?l.$$.context:[])),callbacks:Br(),dirty:a,skip_bound:!1,root:t.target||l.$$.root};s&&s(c.root);let d=!1;if(c.ctx=n?n(e,t.props||{},(u,p,...g)=>{const h=g.length?g[0]:p;return c.ctx&&o(c.ctx[u],c.ctx[u]=h)&&(!c.skip_bound&&c.bound[u]&&c.bound[u](h),d&&Us(e,u)),p}):[],c.update(),d=!0,tt(c.before_update),c.fragment=!!r&&r(c.ctx),t.target){if(t.hydrate){const u=function(p){return Array.from(p.childNodes)}(t.target);c.fragment&&c.fragment.l(u),u.forEach(Te)}else c.fragment&&c.fragment.c();t.intro&&Fe(e.$$.fragment),vn(e,t.target,t.anchor,t.customElement),_r()}yt(l)}class Sn{$destroy(){bn(this,1),this.$destroy=Vt}$on(t,n){const r=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return r.push(n),()=>{const o=r.indexOf(n);o!==-1&&r.splice(o,1)}}$set(t){var n;this.$$set&&(n=t,Object.keys(n).length!==0)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}var de;function _s(e){return e.nodeType===e.ELEMENT_NODE}(function(e){e[e.Document=0]="Document",e[e.DocumentType=1]="DocumentType",e[e.Element=2]="Element",e[e.Text=3]="Text",e[e.CDATA=4]="CDATA",e[e.Comment=5]="Comment"})(de||(de={}));var Yr=function(){function e(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}return e.prototype.getId=function(t){var n;if(!t)return-1;var r=(n=this.getMeta(t))===null||n===void 0?void 0:n.id;return r??-1},e.prototype.getNode=function(t){return this.idNodeMap.get(t)||null},e.prototype.getIds=function(){return Array.from(this.idNodeMap.keys())},e.prototype.getMeta=function(t){return this.nodeMetaMap.get(t)||null},e.prototype.removeNodeFromMap=function(t){var n=this,r=this.getId(t);this.idNodeMap.delete(r),t.childNodes&&t.childNodes.forEach(function(o){return n.removeNodeFromMap(o)})},e.prototype.has=function(t){return this.idNodeMap.has(t)},e.prototype.hasNode=function(t){return this.nodeMetaMap.has(t)},e.prototype.add=function(t,n){var r=n.id;this.idNodeMap.set(r,t),this.nodeMetaMap.set(t,n)},e.prototype.replace=function(t,n){var r=this.getNode(t);if(r){var o=this.nodeMetaMap.get(r);o&&this.nodeMetaMap.set(n,o)}this.idNodeMap.set(t,n)},e.prototype.reset=function(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap},e}();function Gs(){return new Yr}var $r=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g;function Zs(e,t){t===void 0&&(t={});var n=1,r=1;function o(C){var b=C.match(/\n/g);b&&(n+=b.length);var M=C.lastIndexOf(`
`);r=M===-1?r+C.length:C.length-M}function i(){var C={line:n,column:r};return function(b){return b.position=new s(C),g(),b}}var s=function(C){this.start=C,this.end={line:n,column:r},this.source=t.source};s.prototype.content=e;var a=[];function l(C){var b=new Error("".concat(t.source||"",":").concat(n,":").concat(r,": ").concat(C));if(b.reason=C,b.filename=t.source,b.line=n,b.column=r,b.source=e,!t.silent)throw b;a.push(b)}function c(){return p(/^{\s*/)}function d(){return p(/^}/)}function u(){var C,b=[];for(g(),h(b);e.length&&e.charAt(0)!=="}"&&(C=v()||E());)C!==!1&&(b.push(C),h(b));return b}function p(C){var b=C.exec(e);if(b){var M=b[0];return o(M),e=e.slice(M.length),b}}function g(){p(/^\s*/)}function h(C){var b;for(C===void 0&&(C=[]);b=m();)b!==!1&&C.push(b),b=m();return C}function m(){var C=i();if(e.charAt(0)==="/"&&e.charAt(1)==="*"){for(var b=2;e.charAt(b)!==""&&(e.charAt(b)!=="*"||e.charAt(b+1)!=="/");)++b;if(b+=2,e.charAt(b-1)==="")return l("End of comment missing");var M=e.slice(2,b-2);return r+=2,o(M),e=e.slice(b),r+=2,C({type:"comment",comment:M})}}function I(){var C=p(/^([^{]+)/);if(C)return xe(C[0]).replace(/\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*\/+/g,"").replace(/"(?:\\"|[^"])*"|'(?:\\'|[^'])*'/g,function(b){return b.replace(/,/g,"")}).split(/\s*(?![^(]*\)),\s*/).map(function(b){return b.replace(/\u200C/g,",")})}function y(){var C=i(),b=p(/^(\*?[-#\/\*\\\w]+(\[[0-9a-z_-]+\])?)\s*/);if(b){var M=xe(b[0]);if(!p(/^:\s*/))return l("property missing ':'");var T=p(/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^\)]*?\)|[^};])+)/),V=C({type:"declaration",property:M.replace($r,""),value:T?xe(T[0]).replace($r,""):""});return p(/^[;\s]*/),V}}function f(){var C,b=[];if(!c())return l("missing '{'");for(h(b);C=y();)C!==!1&&(b.push(C),h(b)),C=y();return d()?b:l("missing '}'")}function w(){for(var C,b=[],M=i();C=p(/^((\d+\.\d+|\.\d+|\d+)%?|[a-z]+)\s*/);)b.push(C[1]),p(/^,\s*/);if(b.length)return M({type:"keyframe",values:b,declarations:f()})}var A,L=k("import"),O=k("charset"),W=k("namespace");function k(C){var b=new RegExp("^@"+C+"\\s*([^;]+);");return function(){var M=i(),T=p(b);if(T){var V={type:C};return V[C]=T[1].trim(),M(V)}}}function v(){if(e[0]==="@")return function(){var C=i(),b=p(/^@([-\w]+)?keyframes\s*/);if(b){var M=b[1];if(!(b=p(/^([-\w]+)\s*/)))return l("@keyframes missing name");var T,V=b[1];if(!c())return l("@keyframes missing '{'");for(var x=h();T=w();)x.push(T),x=x.concat(h());return d()?C({type:"keyframes",name:V,vendor:M,keyframes:x}):l("@keyframes missing '}'")}}()||function(){var C=i(),b=p(/^@media *([^{]+)/);if(b){var M=xe(b[1]);if(!c())return l("@media missing '{'");var T=h().concat(u());return d()?C({type:"media",media:M,rules:T}):l("@media missing '}'")}}()||function(){var C=i(),b=p(/^@custom-media\s+(--[^\s]+)\s*([^{;]+);/);if(b)return C({type:"custom-media",name:xe(b[1]),media:xe(b[2])})}()||function(){var C=i(),b=p(/^@supports *([^{]+)/);if(b){var M=xe(b[1]);if(!c())return l("@supports missing '{'");var T=h().concat(u());return d()?C({type:"supports",supports:M,rules:T}):l("@supports missing '}'")}}()||L()||O()||W()||function(){var C=i(),b=p(/^@([-\w]+)?document *([^{]+)/);if(b){var M=xe(b[1]),T=xe(b[2]);if(!c())return l("@document missing '{'");var V=h().concat(u());return d()?C({type:"document",document:T,vendor:M,rules:V}):l("@document missing '}'")}}()||function(){var C=i();if(p(/^@page */)){var b=I()||[];if(!c())return l("@page missing '{'");for(var M,T=h();M=y();)T.push(M),T=T.concat(h());return d()?C({type:"page",selectors:b,declarations:T}):l("@page missing '}'")}}()||function(){var C=i();if(p(/^@host\s*/)){if(!c())return l("@host missing '{'");var b=h().concat(u());return d()?C({type:"host",rules:b}):l("@host missing '}'")}}()||function(){var C=i();if(p(/^@font-face\s*/)){if(!c())return l("@font-face missing '{'");for(var b,M=h();b=y();)M.push(b),M=M.concat(h());return d()?C({type:"font-face",declarations:M}):l("@font-face missing '}'")}}()}function E(){var C=i(),b=I();return b?(h(),C({type:"rule",selectors:b,declarations:f()})):l("selector missing")}return An((A=u(),{type:"stylesheet",stylesheet:{source:t.source,rules:A,parsingErrors:a}}))}function xe(e){return e?e.replace(/^\s+|\s+$/g,""):""}function An(e,t){for(var n=e&&typeof e.type=="string",r=n?e:t,o=0,i=Object.keys(e);o<i.length;o++){var s=e[i[o]];Array.isArray(s)?s.forEach(function(a){An(a,r)}):s&&typeof s=="object"&&An(s,r)}return n&&Object.defineProperty(e,"parent",{configurable:!0,writable:!0,enumerable:!1,value:t||null}),e}var zr={script:"noscript",altglyph:"altGlyph",altglyphdef:"altGlyphDef",altglyphitem:"altGlyphItem",animatecolor:"animateColor",animatemotion:"animateMotion",animatetransform:"animateTransform",clippath:"clipPath",feblend:"feBlend",fecolormatrix:"feColorMatrix",fecomponenttransfer:"feComponentTransfer",fecomposite:"feComposite",feconvolvematrix:"feConvolveMatrix",fediffuselighting:"feDiffuseLighting",fedisplacementmap:"feDisplacementMap",fedistantlight:"feDistantLight",fedropshadow:"feDropShadow",feflood:"feFlood",fefunca:"feFuncA",fefuncb:"feFuncB",fefuncg:"feFuncG",fefuncr:"feFuncR",fegaussianblur:"feGaussianBlur",feimage:"feImage",femerge:"feMerge",femergenode:"feMergeNode",femorphology:"feMorphology",feoffset:"feOffset",fepointlight:"fePointLight",fespecularlighting:"feSpecularLighting",fespotlight:"feSpotLight",fetile:"feTile",feturbulence:"feTurbulence",foreignobject:"foreignObject",glyphref:"glyphRef",lineargradient:"linearGradient",radialgradient:"radialGradient"},Hr=/([^\\]):hover/,Ks=new RegExp(Hr.source,"g");function Qr(e,t){var n=t==null?void 0:t.stylesWithHoverClass.get(e);if(n)return n;var r=Zs(e,{silent:!0});if(!r.stylesheet)return e;var o=[];if(r.stylesheet.rules.forEach(function(a){"selectors"in a&&(a.selectors||[]).forEach(function(l){Hr.test(l)&&o.push(l)})}),o.length===0)return e;var i=new RegExp(o.filter(function(a,l){return o.indexOf(a)===l}).sort(function(a,l){return l.length-a.length}).map(function(a){return a.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}).join("|"),"g"),s=e.replace(i,function(a){var l=a.replace(Ks,"$1.\\:hover");return"".concat(a,", ").concat(l)});return t==null||t.stylesWithHoverClass.set(e,s),s}function Jr(){return{stylesWithHoverClass:new Map}}function Ys(e,t){var n=t.doc,r=t.hackCss,o=t.cache;switch(e.type){case de.Document:return n.implementation.createDocument(null,"",null);case de.DocumentType:return n.implementation.createDocumentType(e.name||"html",e.publicId,e.systemId);case de.Element:var i,s=function(f){var w=zr[f.tagName]?zr[f.tagName]:f.tagName;return w==="link"&&f.attributes._cssText&&(w="style"),w}(e);i=e.isSVG?n.createElementNS("http://www.w3.org/2000/svg",s):n.createElement(s);var a={};for(var l in e.attributes)if(Object.prototype.hasOwnProperty.call(e.attributes,l)){var c=e.attributes[l];if(s!=="option"||l!=="selected"||c!==!1)if(c===!0&&(c=""),l.startsWith("rr_"))a[l]=c;else{var d=s==="textarea"&&l==="value",u=s==="style"&&l==="_cssText";if(u&&r&&typeof c=="string"&&(c=Qr(c,o)),!d&&!u||typeof c!="string")try{if(e.isSVG&&l==="xlink:href")i.setAttributeNS("http://www.w3.org/1999/xlink",l,c.toString());else if(l==="onload"||l==="onclick"||l.substring(0,7)==="onmouse")i.setAttribute("_"+l,c.toString());else{if(s==="meta"&&e.attributes["http-equiv"]==="Content-Security-Policy"&&l==="content"){i.setAttribute("csp-content",c.toString());continue}s==="link"&&e.attributes.rel==="preload"&&e.attributes.as==="script"||s==="link"&&e.attributes.rel==="prefetch"&&typeof e.attributes.href=="string"&&e.attributes.href.endsWith(".js")||(s==="img"&&e.attributes.srcset&&e.attributes.rr_dataURL?i.setAttribute("rrweb-original-srcset",e.attributes.srcset):i.setAttribute(l,c.toString()))}}catch{}else{for(var p=n.createTextNode(c),g=0,h=Array.from(i.childNodes);g<h.length;g++){var m=h[g];m.nodeType===i.TEXT_NODE&&i.removeChild(m)}i.appendChild(p)}}}var I=function(f){var w=a[f];if(s==="canvas"&&f==="rr_dataURL"){var A=document.createElement("img");A.onload=function(){var O=i.getContext("2d");O&&O.drawImage(A,0,0,A.width,A.height)},A.src=w.toString(),i.RRNodeType&&(i.rr_dataURL=w.toString())}else if(s==="img"&&f==="rr_dataURL"){var L=i;L.currentSrc.startsWith("data:")||(L.setAttribute("rrweb-original-src",e.attributes.src),L.src=w.toString())}if(f==="rr_width")i.style.width=w.toString();else if(f==="rr_height")i.style.height=w.toString();else if(f==="rr_mediaCurrentTime"&&typeof w=="number")i.currentTime=w;else if(f==="rr_mediaState")switch(w){case"played":i.play().catch(function(O){return console.warn("media playback error",O)});break;case"paused":i.pause()}};for(var y in a)I(y);if(e.isShadowHost)if(i.shadowRoot)for(;i.shadowRoot.firstChild;)i.shadowRoot.removeChild(i.shadowRoot.firstChild);else i.attachShadow({mode:"open"});return i;case de.Text:return n.createTextNode(e.isStyle&&r?Qr(e.textContent,o):e.textContent);case de.CDATA:return n.createCDATASection(e.textContent);case de.Comment:return n.createComment(e.textContent);default:return null}}function Ct(e,t){var n=t.doc,r=t.mirror,o=t.skipChild,i=o!==void 0&&o,s=t.hackCss,a=s===void 0||s,l=t.afterAppend,c=t.cache,d=Ys(e,{doc:n,hackCss:a,cache:c});if(!d)return null;if(e.rootId&&r.getNode(e.rootId)!==n&&r.replace(e.rootId,n),e.type===de.Document&&(n.close(),n.open(),e.compatMode==="BackCompat"&&e.childNodes&&e.childNodes[0].type!==de.DocumentType&&(e.childNodes[0].type===de.Element&&"xmlns"in e.childNodes[0].attributes&&e.childNodes[0].attributes.xmlns==="http://www.w3.org/1999/xhtml"?n.write('<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "">'):n.write('<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "">')),d=n),r.add(d,e),(e.type===de.Document||e.type===de.Element)&&!i)for(var u=0,p=e.childNodes;u<p.length;u++){var g=p[u],h=Ct(g,{doc:n,mirror:r,skipChild:!1,hackCss:a,afterAppend:l,cache:c});h?(g.isShadow&&_s(d)&&d.shadowRoot?d.shadowRoot.appendChild(h):d.appendChild(h),l&&l(h,g.id)):console.warn("Failed to rebuild",g)}return d}function $s(e,t){var n=t.doc,r=t.onVisit,o=t.hackCss,i=o===void 0||o,s=t.afterAppend,a=t.cache,l=t.mirror,c=l===void 0?new Yr:l,d=Ct(e,{doc:n,mirror:c,skipChild:!1,hackCss:i,afterAppend:s,cache:a});return function(u,p){for(var g=0,h=u.getIds();g<h.length;g++){var m=h[g];u.has(m)&&p(u.getNode(m))}}(c,function(u){r&&r(u),function(p,g){var h=g.getMeta(p);if((h==null?void 0:h.type)===de.Element){var m=p;for(var I in h.attributes)if(Object.prototype.hasOwnProperty.call(h.attributes,I)&&I.startsWith("rr_")){var y=h.attributes[I];I==="rr_scrollLeft"&&(m.scrollLeft=y),I==="rr_scrollTop"&&(m.scrollTop=y)}}}(u,c)}),d}const ot=`Please stop import mirror directly. Instead of that,\r
now you can use replayer.getMirror() to access the mirror instance of a replayer,\r
or you can use record.mirror to access the mirror instance during recording.`;let jr={map:{},getId:()=>(console.error(ot),-1),getNode:()=>(console.error(ot),null),removeNodeFromMap(){console.error(ot)},has:()=>(console.error(ot),!1),reset(){console.error(ot)}};function zs(e){const t={},n=(o,i)=>{const s={value:o,parent:i,children:[]};return t[o.node.id]=s,s},r=[];for(const o of e){const{nextId:i,parentId:s}=o;if(i&&i in t){const a=t[i];if(a.parent){const l=a.parent.children.indexOf(a);a.parent.children.splice(l,0,n(o,a.parent))}else{const l=r.indexOf(a);r.splice(l,0,n(o,null))}}else if(s in t){const a=t[s];a.children.push(n(o,a))}else r.push(n(o,null))}return r}function Xr(e,t){t(e.value);for(let n=e.children.length-1;n>=0;n--)Xr(e.children[n],t)}function En(e,t){return!!(e.nodeName==="IFRAME"&&t.getMeta(e))}function qr(e,t){var n,r;const o=(r=(n=e.ownerDocument)===null||n===void 0?void 0:n.defaultView)===null||r===void 0?void 0:r.frameElement;if(!o||o===t)return{x:0,y:0,relativeScale:1,absoluteScale:1};const i=o.getBoundingClientRect(),s=qr(o,t),a=i.height/o.clientHeight;return{x:i.x*s.relativeScale+s.x,y:i.y*s.relativeScale+s.y,relativeScale:a,absoluteScale:s.absoluteScale*a}}function $t(e){return!!(e!=null&&e.shadowRoot)}function vt(e,t){const n=e[t[0]];return t.length===1?n:vt(n.cssRules[t[1]].cssRules,t.slice(2))}function eo(e){const t=[...e],n=t.pop();return{positions:t,index:n}}typeof window<"u"&&window.Proxy&&window.Reflect&&(jr=new Proxy(jr,{get:(e,t,n)=>(t==="map"&&console.error(ot),Reflect.get(e,t,n))}));class Hs{constructor(){this.id=1,this.styleIDMap=new WeakMap,this.idStyleMap=new Map}getId(t){var n;return(n=this.styleIDMap.get(t))!==null&&n!==void 0?n:-1}has(t){return this.styleIDMap.has(t)}add(t,n){if(this.has(t))return this.getId(t);let r;return r=n===void 0?this.id++:n,this.styleIDMap.set(t,r),this.idStyleMap.set(r,t),r}getStyle(t){return this.idStyleMap.get(t)||null}reset(){this.styleIDMap=new WeakMap,this.idStyleMap=new Map,this.id=1}generateId(){return this.id++}}var re=(e=>(e[e.DomContentLoaded=0]="DomContentLoaded",e[e.Load=1]="Load",e[e.FullSnapshot=2]="FullSnapshot",e[e.IncrementalSnapshot=3]="IncrementalSnapshot",e[e.Meta=4]="Meta",e[e.Custom=5]="Custom",e[e.Plugin=6]="Plugin",e))(re||{}),Q=(e=>(e[e.Mutation=0]="Mutation",e[e.MouseMove=1]="MouseMove",e[e.MouseInteraction=2]="MouseInteraction",e[e.Scroll=3]="Scroll",e[e.ViewportResize=4]="ViewportResize",e[e.Input=5]="Input",e[e.TouchMove=6]="TouchMove",e[e.MediaInteraction=7]="MediaInteraction",e[e.StyleSheetRule=8]="StyleSheetRule",e[e.CanvasMutation=9]="CanvasMutation",e[e.Font=10]="Font",e[e.Log=11]="Log",e[e.Drag=12]="Drag",e[e.StyleDeclaration=13]="StyleDeclaration",e[e.Selection=14]="Selection",e[e.AdoptedStyleSheet=15]="AdoptedStyleSheet",e))(Q||{}),ge=(e=>(e[e.MouseUp=0]="MouseUp",e[e.MouseDown=1]="MouseDown",e[e.Click=2]="Click",e[e.ContextMenu=3]="ContextMenu",e[e.DblClick=4]="DblClick",e[e.Focus=5]="Focus",e[e.Blur=6]="Blur",e[e.TouchStart=7]="TouchStart",e[e.TouchMove_Departed=8]="TouchMove_Departed",e[e.TouchEnd=9]="TouchEnd",e[e.TouchCancel=10]="TouchCancel",e))(ge||{}),zt=(e=>(e[e["2D"]=0]="2D",e[e.WebGL=1]="WebGL",e[e.WebGL2=2]="WebGL2",e))(zt||{}),X=(e=>(e.Start="start",e.Pause="pause",e.Resume="resume",e.Resize="resize",e.Finish="finish",e.FullsnapshotRebuilded="fullsnapshot-rebuilded",e.LoadStylesheetStart="load-stylesheet-start",e.LoadStylesheetEnd="load-stylesheet-end",e.SkipStart="skip-start",e.SkipEnd="skip-end",e.MouseInteraction="mouse-interaction",e.EventCast="event-cast",e.CustomEvent="custom-event",e.Flush="flush",e.StateChange="state-change",e.PlayBack="play-back",e.Destroy="destroy",e))(X||{});/*! *****************************************************************************
  Copyright (c) Microsoft Corporation.

  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.

  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** */function Ke(e,t,n,r){return new(n||(n=Promise))(function(o,i){function s(c){try{l(r.next(c))}catch(d){i(d)}}function a(c){try{l(r.throw(c))}catch(d){i(d)}}function l(c){var d;c.done?o(c.value):(d=c.value,d instanceof n?d:new n(function(u){u(d)})).then(s,a)}l((r=r.apply(e,t||[])).next())})}for(var to="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bt=typeof Uint8Array>"u"?[]:new Uint8Array(256),Ht=0;Ht<to.length;Ht++)bt[to.charCodeAt(Ht)]=Ht;var no=null;try{var Qs=typeof module<"u"&&typeof module.require=="function"&&module.require("worker_threads")||typeof __non_webpack_require__=="function"&&__non_webpack_require__("worker_threads")||typeof require=="function"&&require("worker_threads");no=Qs.Worker}catch{}function Js(e,t,n){var r=t===void 0?null:t,o=function(a,l){return Buffer.from(a,"base64").toString(l?"utf16":"utf8")}(e,n!==void 0&&n),i=o.indexOf(`
`,10)+1,s=o.substring(i)+(r?"//# sourceMappingURL="+r:"");return function(a){return new no(s,Object.assign({},a,{eval:!0}))}}var ro,oo,io,Z,js=Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]";ro="Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwooZnVuY3Rpb24gKCkgewogICAgJ3VzZSBzdHJpY3QnOwoKICAgIC8qISAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KICAgIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLg0KDQogICAgUGVybWlzc2lvbiB0byB1c2UsIGNvcHksIG1vZGlmeSwgYW5kL29yIGRpc3RyaWJ1dGUgdGhpcyBzb2Z0d2FyZSBmb3IgYW55DQogICAgcHVycG9zZSB3aXRoIG9yIHdpdGhvdXQgZmVlIGlzIGhlcmVieSBncmFudGVkLg0KDQogICAgVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEICJBUyBJUyIgQU5EIFRIRSBBVVRIT1IgRElTQ0xBSU1TIEFMTCBXQVJSQU5USUVTIFdJVEgNCiAgICBSRUdBUkQgVE8gVEhJUyBTT0ZUV0FSRSBJTkNMVURJTkcgQUxMIElNUExJRUQgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFkNCiAgICBBTkQgRklUTkVTUy4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUiBCRSBMSUFCTEUgRk9SIEFOWSBTUEVDSUFMLCBESVJFQ1QsDQogICAgSU5ESVJFQ1QsIE9SIENPTlNFUVVFTlRJQUwgREFNQUdFUyBPUiBBTlkgREFNQUdFUyBXSEFUU09FVkVSIFJFU1VMVElORyBGUk9NDQogICAgTE9TUyBPRiBVU0UsIERBVEEgT1IgUFJPRklUUywgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIE5FR0xJR0VOQ0UgT1INCiAgICBPVEhFUiBUT1JUSU9VUyBBQ1RJT04sIEFSSVNJTkcgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgVVNFIE9SDQogICAgUEVSRk9STUFOQ0UgT0YgVEhJUyBTT0ZUV0FSRS4NCiAgICAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiAqLw0KDQogICAgZnVuY3Rpb24gX19hd2FpdGVyKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikgew0KICAgICAgICBmdW5jdGlvbiBhZG9wdCh2YWx1ZSkgeyByZXR1cm4gdmFsdWUgaW5zdGFuY2VvZiBQID8gdmFsdWUgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHZhbHVlKTsgfSk7IH0NCiAgICAgICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7DQogICAgICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9DQogICAgICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvclsidGhyb3ciXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9DQogICAgICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IGFkb3B0KHJlc3VsdC52YWx1ZSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfQ0KICAgICAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpOw0KICAgICAgICB9KTsNCiAgICB9CgogICAgLyoKICAgICAqIGJhc2U2NC1hcnJheWJ1ZmZlciAxLjAuMSA8aHR0cHM6Ly9naXRodWIuY29tL25pa2xhc3ZoL2Jhc2U2NC1hcnJheWJ1ZmZlcj4KICAgICAqIENvcHlyaWdodCAoYykgMjAyMSBOaWtsYXMgdm9uIEhlcnR6ZW4gPGh0dHBzOi8vaGVydHplbi5jb20+CiAgICAgKiBSZWxlYXNlZCB1bmRlciBNSVQgTGljZW5zZQogICAgICovCiAgICB2YXIgY2hhcnMgPSAnQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkrLyc7CiAgICAvLyBVc2UgYSBsb29rdXAgdGFibGUgdG8gZmluZCB0aGUgaW5kZXguCiAgICB2YXIgbG9va3VwID0gdHlwZW9mIFVpbnQ4QXJyYXkgPT09ICd1bmRlZmluZWQnID8gW10gOiBuZXcgVWludDhBcnJheSgyNTYpOwogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjaGFycy5sZW5ndGg7IGkrKykgewogICAgICAgIGxvb2t1cFtjaGFycy5jaGFyQ29kZUF0KGkpXSA9IGk7CiAgICB9CiAgICB2YXIgZW5jb2RlID0gZnVuY3Rpb24gKGFycmF5YnVmZmVyKSB7CiAgICAgICAgdmFyIGJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkoYXJyYXlidWZmZXIpLCBpLCBsZW4gPSBieXRlcy5sZW5ndGgsIGJhc2U2NCA9ICcnOwogICAgICAgIGZvciAoaSA9IDA7IGkgPCBsZW47IGkgKz0gMykgewogICAgICAgICAgICBiYXNlNjQgKz0gY2hhcnNbYnl0ZXNbaV0gPj4gMl07CiAgICAgICAgICAgIGJhc2U2NCArPSBjaGFyc1soKGJ5dGVzW2ldICYgMykgPDwgNCkgfCAoYnl0ZXNbaSArIDFdID4+IDQpXTsKICAgICAgICAgICAgYmFzZTY0ICs9IGNoYXJzWygoYnl0ZXNbaSArIDFdICYgMTUpIDw8IDIpIHwgKGJ5dGVzW2kgKyAyXSA+PiA2KV07CiAgICAgICAgICAgIGJhc2U2NCArPSBjaGFyc1tieXRlc1tpICsgMl0gJiA2M107CiAgICAgICAgfQogICAgICAgIGlmIChsZW4gJSAzID09PSAyKSB7CiAgICAgICAgICAgIGJhc2U2NCA9IGJhc2U2NC5zdWJzdHJpbmcoMCwgYmFzZTY0Lmxlbmd0aCAtIDEpICsgJz0nOwogICAgICAgIH0KICAgICAgICBlbHNlIGlmIChsZW4gJSAzID09PSAxKSB7CiAgICAgICAgICAgIGJhc2U2NCA9IGJhc2U2NC5zdWJzdHJpbmcoMCwgYmFzZTY0Lmxlbmd0aCAtIDIpICsgJz09JzsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGJhc2U2NDsKICAgIH07CgogICAgY29uc3QgbGFzdEJsb2JNYXAgPSBuZXcgTWFwKCk7DQogICAgY29uc3QgdHJhbnNwYXJlbnRCbG9iTWFwID0gbmV3IE1hcCgpOw0KICAgIGZ1bmN0aW9uIGdldFRyYW5zcGFyZW50QmxvYkZvcih3aWR0aCwgaGVpZ2h0LCBkYXRhVVJMT3B0aW9ucykgew0KICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkgew0KICAgICAgICAgICAgY29uc3QgaWQgPSBgJHt3aWR0aH0tJHtoZWlnaHR9YDsNCiAgICAgICAgICAgIGlmICgnT2Zmc2NyZWVuQ2FudmFzJyBpbiBnbG9iYWxUaGlzKSB7DQogICAgICAgICAgICAgICAgaWYgKHRyYW5zcGFyZW50QmxvYk1hcC5oYXMoaWQpKQ0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJhbnNwYXJlbnRCbG9iTWFwLmdldChpZCk7DQogICAgICAgICAgICAgICAgY29uc3Qgb2Zmc2NyZWVuID0gbmV3IE9mZnNjcmVlbkNhbnZhcyh3aWR0aCwgaGVpZ2h0KTsNCiAgICAgICAgICAgICAgICBvZmZzY3JlZW4uZ2V0Q29udGV4dCgnMmQnKTsNCiAgICAgICAgICAgICAgICBjb25zdCBibG9iID0geWllbGQgb2Zmc2NyZWVuLmNvbnZlcnRUb0Jsb2IoZGF0YVVSTE9wdGlvbnMpOw0KICAgICAgICAgICAgICAgIGNvbnN0IGFycmF5QnVmZmVyID0geWllbGQgYmxvYi5hcnJheUJ1ZmZlcigpOw0KICAgICAgICAgICAgICAgIGNvbnN0IGJhc2U2NCA9IGVuY29kZShhcnJheUJ1ZmZlcik7DQogICAgICAgICAgICAgICAgdHJhbnNwYXJlbnRCbG9iTWFwLnNldChpZCwgYmFzZTY0KTsNCiAgICAgICAgICAgICAgICByZXR1cm4gYmFzZTY0Ow0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgZWxzZSB7DQogICAgICAgICAgICAgICAgcmV0dXJuICcnOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9KTsNCiAgICB9DQogICAgY29uc3Qgd29ya2VyID0gc2VsZjsNCiAgICB3b3JrZXIub25tZXNzYWdlID0gZnVuY3Rpb24gKGUpIHsNCiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHsNCiAgICAgICAgICAgIGlmICgnT2Zmc2NyZWVuQ2FudmFzJyBpbiBnbG9iYWxUaGlzKSB7DQogICAgICAgICAgICAgICAgY29uc3QgeyBpZCwgYml0bWFwLCB3aWR0aCwgaGVpZ2h0LCBkYXRhVVJMT3B0aW9ucyB9ID0gZS5kYXRhOw0KICAgICAgICAgICAgICAgIGNvbnN0IHRyYW5zcGFyZW50QmFzZTY0ID0gZ2V0VHJhbnNwYXJlbnRCbG9iRm9yKHdpZHRoLCBoZWlnaHQsIGRhdGFVUkxPcHRpb25zKTsNCiAgICAgICAgICAgICAgICBjb25zdCBvZmZzY3JlZW4gPSBuZXcgT2Zmc2NyZWVuQ2FudmFzKHdpZHRoLCBoZWlnaHQpOw0KICAgICAgICAgICAgICAgIGNvbnN0IGN0eCA9IG9mZnNjcmVlbi5nZXRDb250ZXh0KCcyZCcpOw0KICAgICAgICAgICAgICAgIGN0eC5kcmF3SW1hZ2UoYml0bWFwLCAwLCAwKTsNCiAgICAgICAgICAgICAgICBiaXRtYXAuY2xvc2UoKTsNCiAgICAgICAgICAgICAgICBjb25zdCBibG9iID0geWllbGQgb2Zmc2NyZWVuLmNvbnZlcnRUb0Jsb2IoZGF0YVVSTE9wdGlvbnMpOw0KICAgICAgICAgICAgICAgIGNvbnN0IHR5cGUgPSBibG9iLnR5cGU7DQogICAgICAgICAgICAgICAgY29uc3QgYXJyYXlCdWZmZXIgPSB5aWVsZCBibG9iLmFycmF5QnVmZmVyKCk7DQogICAgICAgICAgICAgICAgY29uc3QgYmFzZTY0ID0gZW5jb2RlKGFycmF5QnVmZmVyKTsNCiAgICAgICAgICAgICAgICBpZiAoIWxhc3RCbG9iTWFwLmhhcyhpZCkgJiYgKHlpZWxkIHRyYW5zcGFyZW50QmFzZTY0KSA9PT0gYmFzZTY0KSB7DQogICAgICAgICAgICAgICAgICAgIGxhc3RCbG9iTWFwLnNldChpZCwgYmFzZTY0KTsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHdvcmtlci5wb3N0TWVzc2FnZSh7IGlkIH0pOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpZiAobGFzdEJsb2JNYXAuZ2V0KGlkKSA9PT0gYmFzZTY0KQ0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gd29ya2VyLnBvc3RNZXNzYWdlKHsgaWQgfSk7DQogICAgICAgICAgICAgICAgd29ya2VyLnBvc3RNZXNzYWdlKHsNCiAgICAgICAgICAgICAgICAgICAgaWQsDQogICAgICAgICAgICAgICAgICAgIHR5cGUsDQogICAgICAgICAgICAgICAgICAgIGJhc2U2NCwNCiAgICAgICAgICAgICAgICAgICAgd2lkdGgsDQogICAgICAgICAgICAgICAgICAgIGhlaWdodCwNCiAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICBsYXN0QmxvYk1hcC5zZXQoaWQsIGJhc2U2NCk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBlbHNlIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gd29ya2VyLnBvc3RNZXNzYWdlKHsgaWQ6IGUuZGF0YS5pZCB9KTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSk7DQogICAgfTsKCn0pKCk7Cgo=",oo=null,io=!1,js&&Js(ro,oo,io),function(e){e[e.Document=0]="Document",e[e.DocumentType=1]="DocumentType",e[e.Element=2]="Element",e[e.Text=3]="Text",e[e.CDATA=4]="CDATA",e[e.Comment=5]="Comment"}(Z||(Z={}));var Xs=function(){function e(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}return e.prototype.getId=function(t){var n;if(!t)return-1;var r=(n=this.getMeta(t))===null||n===void 0?void 0:n.id;return r??-1},e.prototype.getNode=function(t){return this.idNodeMap.get(t)||null},e.prototype.getIds=function(){return Array.from(this.idNodeMap.keys())},e.prototype.getMeta=function(t){return this.nodeMetaMap.get(t)||null},e.prototype.removeNodeFromMap=function(t){var n=this,r=this.getId(t);this.idNodeMap.delete(r),t.childNodes&&t.childNodes.forEach(function(o){return n.removeNodeFromMap(o)})},e.prototype.has=function(t){return this.idNodeMap.has(t)},e.prototype.hasNode=function(t){return this.nodeMetaMap.has(t)},e.prototype.add=function(t,n){var r=n.id;this.idNodeMap.set(r,t),this.nodeMetaMap.set(t,n)},e.prototype.replace=function(t,n){var r=this.getNode(t);if(r){var o=this.nodeMetaMap.get(r);o&&this.nodeMetaMap.set(n,o)}this.idNodeMap.set(t,n)},e.prototype.reset=function(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap},e}();function so(e){const t=[];for(const n in e){const r=e[n];if(typeof r!="string")continue;const o=na(n);t.push(`${o}: ${r};`)}return t.join(" ")}const qs=/-([a-z])/g,ea=/^--[a-zA-Z0-9-]+$/,Nn=e=>ea.test(e)?e:e.replace(qs,(t,n)=>n?n.toUpperCase():""),ta=/\B([A-Z])/g,na=e=>e.replace(ta,"-$1").toLowerCase();class Se{constructor(...t){this.childNodes=[],this.parentElement=null,this.parentNode=null,this.ELEMENT_NODE=ie.ELEMENT_NODE,this.TEXT_NODE=ie.TEXT_NODE}get firstChild(){return this.childNodes[0]||null}get lastChild(){return this.childNodes[this.childNodes.length-1]||null}get nextSibling(){const t=this.parentNode;if(!t)return null;const n=t.childNodes,r=n.indexOf(this);return n[r+1]||null}contains(t){if(t===this)return!0;for(const n of this.childNodes)if(n.contains(t))return!0;return!1}appendChild(t){throw new Error("RRDomException: Failed to execute 'appendChild' on 'RRNode': This RRNode type does not support this method.")}insertBefore(t,n){throw new Error("RRDomException: Failed to execute 'insertBefore' on 'RRNode': This RRNode type does not support this method.")}removeChild(t){throw new Error("RRDomException: Failed to execute 'removeChild' on 'RRNode': This RRNode type does not support this method.")}toString(){return"RRNode"}}function ao(e){return class extends e{constructor(t,n,r){super(),this.nodeType=ie.DOCUMENT_TYPE_NODE,this.RRNodeType=Z.DocumentType,this.textContent=null,this.name=t,this.publicId=n,this.systemId=r,this.nodeName=t}toString(){return"RRDocumentType"}}}function lo(e){return class extends e{constructor(t){super(),this.nodeType=ie.ELEMENT_NODE,this.RRNodeType=Z.Element,this.attributes={},this.shadowRoot=null,this.tagName=t.toUpperCase(),this.nodeName=t.toUpperCase()}get textContent(){let t="";return this.childNodes.forEach(n=>t+=n.textContent),t}set textContent(t){this.childNodes=[this.ownerDocument.createTextNode(t)]}get classList(){return new ra(this.attributes.class,t=>{this.attributes.class=t})}get id(){return this.attributes.id||""}get className(){return this.attributes.class||""}get style(){const t=this.attributes.style?function(r){const o={},i=/:(.+)/;return r.replace(/\/\*.*?\*\//g,"").split(/;(?![^(]*\))/g).forEach(function(s){if(s){const a=s.split(i);a.length>1&&(o[Nn(a[0].trim())]=a[1].trim())}}),o}(this.attributes.style):{},n=/\B([A-Z])/g;return t.setProperty=(r,o,i)=>{if(n.test(r))return;const s=Nn(r);o?t[s]=o:delete t[s],i==="important"&&(t[s]+=" !important"),this.attributes.style=so(t)},t.removeProperty=r=>{if(n.test(r))return"";const o=Nn(r),i=t[o]||"";return delete t[o],this.attributes.style=so(t),i},t}getAttribute(t){return this.attributes[t]||null}setAttribute(t,n){this.attributes[t]=n}setAttributeNS(t,n,r){this.setAttribute(n,r)}removeAttribute(t){delete this.attributes[t]}appendChild(t){return this.childNodes.push(t),t.parentNode=this,t.parentElement=this,t}insertBefore(t,n){if(n===null)return this.appendChild(t);const r=this.childNodes.indexOf(n);if(r==-1)throw new Error("Failed to execute 'insertBefore' on 'RRNode': The RRNode before which the new node is to be inserted is not a child of this RRNode.");return this.childNodes.splice(r,0,t),t.parentElement=this,t.parentNode=this,t}removeChild(t){const n=this.childNodes.indexOf(t);if(n===-1)throw new Error("Failed to execute 'removeChild' on 'RRElement': The RRNode to be removed is not a child of this RRNode.");return this.childNodes.splice(n,1),t.parentElement=null,t.parentNode=null,t}attachShadow(t){const n=this.ownerDocument.createElement("SHADOWROOT");return this.shadowRoot=n,n}dispatchEvent(t){return!0}toString(){let t="";for(const n in this.attributes)t+=`${n}="${this.attributes[n]}" `;return`${this.tagName} ${t}`}}}function co(e){return class extends e{constructor(t){super(),this.nodeType=ie.TEXT_NODE,this.nodeName="#text",this.RRNodeType=Z.Text,this.data=t}get textContent(){return this.data}set textContent(t){this.data=t}toString(){return`RRText text=${JSON.stringify(this.data)}`}}}function uo(e){return class extends e{constructor(t){super(),this.nodeType=ie.COMMENT_NODE,this.nodeName="#comment",this.RRNodeType=Z.Comment,this.data=t}get textContent(){return this.data}set textContent(t){this.data=t}toString(){return`RRComment text=${JSON.stringify(this.data)}`}}}function ho(e){return class extends e{constructor(t){super(),this.nodeName="#cdata-section",this.nodeType=ie.CDATA_SECTION_NODE,this.RRNodeType=Z.CDATA,this.data=t}get textContent(){return this.data}set textContent(t){this.data=t}toString(){return`RRCDATASection data=${JSON.stringify(this.data)}`}}}class ra{constructor(t,n){if(this.classes=[],this.add=(...r)=>{for(const o of r){const i=String(o);this.classes.indexOf(i)>=0||this.classes.push(i)}this.onChange&&this.onChange(this.classes.join(" "))},this.remove=(...r)=>{this.classes=this.classes.filter(o=>r.indexOf(o)===-1),this.onChange&&this.onChange(this.classes.join(" "))},t){const r=t.trim().split(/\s+/);this.classes.push(...r)}this.onChange=n}}var ie;(function(e){e[e.PLACEHOLDER=0]="PLACEHOLDER",e[e.ELEMENT_NODE=1]="ELEMENT_NODE",e[e.ATTRIBUTE_NODE=2]="ATTRIBUTE_NODE",e[e.TEXT_NODE=3]="TEXT_NODE",e[e.CDATA_SECTION_NODE=4]="CDATA_SECTION_NODE",e[e.ENTITY_REFERENCE_NODE=5]="ENTITY_REFERENCE_NODE",e[e.ENTITY_NODE=6]="ENTITY_NODE",e[e.PROCESSING_INSTRUCTION_NODE=7]="PROCESSING_INSTRUCTION_NODE",e[e.COMMENT_NODE=8]="COMMENT_NODE",e[e.DOCUMENT_NODE=9]="DOCUMENT_NODE",e[e.DOCUMENT_TYPE_NODE=10]="DOCUMENT_TYPE_NODE",e[e.DOCUMENT_FRAGMENT_NODE=11]="DOCUMENT_FRAGMENT_NODE"})(ie||(ie={}));const Tn={svg:"http://www.w3.org/2000/svg","xlink:href":"http://www.w3.org/1999/xlink",xmlns:"http://www.w3.org/2000/xmlns/"},oa={altglyph:"altGlyph",altglyphdef:"altGlyphDef",altglyphitem:"altGlyphItem",animatecolor:"animateColor",animatemotion:"animateMotion",animatetransform:"animateTransform",clippath:"clipPath",feblend:"feBlend",fecolormatrix:"feColorMatrix",fecomponenttransfer:"feComponentTransfer",fecomposite:"feComposite",feconvolvematrix:"feConvolveMatrix",fediffuselighting:"feDiffuseLighting",fedisplacementmap:"feDisplacementMap",fedistantlight:"feDistantLight",fedropshadow:"feDropShadow",feflood:"feFlood",fefunca:"feFuncA",fefuncb:"feFuncB",fefuncg:"feFuncG",fefuncr:"feFuncR",fegaussianblur:"feGaussianBlur",feimage:"feImage",femerge:"feMerge",femergenode:"feMergeNode",femorphology:"feMorphology",feoffset:"feOffset",fepointlight:"fePointLight",fespecularlighting:"feSpecularLighting",fespotlight:"feSpotLight",fetile:"feTile",feturbulence:"feTurbulence",foreignobject:"foreignObject",glyphref:"glyphRef",lineargradient:"linearGradient",radialgradient:"radialGradient"};function Re(e,t,n,r){const o=e.childNodes,i=t.childNodes;r=r||t.mirror||t.ownerDocument.mirror,(o.length>0||i.length>0)&&po(Array.from(o),i,e,n,r);let s=null,a=null;switch(t.RRNodeType){case Z.Document:a=t.scrollData;break;case Z.Element:{const l=e,c=t;switch(function(d,u,p){const g=d.attributes,h=u.attributes;for(const m in h){const I=h[m],y=p.getMeta(u);if(y&&"isSVG"in y&&y.isSVG&&Tn[m])d.setAttributeNS(Tn[m],m,I);else if(u.tagName==="CANVAS"&&m==="rr_dataURL"){const f=document.createElement("img");f.src=I,f.onload=()=>{const w=d.getContext("2d");w&&w.drawImage(f,0,0,f.width,f.height)}}else d.setAttribute(m,I)}for(const{name:m}of Array.from(g))m in h||d.removeAttribute(m);u.scrollLeft&&(d.scrollLeft=u.scrollLeft),u.scrollTop&&(d.scrollTop=u.scrollTop)}(l,c,r),a=c.scrollData,s=c.inputData,c.tagName){case"AUDIO":case"VIDEO":{const d=e,u=c;u.paused!==void 0&&(u.paused?d.pause():d.play()),u.muted!==void 0&&(d.muted=u.muted),u.volume!==void 0&&(d.volume=u.volume),u.currentTime!==void 0&&(d.currentTime=u.currentTime),u.playbackRate!==void 0&&(d.playbackRate=u.playbackRate);break}case"CANVAS":{const d=t;if(d.rr_dataURL!==null){const u=document.createElement("img");u.onload=()=>{const p=l.getContext("2d");p&&p.drawImage(u,0,0,u.width,u.height)},u.src=d.rr_dataURL}d.canvasMutations.forEach(u=>n.applyCanvas(u.event,u.mutation,e))}break;case"STYLE":{const d=l.sheet;d&&t.rules.forEach(u=>n.applyStyleSheetMutation(u,d))}}if(c.shadowRoot){l.shadowRoot||l.attachShadow({mode:"open"});const d=l.shadowRoot.childNodes,u=c.shadowRoot.childNodes;(d.length>0||u.length>0)&&po(Array.from(d),u,l.shadowRoot,n,r)}break}case Z.Text:case Z.Comment:case Z.CDATA:e.textContent!==t.data&&(e.textContent=t.data)}if(a&&n.applyScroll(a,!0),s&&n.applyInput(s),t.nodeName==="IFRAME"){const l=e.contentDocument,c=t;if(l){const d=r.getMeta(c.contentDocument);d&&n.mirror.add(l,Object.assign({},d)),Re(l,c.contentDocument,n,r)}}}function po(e,t,n,r,o){var i;let s,a,l=0,c=e.length-1,d=0,u=t.length-1,p=e[l],g=e[c],h=t[d],m=t[u];for(;l<=c&&d<=u;){const I=r.mirror.getId(p),y=r.mirror.getId(g),f=o.getId(h),w=o.getId(m);if(p===void 0)p=e[++l];else if(g===void 0)g=e[--c];else if(I!==-1&&I===f)Re(p,h,r,o),p=e[++l],h=t[++d];else if(y!==-1&&y===w)Re(g,m,r,o),g=e[--c],m=t[--u];else if(I!==-1&&I===w)n.insertBefore(p,g.nextSibling),Re(p,m,r,o),p=e[++l],m=t[--u];else if(y!==-1&&y===f)n.insertBefore(g,p),Re(g,h,r,o),g=e[--c],h=t[++d];else{if(!s){s={};for(let A=l;A<=c;A++){const L=e[A];L&&r.mirror.hasNode(L)&&(s[r.mirror.getId(L)]=A)}}if(a=s[o.getId(h)],a){const A=e[a];n.insertBefore(A,p),Re(A,h,r,o),e[a]=void 0}else{const A=Rn(h,r.mirror,o);n.nodeName==="#document"&&((i=r.mirror.getMeta(A))===null||i===void 0?void 0:i.type)===Z.Element&&n.documentElement&&(n.removeChild(n.documentElement),e[l]=void 0,p=void 0),n.insertBefore(A,p||null),Re(A,h,r,o)}h=t[++d]}}if(l>c){const I=t[u+1];let y=null;for(I&&n.childNodes.forEach(f=>{r.mirror.getId(f)===o.getId(I)&&(y=f)});d<=u;++d){const f=Rn(t[d],r.mirror,o);n.insertBefore(f,y),Re(f,t[d],r,o)}}else if(d>u)for(;l<=c;l++){const I=e[l];I&&(n.removeChild(I),r.mirror.removeNodeFromMap(I))}}function Rn(e,t,n){const r=n.getId(e),o=n.getMeta(e);let i=null;if(r>-1&&(i=t.getNode(r)),i!==null)return i;switch(e.RRNodeType){case Z.Document:i=new Document;break;case Z.DocumentType:i=document.implementation.createDocumentType(e.name,e.publicId,e.systemId);break;case Z.Element:{let s=e.tagName.toLowerCase();s=oa[s]||s,i=o&&"isSVG"in o&&(o!=null&&o.isSVG)?document.createElementNS(Tn.svg,s):document.createElement(e.tagName);break}case Z.Text:i=document.createTextNode(e.data);break;case Z.Comment:i=document.createComment(e.data);break;case Z.CDATA:i=document.createCDATASection(e.data)}return o&&t.add(i,Object.assign({},o)),i}class it extends function(t){return class ti extends t{constructor(){super(...arguments),this.nodeType=ie.DOCUMENT_NODE,this.nodeName="#document",this.compatMode="CSS1Compat",this.RRNodeType=Z.Document,this.textContent=null}get documentElement(){return this.childNodes.find(r=>r.RRNodeType===Z.Element&&r.tagName==="HTML")||null}get body(){var r;return((r=this.documentElement)===null||r===void 0?void 0:r.childNodes.find(o=>o.RRNodeType===Z.Element&&o.tagName==="BODY"))||null}get head(){var r;return((r=this.documentElement)===null||r===void 0?void 0:r.childNodes.find(o=>o.RRNodeType===Z.Element&&o.tagName==="HEAD"))||null}get implementation(){return this}get firstElementChild(){return this.documentElement}appendChild(r){const o=r.RRNodeType;if((o===Z.Element||o===Z.DocumentType)&&this.childNodes.some(i=>i.RRNodeType===o))throw new Error(`RRDomException: Failed to execute 'appendChild' on 'RRNode': Only one ${o===Z.Element?"RRElement":"RRDoctype"} on RRDocument allowed.`);return r.parentElement=null,r.parentNode=this,this.childNodes.push(r),r}insertBefore(r,o){const i=r.RRNodeType;if((i===Z.Element||i===Z.DocumentType)&&this.childNodes.some(a=>a.RRNodeType===i))throw new Error(`RRDomException: Failed to execute 'insertBefore' on 'RRNode': Only one ${i===Z.Element?"RRElement":"RRDoctype"} on RRDocument allowed.`);if(o===null)return this.appendChild(r);const s=this.childNodes.indexOf(o);if(s==-1)throw new Error("Failed to execute 'insertBefore' on 'RRNode': The RRNode before which the new node is to be inserted is not a child of this RRNode.");return this.childNodes.splice(s,0,r),r.parentElement=null,r.parentNode=this,r}removeChild(r){const o=this.childNodes.indexOf(r);if(o===-1)throw new Error("Failed to execute 'removeChild' on 'RRDocument': The RRNode to be removed is not a child of this RRNode.");return this.childNodes.splice(o,1),r.parentElement=null,r.parentNode=null,r}open(){this.childNodes=[]}close(){}write(r){let o;if(r==='<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "">'?o="-//W3C//DTD XHTML 1.0 Transitional//EN":r==='<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "">'&&(o="-//W3C//DTD HTML 4.0 Transitional//EN"),o){const i=this.createDocumentType("html",o,"");this.open(),this.appendChild(i)}}createDocument(r,o,i){return new ti}createDocumentType(r,o,i){const s=new(ao(Se))(r,o,i);return s.ownerDocument=this,s}createElement(r){const o=new(lo(Se))(r);return o.ownerDocument=this,o}createElementNS(r,o){return this.createElement(o)}createTextNode(r){const o=new(co(Se))(r);return o.ownerDocument=this,o}createComment(r){const o=new(uo(Se))(r);return o.ownerDocument=this,o}createCDATASection(r){const o=new(ho(Se))(r);return o.ownerDocument=this,o}toString(){return"RRDocument"}}}(Se){constructor(t){super(),this.UNSERIALIZED_STARTING_ID=-2,this._unserializedId=this.UNSERIALIZED_STARTING_ID,this.mirror=new ma,this.scrollData=null,t&&(this.mirror=t)}get unserializedId(){return this._unserializedId--}createDocument(t,n,r){return new it}createDocumentType(t,n,r){const o=new ia(t,n,r);return o.ownerDocument=this,o}createElement(t){const n=t.toUpperCase();let r;switch(n){case"AUDIO":case"VIDEO":r=new sa(n);break;case"IFRAME":r=new ca(n,this.mirror);break;case"CANVAS":r=new aa(n);break;case"STYLE":r=new la(n);break;default:r=new wt(n)}return r.ownerDocument=this,r}createComment(t){const n=new ua(t);return n.ownerDocument=this,n}createCDATASection(t){const n=new ha(t);return n.ownerDocument=this,n}createTextNode(t){const n=new da(t);return n.ownerDocument=this,n}destroyTree(){this.childNodes=[],this.mirror.reset()}open(){super.open(),this._unserializedId=this.UNSERIALIZED_STARTING_ID}}const ia=ao(Se);class wt extends lo(Se){constructor(){super(...arguments),this.inputData=null,this.scrollData=null}}class sa extends function(t){return class extends t{attachShadow(n){throw new Error("RRDomException: Failed to execute 'attachShadow' on 'RRElement': This RRElement does not support attachShadow")}play(){this.paused=!1}pause(){this.paused=!0}}}(wt){}class aa extends wt{constructor(){super(...arguments),this.rr_dataURL=null,this.canvasMutations=[]}getContext(){return null}}class la extends wt{constructor(){super(...arguments),this.rules=[]}}class ca extends wt{constructor(t,n){super(t),this.contentDocument=new it,this.contentDocument.mirror=n}}const da=co(Se),ua=uo(Se),ha=ho(Se);function mo(e,t,n,r){let o;switch(e.nodeType){case ie.DOCUMENT_NODE:r&&r.nodeName==="IFRAME"?o=r.contentDocument:(o=t,o.compatMode=e.compatMode);break;case ie.DOCUMENT_TYPE_NODE:{const s=e;o=t.createDocumentType(s.name,s.publicId,s.systemId);break}case ie.ELEMENT_NODE:{const s=e,a=function(c){return c instanceof HTMLFormElement?"FORM":c.tagName.toUpperCase()}(s);o=t.createElement(a);const l=o;for(const{name:c,value:d}of Array.from(s.attributes))l.attributes[c]=d;s.scrollLeft&&(l.scrollLeft=s.scrollLeft),s.scrollTop&&(l.scrollTop=s.scrollTop);break}case ie.TEXT_NODE:o=t.createTextNode(e.textContent||"");break;case ie.CDATA_SECTION_NODE:o=t.createCDATASection(e.data);break;case ie.COMMENT_NODE:o=t.createComment(e.textContent||"");break;case ie.DOCUMENT_FRAGMENT_NODE:o=r.attachShadow({mode:"open"});break;default:return null}let i=n.getMeta(e);return t instanceof it&&(i||(i=go(o,t.unserializedId),n.add(e,i)),t.mirror.add(o,Object.assign({},i))),o}function pa(e,t=function(){return new Xs}(),n=new it){return function r(o,i){const s=mo(o,n,t,i);if(s!==null)if((i==null?void 0:i.nodeName)!=="IFRAME"&&o.nodeType!==ie.DOCUMENT_FRAGMENT_NODE&&(i==null||i.appendChild(s),s.parentNode=i,s.parentElement=i),o.nodeName==="IFRAME"){const a=o.contentDocument;a&&r(a,s)}else o.nodeType!==ie.DOCUMENT_NODE&&o.nodeType!==ie.ELEMENT_NODE&&o.nodeType!==ie.DOCUMENT_FRAGMENT_NODE||(o.nodeType===ie.ELEMENT_NODE&&o.shadowRoot&&r(o.shadowRoot,s),o.childNodes.forEach(a=>r(a,s)))}(e,null),n}class ma{constructor(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}getId(t){var n;if(!t)return-1;const r=(n=this.getMeta(t))===null||n===void 0?void 0:n.id;return r??-1}getNode(t){return this.idNodeMap.get(t)||null}getIds(){return Array.from(this.idNodeMap.keys())}getMeta(t){return this.nodeMetaMap.get(t)||null}removeNodeFromMap(t){const n=this.getId(t);this.idNodeMap.delete(n),t.childNodes&&t.childNodes.forEach(r=>this.removeNodeFromMap(r))}has(t){return this.idNodeMap.has(t)}hasNode(t){return this.nodeMetaMap.has(t)}add(t,n){const r=n.id;this.idNodeMap.set(r,t),this.nodeMetaMap.set(t,n)}replace(t,n){const r=this.getNode(t);if(r){const o=this.nodeMetaMap.get(r);o&&this.nodeMetaMap.set(n,o)}this.idNodeMap.set(t,n)}reset(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}}function go(e,t){switch(e.RRNodeType){case Z.Document:return{id:t,type:e.RRNodeType,childNodes:[]};case Z.DocumentType:{const n=e;return{id:t,type:e.RRNodeType,name:n.name,publicId:n.publicId,systemId:n.systemId}}case Z.Element:return{id:t,type:e.RRNodeType,tagName:e.tagName.toLowerCase(),attributes:{},childNodes:[]};case Z.Text:case Z.Comment:return{id:t,type:e.RRNodeType,textContent:e.textContent||""};case Z.CDATA:return{id:t,type:e.RRNodeType,textContent:""}}}var Ce=Uint8Array,Be=Uint16Array,Mn=Uint32Array,fo=new Ce([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),yo=new Ce([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),ga=new Ce([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Io=function(e,t){for(var n=new Be(31),r=0;r<31;++r)n[r]=t+=1<<e[r-1];var o=new Mn(n[30]);for(r=1;r<30;++r)for(var i=n[r];i<n[r+1];++i)o[i]=i-n[r]<<5|r;return[n,o]},Co=Io(fo,2),vo=Co[0],fa=Co[1];vo[28]=258,fa[258]=28;for(var ya=Io(yo,0)[0],kn=new Be(32768),oe=0;oe<32768;++oe){var Ye=(43690&oe)>>>1|(21845&oe)<<1;Ye=(61680&(Ye=(52428&Ye)>>>2|(13107&Ye)<<2))>>>4|(3855&Ye)<<4,kn[oe]=((65280&Ye)>>>8|(255&Ye)<<8)>>>1}var St=function(e,t,n){for(var r=e.length,o=0,i=new Be(t);o<r;++o)++i[e[o]-1];var s,a=new Be(t);for(o=0;o<t;++o)a[o]=a[o-1]+i[o-1]<<1;if(n){s=new Be(1<<t);var l=15-t;for(o=0;o<r;++o)if(e[o])for(var c=o<<4|e[o],d=t-e[o],u=a[e[o]-1]++<<d,p=u|(1<<d)-1;u<=p;++u)s[kn[u]>>>l]=c}else for(s=new Be(r),o=0;o<r;++o)s[o]=kn[a[e[o]-1]++]>>>15-e[o];return s},At=new Ce(288);for(oe=0;oe<144;++oe)At[oe]=8;for(oe=144;oe<256;++oe)At[oe]=9;for(oe=256;oe<280;++oe)At[oe]=7;for(oe=280;oe<288;++oe)At[oe]=8;var bo=new Ce(32);for(oe=0;oe<32;++oe)bo[oe]=5;var Ia=St(At,9,1),Ca=St(bo,5,1),Dn=function(e){for(var t=e[0],n=1;n<e.length;++n)e[n]>t&&(t=e[n]);return t},Ae=function(e,t,n){var r=t/8>>0;return(e[r]|e[r+1]<<8)>>>(7&t)&n},Fn=function(e,t){var n=t/8>>0;return(e[n]|e[n+1]<<8|e[n+2]<<16)>>>(7&t)},wo=function(e,t,n){(t==null||t<0)&&(t=0),(n==null||n>e.length)&&(n=e.length);var r=new(e instanceof Be?Be:e instanceof Mn?Mn:Ce)(n-t);return r.set(e.subarray(t,n)),r};function va(e,t){return function(n,r,o){var i=n.length,s=!r||o,a=!o||o.i;o||(o={}),r||(r=new Ce(3*i));var l,c=function(Y){var he=r.length;if(Y>he){var $=new Ce(Math.max(2*he,Y));$.set(r),r=$}},d=o.f||0,u=o.p||0,p=o.b||0,g=o.l,h=o.d,m=o.m,I=o.n,y=8*i;do{if(!g){o.f=d=Ae(n,u,1);var f=Ae(n,u+1,3);if(u+=3,!f){var w=n[(T=((l=u)/8>>0)+(7&l&&1)+4)-4]|n[T-3]<<8,A=T+w;if(A>i){if(a)throw"unexpected EOF";break}s&&c(p+w),r.set(n.subarray(T,A),p),o.b=p+=w,o.p=u=8*A;continue}if(f==1)g=Ia,h=Ca,m=9,I=5;else{if(f!=2)throw"invalid block type";var L=Ae(n,u,31)+257,O=Ae(n,u+10,15)+4,W=L+Ae(n,u+5,31)+1;u+=14;for(var k=new Ce(W),v=new Ce(19),E=0;E<O;++E)v[ga[E]]=Ae(n,u+3*E,7);u+=3*O;var C=Dn(v),b=(1<<C)-1;if(!a&&u+W*(C+7)>y)break;var M=St(v,C,1);for(E=0;E<W;){var T,V=M[Ae(n,u,b)];if(u+=15&V,(T=V>>>4)<16)k[E++]=T;else{var x=0,S=0;for(T==16?(S=3+Ae(n,u,3),u+=2,x=k[E-1]):T==17?(S=3+Ae(n,u,7),u+=3):T==18&&(S=11+Ae(n,u,127),u+=7);S--;)k[E++]=x}}var U=k.subarray(0,L),F=k.subarray(L);m=Dn(U),I=Dn(F),g=St(U,m,1),h=St(F,I,1)}if(u>y)throw"unexpected EOF"}s&&c(p+131072);for(var G=(1<<m)-1,q=(1<<I)-1,j=m+I+18;a||u+j<y;){var J=(x=g[Fn(n,u)&G])>>>4;if((u+=15&x)>y)throw"unexpected EOF";if(!x)throw"invalid length/literal";if(J<256)r[p++]=J;else{if(J==256){g=null;break}var N=J-254;if(J>264){var _=fo[E=J-257];N=Ae(n,u,(1<<_)-1)+vo[E],u+=_}var R=h[Fn(n,u)&q],ne=R>>>4;if(!R)throw"invalid distance";if(u+=15&R,F=ya[ne],ne>3&&(_=yo[ne],F+=Fn(n,u)&(1<<_)-1,u+=_),u>y)throw"unexpected EOF";s&&c(p+131072);for(var D=p+N;p<D;p+=4)r[p]=r[p-F],r[p+1]=r[p+1-F],r[p+2]=r[p+2-F],r[p+3]=r[p+3-F];p=D}}o.l=g,o.p=u,o.b=p,g&&(d=1,o.m=m,o.d=h,o.n=I)}while(!d);return p==r.length?r:wo(r,0,p)}((function(n){if((15&n[0])!=8||n[0]>>>4>7||(n[0]<<8|n[1])%31)throw"invalid zlib data";if(32&n[1])throw"invalid zlib data: preset dictionaries not supported"}(e),e.subarray(2,-4)),t)}const ba=e=>{if(typeof e!="string")return e;try{const t=JSON.parse(e);if(t.timestamp)return t}catch{}try{const t=JSON.parse(function(n,r){var o="";if(!r&&typeof TextDecoder<"u")return new TextDecoder().decode(n);for(var i=0;i<n.length;){var s=n[i++];s<128||r?o+=String.fromCharCode(s):s<224?o+=String.fromCharCode((31&s)<<6|63&n[i++]):s<240?o+=String.fromCharCode((15&s)<<12|(63&n[i++])<<6|63&n[i++]):(s=((15&s)<<18|(63&n[i++])<<12|(63&n[i++])<<6|63&n[i++])-65536,o+=String.fromCharCode(55296|s>>10,56320|1023&s))}return o}(va(function(n,r){var o=n.length;if(!r&&typeof TextEncoder<"u")return new TextEncoder().encode(n);for(var i=new Ce(n.length+(n.length>>>1)),s=0,a=function(u){i[s++]=u},l=0;l<o;++l){if(s+5>i.length){var c=new Ce(s+8+(o-l<<1));c.set(i),i=c}var d=n.charCodeAt(l);d<128||r?a(d):d<2048?(a(192|d>>>6),a(128|63&d)):d>55295&&d<57344?(a(240|(d=65536+(1047552&d)|1023&n.charCodeAt(++l))>>>18),a(128|d>>>12&63),a(128|d>>>6&63),a(128|63&d)):(a(224|d>>>12),a(128|d>>>6&63),a(128|63&d))}return wo(i,0,s)}(e,!0))));if(t.v==="v1")return t;throw new Error(`These events were packed with packer ${t.v} which is incompatible with current packer v1.`)}catch(t){throw console.error(t),new Error("Unknown data format.")}};function So(e){return{all:e=e||new Map,on:function(t,n){var r=e.get(t);r?r.push(n):e.set(t,[n])},off:function(t,n){var r=e.get(t);r&&(n?r.splice(r.indexOf(n)>>>0,1):e.set(t,[]))},emit:function(t,n){var r=e.get(t);r&&r.slice().map(function(o){o(n)}),(r=e.get("*"))&&r.slice().map(function(o){o(t,n)})}}}var st,wa=Object.freeze({__proto__:null,default:So});function Sa(e=window,t=document){if("scrollBehavior"in t.documentElement.style&&e.__forceSmoothScrollPolyfill__!==!0)return;const n=e.HTMLElement||e.Element,r={scroll:e.scroll||e.scrollTo,scrollBy:e.scrollBy,elementScroll:n.prototype.scroll||a,scrollIntoView:n.prototype.scrollIntoView},o=e.performance&&e.performance.now?e.performance.now.bind(e.performance):Date.now,i=(s=e.navigator.userAgent,new RegExp(["MSIE ","Trident/","Edge/"].join("|")).test(s)?1:0);var s;function a(m,I){this.scrollLeft=m,this.scrollTop=I}function l(m){if(m===null||typeof m!="object"||m.behavior===void 0||m.behavior==="auto"||m.behavior==="instant")return!0;if(typeof m=="object"&&m.behavior==="smooth")return!1;throw new TypeError("behavior member of ScrollOptions "+m.behavior+" is not a valid value for enumeration ScrollBehavior.")}function c(m,I){return I==="Y"?m.clientHeight+i<m.scrollHeight:I==="X"?m.clientWidth+i<m.scrollWidth:void 0}function d(m,I){const y=e.getComputedStyle(m,null)["overflow"+I];return y==="auto"||y==="scroll"}function u(m){const I=c(m,"Y")&&d(m,"Y"),y=c(m,"X")&&d(m,"X");return I||y}function p(m){for(;m!==t.body&&u(m)===!1;)m=m.parentNode||m.host;return m}function g(m){let I,y,f,w=(o()-m.startTime)/468;var A;w=w>1?1:w,A=w,I=.5*(1-Math.cos(Math.PI*A)),y=m.startX+(m.x-m.startX)*I,f=m.startY+(m.y-m.startY)*I,m.method.call(m.scrollable,y,f),y===m.x&&f===m.y||e.requestAnimationFrame(g.bind(e,m))}function h(m,I,y){let f,w,A,L;const O=o();m===t.body?(f=e,w=e.scrollX||e.pageXOffset,A=e.scrollY||e.pageYOffset,L=r.scroll):(f=m,w=m.scrollLeft,A=m.scrollTop,L=a),g({scrollable:f,method:L,startTime:O,startX:w,startY:A,x:I,y})}e.scroll=e.scrollTo=function(){arguments[0]!==void 0&&(l(arguments[0])!==!0?h.call(e,t.body,arguments[0].left!==void 0?~~arguments[0].left:e.scrollX||e.pageXOffset,arguments[0].top!==void 0?~~arguments[0].top:e.scrollY||e.pageYOffset):r.scroll.call(e,arguments[0].left!==void 0?arguments[0].left:typeof arguments[0]!="object"?arguments[0]:e.scrollX||e.pageXOffset,arguments[0].top!==void 0?arguments[0].top:arguments[1]!==void 0?arguments[1]:e.scrollY||e.pageYOffset))},e.scrollBy=function(){arguments[0]!==void 0&&(l(arguments[0])?r.scrollBy.call(e,arguments[0].left!==void 0?arguments[0].left:typeof arguments[0]!="object"?arguments[0]:0,arguments[0].top!==void 0?arguments[0].top:arguments[1]!==void 0?arguments[1]:0):h.call(e,t.body,~~arguments[0].left+(e.scrollX||e.pageXOffset),~~arguments[0].top+(e.scrollY||e.pageYOffset)))},n.prototype.scroll=n.prototype.scrollTo=function(){if(arguments[0]===void 0)return;if(l(arguments[0])===!0){if(typeof arguments[0]=="number"&&arguments[1]===void 0)throw new SyntaxError("Value could not be converted");return void r.elementScroll.call(this,arguments[0].left!==void 0?~~arguments[0].left:typeof arguments[0]!="object"?~~arguments[0]:this.scrollLeft,arguments[0].top!==void 0?~~arguments[0].top:arguments[1]!==void 0?~~arguments[1]:this.scrollTop)}const m=arguments[0].left,I=arguments[0].top;h.call(this,this,m===void 0?this.scrollLeft:~~m,I===void 0?this.scrollTop:~~I)},n.prototype.scrollBy=function(){arguments[0]!==void 0&&(l(arguments[0])!==!0?this.scroll({left:~~arguments[0].left+this.scrollLeft,top:~~arguments[0].top+this.scrollTop,behavior:arguments[0].behavior}):r.elementScroll.call(this,arguments[0].left!==void 0?~~arguments[0].left+this.scrollLeft:~~arguments[0]+this.scrollLeft,arguments[0].top!==void 0?~~arguments[0].top+this.scrollTop:~~arguments[1]+this.scrollTop))},n.prototype.scrollIntoView=function(){if(l(arguments[0])===!0)return void r.scrollIntoView.call(this,arguments[0]===void 0||arguments[0]);const m=p(this),I=m.getBoundingClientRect(),y=this.getBoundingClientRect();m!==t.body?(h.call(this,m,m.scrollLeft+y.left-I.left,m.scrollTop+y.top-I.top),e.getComputedStyle(m).position!=="fixed"&&e.scrollBy({left:I.left,top:I.top,behavior:"smooth"})):e.scrollBy({left:y.left,top:y.top,behavior:"smooth"})}}class Aa{constructor(t=[],n){this.timeOffset=0,this.raf=null,this.actions=t,this.speed=n.speed,this.liveMode=n.liveMode}addAction(t){if(!this.actions.length||this.actions[this.actions.length-1].delay<=t.delay)return void this.actions.push(t);const n=this.findActionIndex(t);this.actions.splice(n,0,t)}start(){this.timeOffset=0;let t=performance.now();const n=()=>{const r=performance.now();for(this.timeOffset+=(r-t)*this.speed,t=r;this.actions.length;){const o=this.actions[0];if(!(this.timeOffset>=o.delay))break;this.actions.shift(),o.doAction()}(this.actions.length>0||this.liveMode)&&(this.raf=requestAnimationFrame(n))};this.raf=requestAnimationFrame(n)}clear(){this.raf&&(cancelAnimationFrame(this.raf),this.raf=null),this.actions.length=0}setSpeed(t){this.speed=t}toggleLiveMode(t){this.liveMode=t}isActive(){return this.raf!==null}findActionIndex(t){let n=0,r=this.actions.length-1;for(;n<=r;){const o=Math.floor((n+r)/2);if(this.actions[o].delay<t.delay)n=o+1;else{if(!(this.actions[o].delay>t.delay))return o+1;r=o-1}}return n}}function Ao(e,t){if(e.type===re.IncrementalSnapshot&&e.data.source===Q.MouseMove&&e.data.positions&&e.data.positions.length){const n=e.data.positions[0].timeOffset,r=e.timestamp+n;return e.delay=r-t,r-t}return e.delay=e.timestamp-t,e.delay}/*! *****************************************************************************
  Copyright (c) Microsoft Corporation.

  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.

  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** */function Eo(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(t===void 0||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(a){o={error:a}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s}(function(e){e[e.NotStarted=0]="NotStarted",e[e.Running=1]="Running",e[e.Stopped=2]="Stopped"})(st||(st={}));var No={type:"xstate.init"};function xn(e){return e===void 0?[]:[].concat(e)}function at(e){return{type:"xstate.assign",assignment:e}}function To(e,t){return typeof(e=typeof e=="string"&&t&&t[e]?t[e]:e)=="string"?{type:e}:typeof e=="function"?{type:e.name,exec:e}:e}function Qt(e){return function(t){return e===t}}function Ro(e){return typeof e=="string"?{type:e}:e}function Mo(e,t){return{value:e,context:t,actions:[],changed:!1,matches:Qt(e)}}function ko(e,t,n){var r=t,o=!1;return[e.filter(function(i){if(i.type==="xstate.assign"){o=!0;var s=Object.assign({},r);return typeof i.assignment=="function"?s=i.assignment(r,n):Object.keys(i.assignment).forEach(function(a){s[a]=typeof i.assignment[a]=="function"?i.assignment[a](r,n):i.assignment[a]}),r=s,!1}return!0}),r,o]}function Do(e,t){t===void 0&&(t={});var n=Eo(ko(xn(e.states[e.initial].entry).map(function(s){return To(s,t.actions)}),e.context,No),2),r=n[0],o=n[1],i={config:e,_options:t,initialState:{value:e.initial,actions:r,context:o,matches:Qt(e.initial)},transition:function(s,a){var l,c,d=typeof s=="string"?{value:s,context:e.context}:s,u=d.value,p=d.context,g=Ro(a),h=e.states[u];if(h.on){var m=xn(h.on[g.type]);try{for(var I=function(S){var U=typeof Symbol=="function"&&Symbol.iterator,F=U&&S[U],G=0;if(F)return F.call(S);if(S&&typeof S.length=="number")return{next:function(){return S&&G>=S.length&&(S=void 0),{value:S&&S[G++],done:!S}}};throw new TypeError(U?"Object is not iterable.":"Symbol.iterator is not defined.")}(m),y=I.next();!y.done;y=I.next()){var f=y.value;if(f===void 0)return Mo(u,p);var w=typeof f=="string"?{target:f}:f,A=w.target,L=w.actions,O=L===void 0?[]:L,W=w.cond,k=W===void 0?function(){return!0}:W,v=A===void 0,E=A??u,C=e.states[E];if(k(p,g)){var b=Eo(ko((v?xn(O):[].concat(h.exit,O,C.entry).filter(function(S){return S})).map(function(S){return To(S,i._options.actions)}),p,g),3),M=b[0],T=b[1],V=b[2],x=A??u;return{value:x,context:T,actions:M,changed:A!==u||M.length>0||V,matches:Qt(x)}}}}catch(S){l={error:S}}finally{try{y&&!y.done&&(c=I.return)&&c.call(I)}finally{if(l)throw l.error}}}return Mo(u,p)}};return i}var Fo=function(e,t){return e.actions.forEach(function(n){var r=n.exec;return r&&r(e.context,t)})};function xo(e){var t=e.initialState,n=st.NotStarted,r=new Set,o={_machine:e,send:function(i){n===st.Running&&(t=e.transition(t,i),Fo(t,Ro(i)),r.forEach(function(s){return s(t)}))},subscribe:function(i){return r.add(i),i(t),{unsubscribe:function(){return r.delete(i)}}},start:function(i){if(i){var s=typeof i=="object"?i:{context:e.config.context,value:i};t={value:s.value,actions:[],context:s.context,matches:Qt(s.value)}}return n=st.Running,Fo(t,No),o},stop:function(){return n=st.Stopped,r.clear(),o},get state(){return t},get status(){return n}};return o}function Ea(e,{getCastFn:t,applyEventsSynchronously:n,emitter:r}){const o=Do({id:"player",context:e,initial:"paused",states:{playing:{on:{PAUSE:{target:"paused",actions:["pause"]},CAST_EVENT:{target:"playing",actions:"castEvent"},END:{target:"paused",actions:["resetLastPlayedEvent","pause"]},ADD_EVENT:{target:"playing",actions:["addEvent"]}}},paused:{on:{PLAY:{target:"playing",actions:["recordTimeOffset","play"]},CAST_EVENT:{target:"paused",actions:"castEvent"},TO_LIVE:{target:"live",actions:["startLive"]},ADD_EVENT:{target:"paused",actions:["addEvent"]}}},live:{on:{ADD_EVENT:{target:"live",actions:["addEvent"]},CAST_EVENT:{target:"live",actions:["castEvent"]}}}}},{actions:{castEvent:at({lastPlayedEvent:(i,s)=>s.type==="CAST_EVENT"?s.payload.event:i.lastPlayedEvent}),recordTimeOffset:at((i,s)=>{let a=i.timeOffset;return"payload"in s&&"timeOffset"in s.payload&&(a=s.payload.timeOffset),Object.assign(Object.assign({},i),{timeOffset:a,baselineTime:i.events[0].timestamp+a})}),play(i){var s;const{timer:a,events:l,baselineTime:c,lastPlayedEvent:d}=i;a.clear();for(const h of l)Ao(h,c);const u=function(h,m){for(let I=h.length-1;I>=0;I--){const y=h[I];if(y.type===re.Meta&&y.timestamp<=m)return h.slice(I)}return h}(l,c);let p=d==null?void 0:d.timestamp;(d==null?void 0:d.type)===re.IncrementalSnapshot&&d.data.source===Q.MouseMove&&(p=d.timestamp+((s=d.data.positions[0])===null||s===void 0?void 0:s.timeOffset)),c<(p||0)&&r.emit(X.PlayBack);const g=new Array;for(const h of u)if(!(p&&p<c&&(h.timestamp<=p||h===d)))if(h.timestamp<c)g.push(h);else{const m=t(h,!1);a.addAction({doAction:()=>{m()},delay:h.delay})}n(g),r.emit(X.Flush),a.start()},pause(i){i.timer.clear()},resetLastPlayedEvent:at(i=>Object.assign(Object.assign({},i),{lastPlayedEvent:null})),startLive:at({baselineTime:(i,s)=>(i.timer.toggleLiveMode(!0),i.timer.start(),s.type==="TO_LIVE"&&s.payload.baselineTime?s.payload.baselineTime:Date.now())}),addEvent:at((i,s)=>{const{baselineTime:a,timer:l,events:c}=i;if(s.type==="ADD_EVENT"){const{event:d}=s.payload;Ao(d,a);let u=c.length-1;if(!c[u]||c[u].timestamp<=d.timestamp)c.push(d);else{let h=-1,m=0;for(;m<=u;){const I=Math.floor((m+u)/2);c[I].timestamp<=d.timestamp?m=I+1:u=I-1}h===-1&&(h=m),c.splice(h,0,d)}const p=d.timestamp<a,g=t(d,p);p?g():l.isActive()&&l.addAction({doAction:()=>{g()},delay:d.delay})}return Object.assign(Object.assign({},i),{events:c})})}});return xo(o)}const Lo=new Map;function Oo(e,t){let n=Lo.get(e);return n||(n=new Map,Lo.set(e,n)),n.has(t)||n.set(t,[]),n.get(t)}function Pe(e,t,n){return r=>Ke(this,void 0,void 0,function*(){if(r&&typeof r=="object"&&"rr_type"in r){if(n&&(n.isUnchanged=!1),r.rr_type==="ImageBitmap"&&"args"in r){const o=yield Pe(e,t,n)(r.args);return yield createImageBitmap.apply(null,o)}if("index"in r){if(n||t===null)return r;const{rr_type:o,index:i}=r;return Oo(t,o)[i]}if("args"in r){const{rr_type:o,args:i}=r;return new window[o](...yield Promise.all(i.map(Pe(e,t,n))))}if("base64"in r)return function(o){var i,s,a,l,c,d=.75*o.length,u=o.length,p=0;o[o.length-1]==="="&&(d--,o[o.length-2]==="="&&d--);var g=new ArrayBuffer(d),h=new Uint8Array(g);for(i=0;i<u;i+=4)s=bt[o.charCodeAt(i)],a=bt[o.charCodeAt(i+1)],l=bt[o.charCodeAt(i+2)],c=bt[o.charCodeAt(i+3)],h[p++]=s<<2|a>>4,h[p++]=(15&a)<<4|l>>2,h[p++]=(3&l)<<6|63&c;return g}(r.base64);if("src"in r){const o=e.get(r.src);if(o)return o;{const i=new Image;return i.src=r.src,e.set(r.src,i),i}}if("data"in r&&r.rr_type==="Blob"){const o=yield Promise.all(r.data.map(Pe(e,t,n)));return new Blob(o,{type:r.type})}}else if(Array.isArray(r))return yield Promise.all(r.map(Pe(e,t,n)));return r})}const Na=["WebGLActiveInfo","WebGLBuffer","WebGLFramebuffer","WebGLProgram","WebGLRenderbuffer","WebGLShader","WebGLShaderPrecisionFormat","WebGLTexture","WebGLUniformLocation","WebGLVertexArrayObject"];function Ta({mutation:e,target:t,type:n,imageMap:r,errorHandler:o}){return Ke(this,void 0,void 0,function*(){try{const i=function(l,c){try{return c===zt.WebGL?l.getContext("webgl")||l.getContext("experimental-webgl"):l.getContext("webgl2")}catch{return null}}(t,n);if(!i)return;if(e.setter)return void(i[e.property]=e.args[0]);const s=i[e.property],a=yield Promise.all(e.args.map(Pe(r,i)));(function(l,c){if(!(c!=null&&c.constructor))return;const{name:d}=c.constructor;if(!Na.includes(d))return;const u=Oo(l,d);u.includes(c)||u.push(c)})(i,s.apply(i,a))}catch(i){o(e,i)}})}function Ra({event:e,mutation:t,target:n,imageMap:r,errorHandler:o}){return Ke(this,void 0,void 0,function*(){try{const i=n.getContext("2d");if(t.setter)return void(i[t.property]=t.args[0]);const s=i[t.property];if(t.property==="drawImage"&&typeof t.args[0]=="string")r.get(e),s.apply(i,t.args);else{const a=yield Promise.all(t.args.map(Pe(r,i)));s.apply(i,a)}}catch(i){o(t,i)}})}function Wo({event:e,mutation:t,target:n,imageMap:r,canvasEventMap:o,errorHandler:i}){return Ke(this,void 0,void 0,function*(){try{const s=o.get(e)||t,a="commands"in s?s.commands:[s];if([zt.WebGL,zt.WebGL2].includes(t.type)){for(let l=0;l<a.length;l++){const c=a[l];yield Ta({mutation:c,type:t.type,target:n,imageMap:r,errorHandler:i})}return}for(let l=0;l<a.length;l++){const c=a[l];yield Ra({event:e,mutation:c,target:n,imageMap:r,errorHandler:i})}}catch(s){i(t,s)}})}const Ma=So||wa,Ln={duration:500,lineCap:"round",lineWidth:3,strokeStyle:"red"};function Bo(e){return e.type==re.IncrementalSnapshot&&(e.data.source==Q.TouchMove||e.data.source==Q.MouseInteraction&&e.data.type==ge.TouchStart)}class ka{constructor(t,n){if(this.usingVirtualDom=!1,this.virtualDom=new it,this.mouseTail=null,this.tailPositions=[],this.emitter=Ma(),this.legacy_missingNodeRetryMap={},this.cache=Jr(),this.imageMap=new Map,this.canvasEventMap=new Map,this.mirror=Gs(),this.styleMirror=new Hs,this.firstFullSnapshot=null,this.newDocumentQueue=[],this.mousePos=null,this.touchActive=null,this.lastSelectionData=null,this.constructedStyleMutations=[],this.adoptedStyleSheets=[],this.handleResize=a=>{this.iframe.style.display="inherit";for(const l of[this.mouseTail,this.iframe])l&&(l.setAttribute("width",String(a.width)),l.setAttribute("height",String(a.height)))},this.applyEventsSynchronously=a=>{for(const l of a){switch(l.type){case re.DomContentLoaded:case re.Load:case re.Custom:continue;case re.FullSnapshot:case re.Meta:case re.Plugin:case re.IncrementalSnapshot:}this.getCastFn(l,!0)()}this.touchActive===!0?this.mouse.classList.add("touch-active"):this.touchActive===!1&&this.mouse.classList.remove("touch-active"),this.touchActive=null},this.getCastFn=(a,l=!1)=>{let c;switch(a.type){case re.DomContentLoaded:case re.Load:break;case re.Custom:c=()=>{this.emitter.emit(X.CustomEvent,a)};break;case re.Meta:c=()=>this.emitter.emit(X.Resize,{width:a.data.width,height:a.data.height});break;case re.FullSnapshot:c=()=>{var d;if(this.firstFullSnapshot){if(this.firstFullSnapshot===a)return void(this.firstFullSnapshot=!0)}else this.firstFullSnapshot=!0;this.rebuildFullSnapshot(a,l),(d=this.iframe.contentWindow)===null||d===void 0||d.scrollTo(a.data.initialOffset),this.styleMirror.reset()};break;case re.IncrementalSnapshot:c=()=>{if(this.applyIncremental(a,l),!l&&(a===this.nextUserInteractionEvent&&(this.nextUserInteractionEvent=null,this.backToNormal()),this.config.skipInactive&&!this.nextUserInteractionEvent)){for(const d of this.service.state.context.events)if(!(d.timestamp<=a.timestamp)&&this.isUserInteraction(d)){d.delay-a.delay>1e4*this.speedService.state.context.timer.speed&&(this.nextUserInteractionEvent=d);break}if(this.nextUserInteractionEvent){const d=this.nextUserInteractionEvent.delay-a.delay,u={speed:Math.min(Math.round(d/5e3),this.config.maxSpeed)};this.speedService.send({type:"FAST_FORWARD",payload:u}),this.emitter.emit(X.SkipStart,u)}}}}return()=>{c&&c();for(const u of this.config.plugins||[])u.handler&&u.handler(a,l,{replayer:this});this.service.send({type:"CAST_EVENT",payload:{event:a}});const d=this.service.state.context.events.length-1;if(a===this.service.state.context.events[d]){const u=()=>{d<this.service.state.context.events.length-1||(this.backToNormal(),this.service.send("END"),this.emitter.emit(X.Finish))};a.type===re.IncrementalSnapshot&&a.data.source===Q.MouseMove&&a.data.positions.length?setTimeout(()=>{u()},Math.max(0,50-a.data.positions[0].timeOffset)):u()}this.emitter.emit(X.EventCast,a)}},!(n!=null&&n.liveMode)&&t.length<2)throw new Error("Replayer need at least 2 events.");const r={speed:1,maxSpeed:360,root:document.body,loadTimeout:0,skipInactive:!1,showWarning:!0,showDebug:!1,blockClass:"rr-block",liveMode:!1,insertStyleRules:[],triggerFocus:!0,UNSAFE_replayCanvas:!1,pauseAnimation:!0,mouseTail:Ln,useVirtualDom:!0};this.config=Object.assign({},r,n),this.handleResize=this.handleResize.bind(this),this.getCastFn=this.getCastFn.bind(this),this.applyEventsSynchronously=this.applyEventsSynchronously.bind(this),this.emitter.on(X.Resize,this.handleResize),this.setupDom();for(const a of this.config.plugins||[])a.getMirror&&a.getMirror({nodeMirror:this.mirror});this.emitter.on(X.Flush,()=>{if(this.usingVirtualDom){const a={mirror:this.mirror,applyCanvas:(l,c,d)=>{Wo({event:l,mutation:c,target:d,imageMap:this.imageMap,canvasEventMap:this.canvasEventMap,errorHandler:this.warnCanvasMutationFailed.bind(this)})},applyInput:this.applyInput.bind(this),applyScroll:this.applyScroll.bind(this),applyStyleSheetMutation:(l,c)=>{l.source===Q.StyleSheetRule?this.applyStyleSheetRule(l,c):l.source===Q.StyleDeclaration&&this.applyStyleDeclaration(l,c)}};if(this.iframe.contentDocument&&Re(this.iframe.contentDocument,this.virtualDom,a,this.virtualDom.mirror),this.virtualDom.destroyTree(),this.usingVirtualDom=!1,Object.keys(this.legacy_missingNodeRetryMap).length)for(const l in this.legacy_missingNodeRetryMap)try{const c=this.legacy_missingNodeRetryMap[l],d=Rn(c.node,this.mirror,this.virtualDom.mirror);Re(d,c.node,a,this.virtualDom.mirror),c.node=d}catch(c){this.config.showWarning&&console.warn(c)}this.constructedStyleMutations.forEach(l=>{this.applyStyleSheetMutation(l)}),this.constructedStyleMutations=[],this.adoptedStyleSheets.forEach(l=>{this.applyAdoptedStyleSheet(l)}),this.adoptedStyleSheets=[]}this.mousePos&&(this.moveAndHover(this.mousePos.x,this.mousePos.y,this.mousePos.id,!0,this.mousePos.debugData),this.mousePos=null),this.lastSelectionData&&(this.applySelection(this.lastSelectionData),this.lastSelectionData=null)}),this.emitter.on(X.PlayBack,()=>{this.firstFullSnapshot=null,this.mirror.reset(),this.styleMirror.reset()});const o=new Aa([],{speed:this.config.speed,liveMode:this.config.liveMode});this.service=Ea({events:t.map(a=>n&&n.unpackFn?n.unpackFn(a):a).sort((a,l)=>a.timestamp-l.timestamp),timer:o,timeOffset:0,baselineTime:0,lastPlayedEvent:null},{getCastFn:this.getCastFn,applyEventsSynchronously:this.applyEventsSynchronously,emitter:this.emitter}),this.service.start(),this.service.subscribe(a=>{this.emitter.emit(X.StateChange,{player:a})}),this.speedService=xo(Do({id:"speed",context:{normalSpeed:-1,timer:o},initial:"normal",states:{normal:{on:{FAST_FORWARD:{target:"skipping",actions:["recordSpeed","setSpeed"]},SET_SPEED:{target:"normal",actions:["setSpeed"]}}},skipping:{on:{BACK_TO_NORMAL:{target:"normal",actions:["restoreSpeed"]},SET_SPEED:{target:"normal",actions:["setSpeed"]}}}}},{actions:{setSpeed:(a,l)=>{"payload"in l&&a.timer.setSpeed(l.payload.speed)},recordSpeed:at({normalSpeed:a=>a.timer.speed}),restoreSpeed:a=>{a.timer.setSpeed(a.normalSpeed)}}})),this.speedService.start(),this.speedService.subscribe(a=>{this.emitter.emit(X.StateChange,{speed:a})});const i=this.service.state.context.events.find(a=>a.type===re.Meta),s=this.service.state.context.events.find(a=>a.type===re.FullSnapshot);if(i){const{width:a,height:l}=i.data;setTimeout(()=>{this.emitter.emit(X.Resize,{width:a,height:l})},0)}s&&setTimeout(()=>{var a;this.firstFullSnapshot||(this.firstFullSnapshot=s,this.rebuildFullSnapshot(s),(a=this.iframe.contentWindow)===null||a===void 0||a.scrollTo(s.data.initialOffset))},1),this.service.state.context.events.find(Bo)&&this.mouse.classList.add("touch-device")}get timer(){return this.service.state.context.timer}on(t,n){return this.emitter.on(t,n),this}off(t,n){return this.emitter.off(t,n),this}setConfig(t){Object.keys(t).forEach(n=>{t[n],this.config[n]=t[n]}),this.config.skipInactive||this.backToNormal(),t.speed!==void 0&&this.speedService.send({type:"SET_SPEED",payload:{speed:t.speed}}),t.mouseTail!==void 0&&(t.mouseTail===!1?this.mouseTail&&(this.mouseTail.style.display="none"):(this.mouseTail||(this.mouseTail=document.createElement("canvas"),this.mouseTail.width=Number.parseFloat(this.iframe.width),this.mouseTail.height=Number.parseFloat(this.iframe.height),this.mouseTail.classList.add("replayer-mouse-tail"),this.wrapper.insertBefore(this.mouseTail,this.iframe)),this.mouseTail.style.display="inherit"))}getMetaData(){const t=this.service.state.context.events[0],n=this.service.state.context.events[this.service.state.context.events.length-1];return{startTime:t.timestamp,endTime:n.timestamp,totalTime:n.timestamp-t.timestamp}}getCurrentTime(){return this.timer.timeOffset+this.getTimeOffset()}getTimeOffset(){const{baselineTime:t,events:n}=this.service.state.context;return t-n[0].timestamp}getMirror(){return this.mirror}play(t=0){var n,r;this.service.state.matches("paused")||this.service.send({type:"PAUSE"}),this.service.send({type:"PLAY",payload:{timeOffset:t}}),(r=(n=this.iframe.contentDocument)===null||n===void 0?void 0:n.getElementsByTagName("html")[0])===null||r===void 0||r.classList.remove("rrweb-paused"),this.emitter.emit(X.Start)}pause(t){var n,r;t===void 0&&this.service.state.matches("playing")&&this.service.send({type:"PAUSE"}),typeof t=="number"&&(this.play(t),this.service.send({type:"PAUSE"})),(r=(n=this.iframe.contentDocument)===null||n===void 0?void 0:n.getElementsByTagName("html")[0])===null||r===void 0||r.classList.add("rrweb-paused"),this.emitter.emit(X.Pause)}resume(t=0){console.warn("The 'resume' was deprecated in 1.0. Please use 'play' method which has the same interface."),this.play(t),this.emitter.emit(X.Resume)}destroy(){this.pause(),this.config.root.removeChild(this.wrapper),this.emitter.emit(X.Destroy)}startLive(t){this.service.send({type:"TO_LIVE",payload:{baselineTime:t}})}addEvent(t){const n=this.config.unpackFn?this.config.unpackFn(t):t;Bo(n)&&this.mouse.classList.add("touch-device"),Promise.resolve().then(()=>this.service.send({type:"ADD_EVENT",payload:{event:n}}))}enableInteract(){this.iframe.setAttribute("scrolling","auto"),this.iframe.style.pointerEvents="auto"}disableInteract(){this.iframe.setAttribute("scrolling","no"),this.iframe.style.pointerEvents="none"}resetCache(){this.cache=Jr()}setupDom(){this.wrapper=document.createElement("div"),this.wrapper.classList.add("replayer-wrapper"),this.config.root.appendChild(this.wrapper),this.mouse=document.createElement("div"),this.mouse.classList.add("replayer-mouse"),this.wrapper.appendChild(this.mouse),this.config.mouseTail!==!1&&(this.mouseTail=document.createElement("canvas"),this.mouseTail.classList.add("replayer-mouse-tail"),this.mouseTail.style.display="inherit",this.wrapper.appendChild(this.mouseTail)),this.iframe=document.createElement("iframe");const t=["allow-same-origin"];this.config.UNSAFE_replayCanvas&&t.push("allow-scripts"),this.iframe.style.display="none",this.iframe.setAttribute("sandbox",t.join(" ")),this.disableInteract(),this.wrapper.appendChild(this.iframe),this.iframe.contentWindow&&this.iframe.contentDocument&&(Sa(this.iframe.contentWindow,this.iframe.contentDocument),function(n=window){"NodeList"in n&&!n.NodeList.prototype.forEach&&(n.NodeList.prototype.forEach=Array.prototype.forEach),"DOMTokenList"in n&&!n.DOMTokenList.prototype.forEach&&(n.DOMTokenList.prototype.forEach=Array.prototype.forEach),Node.prototype.contains||(Node.prototype.contains=(...r)=>{let o=r[0];if(!(0 in r))throw new TypeError("1 argument is required");do if(this===o)return!0;while(o=o&&o.parentNode);return!1})}(this.iframe.contentWindow))}rebuildFullSnapshot(t,n=!1){if(!this.iframe.contentDocument)return console.warn("Looks like your replayer has been destroyed.");Object.keys(this.legacy_missingNodeRetryMap).length&&console.warn("Found unresolved missing node map",this.legacy_missingNodeRetryMap),this.legacy_missingNodeRetryMap={};const r=[],o=(a,l)=>{this.collectIframeAndAttachDocument(r,a);for(const c of this.config.plugins||[])c.onBuild&&c.onBuild(a,{id:l,replayer:this})};$s(t.data.node,{doc:this.iframe.contentDocument,afterAppend:o,cache:this.cache,mirror:this.mirror}),o(this.iframe.contentDocument,t.data.node.id);for(const{mutationInQueue:a,builtNode:l}of r)this.attachDocumentToIframe(a,l),this.newDocumentQueue=this.newDocumentQueue.filter(c=>c!==a);const{documentElement:i,head:s}=this.iframe.contentDocument;this.insertStyleRules(i,s),this.service.state.matches("playing")||this.iframe.contentDocument.getElementsByTagName("html")[0].classList.add("rrweb-paused"),this.emitter.emit(X.FullsnapshotRebuilded,t),n||this.waitForStylesheetLoad(),this.config.UNSAFE_replayCanvas&&this.preloadAllImages()}insertStyleRules(t,n){var r;const o=(i=this.config.blockClass,[`.${i} { background: currentColor }`,"noscript { display: none !important; }"]).concat(this.config.insertStyleRules);var i;if(this.config.pauseAnimation&&o.push("html.rrweb-paused *, html.rrweb-paused *:before, html.rrweb-paused *:after { animation-play-state: paused !important; }"),this.usingVirtualDom){const s=this.virtualDom.createElement("style");this.virtualDom.mirror.add(s,go(s,this.virtualDom.unserializedId)),t.insertBefore(s,n),s.rules.push({source:Q.StyleSheetRule,adds:o.map((a,l)=>({rule:a,index:l}))})}else{const s=document.createElement("style");t.insertBefore(s,n);for(let a=0;a<o.length;a++)(r=s.sheet)===null||r===void 0||r.insertRule(o[a],a)}}attachDocumentToIframe(t,n){const r=this.usingVirtualDom?this.virtualDom.mirror:this.mirror,o=[],i=(s,a)=>{this.collectIframeAndAttachDocument(o,s);const l=r.getMeta(s);if((l==null?void 0:l.type)===de.Element&&(l==null?void 0:l.tagName.toUpperCase())==="HTML"){const{documentElement:c,head:d}=n.contentDocument;this.insertStyleRules(c,d)}for(const c of this.config.plugins||[])c.onBuild&&c.onBuild(s,{id:a,replayer:this})};Ct(t.node,{doc:n.contentDocument,mirror:r,hackCss:!0,skipChild:!1,afterAppend:i,cache:this.cache}),i(n.contentDocument,t.node.id);for(const{mutationInQueue:s,builtNode:a}of o)this.attachDocumentToIframe(s,a),this.newDocumentQueue=this.newDocumentQueue.filter(l=>l!==s)}collectIframeAndAttachDocument(t,n){if(En(n,this.mirror)){const r=this.newDocumentQueue.find(o=>o.parentId===this.mirror.getId(n));r&&t.push({mutationInQueue:r,builtNode:n})}}waitForStylesheetLoad(){var t;const n=(t=this.iframe.contentDocument)===null||t===void 0?void 0:t.head;if(n){const r=new Set;let o,i=this.service.state;const s=()=>{i=this.service.state};this.emitter.on(X.Start,s),this.emitter.on(X.Pause,s);const a=()=>{this.emitter.off(X.Start,s),this.emitter.off(X.Pause,s)};n.querySelectorAll('link[rel="stylesheet"]').forEach(l=>{l.sheet||(r.add(l),l.addEventListener("load",()=>{r.delete(l),r.size===0&&o!==-1&&(i.matches("playing")&&this.play(this.getCurrentTime()),this.emitter.emit(X.LoadStylesheetEnd),o&&clearTimeout(o),a())}))}),r.size>0&&(this.service.send({type:"PAUSE"}),this.emitter.emit(X.LoadStylesheetStart),o=setTimeout(()=>{i.matches("playing")&&this.play(this.getCurrentTime()),o=-1,a()},this.config.loadTimeout))}}preloadAllImages(){return Ke(this,void 0,void 0,function*(){this.service.state;const t=()=>{this.service.state};this.emitter.on(X.Start,t),this.emitter.on(X.Pause,t);const n=[];for(const r of this.service.state.context.events)r.type===re.IncrementalSnapshot&&r.data.source===Q.CanvasMutation&&(n.push(this.deserializeAndPreloadCanvasEvents(r.data,r)),("commands"in r.data?r.data.commands:[r.data]).forEach(o=>{this.preloadImages(o,r)}));return Promise.all(n)})}preloadImages(t,n){if(t.property==="drawImage"&&typeof t.args[0]=="string"&&!this.imageMap.has(n)){const r=document.createElement("canvas"),o=r.getContext("2d"),i=o==null?void 0:o.createImageData(r.width,r.height);i==null||i.data,JSON.parse(t.args[0]),o==null||o.putImageData(i,0,0)}}deserializeAndPreloadCanvasEvents(t,n){return Ke(this,void 0,void 0,function*(){if(!this.canvasEventMap.has(n)){const r={isUnchanged:!0};if("commands"in t){const o=yield Promise.all(t.commands.map(i=>Ke(this,void 0,void 0,function*(){const s=yield Promise.all(i.args.map(Pe(this.imageMap,null,r)));return Object.assign(Object.assign({},i),{args:s})})));r.isUnchanged===!1&&this.canvasEventMap.set(n,Object.assign(Object.assign({},t),{commands:o}))}else{const o=yield Promise.all(t.args.map(Pe(this.imageMap,null,r)));r.isUnchanged===!1&&this.canvasEventMap.set(n,Object.assign(Object.assign({},t),{args:o}))}}})}applyIncremental(t,n){var r,o,i;const{data:s}=t;switch(s.source){case Q.Mutation:try{this.applyMutation(s,n)}catch(a){this.warn(`Exception in mutation ${a.message||a}`,s)}break;case Q.Drag:case Q.TouchMove:case Q.MouseMove:if(n){const a=s.positions[s.positions.length-1];this.mousePos={x:a.x,y:a.y,id:a.id,debugData:s}}else s.positions.forEach(a=>{const l={doAction:()=>{this.moveAndHover(a.x,a.y,a.id,n,s)},delay:a.timeOffset+t.timestamp-this.service.state.context.baselineTime};this.timer.addAction(l)}),this.timer.addAction({doAction(){},delay:t.delay-((r=s.positions[0])===null||r===void 0?void 0:r.timeOffset)});break;case Q.MouseInteraction:{if(s.id===-1||n)break;const a=new Event(ge[s.type].toLowerCase()),l=this.mirror.getNode(s.id);if(!l)return this.debugNodeNotFound(s,s.id);this.emitter.emit(X.MouseInteraction,{type:s.type,target:l});const{triggerFocus:c}=this.config;switch(s.type){case ge.Blur:"blur"in l&&l.blur();break;case ge.Focus:c&&l.focus&&l.focus({preventScroll:!0});break;case ge.Click:case ge.TouchStart:case ge.TouchEnd:n?(s.type===ge.TouchStart?this.touchActive=!0:s.type===ge.TouchEnd&&(this.touchActive=!1),this.mousePos={x:s.x,y:s.y,id:s.id,debugData:s}):(s.type===ge.TouchStart&&(this.tailPositions.length=0),this.moveAndHover(s.x,s.y,s.id,n,s),s.type===ge.Click?(this.mouse.classList.remove("active"),this.mouse.offsetWidth,this.mouse.classList.add("active")):s.type===ge.TouchStart?(this.mouse.offsetWidth,this.mouse.classList.add("touch-active")):s.type===ge.TouchEnd&&this.mouse.classList.remove("touch-active"));break;case ge.TouchCancel:n?this.touchActive=!1:this.mouse.classList.remove("touch-active");break;default:l.dispatchEvent(a)}break}case Q.Scroll:if(s.id===-1)break;if(this.usingVirtualDom){const a=this.virtualDom.mirror.getNode(s.id);if(!a)return this.debugNodeNotFound(s,s.id);a.scrollData=s;break}this.applyScroll(s,n);break;case Q.ViewportResize:this.emitter.emit(X.Resize,{width:s.width,height:s.height});break;case Q.Input:if(s.id===-1)break;if(this.usingVirtualDom){const a=this.virtualDom.mirror.getNode(s.id);if(!a)return this.debugNodeNotFound(s,s.id);a.inputData=s;break}this.applyInput(s);break;case Q.MediaInteraction:{const a=this.usingVirtualDom?this.virtualDom.mirror.getNode(s.id):this.mirror.getNode(s.id);if(!a)return this.debugNodeNotFound(s,s.id);const l=a;try{s.currentTime&&(l.currentTime=s.currentTime),s.volume&&(l.volume=s.volume),s.muted&&(l.muted=s.muted),s.type===1&&l.pause(),s.type===0&&l.play(),s.type===4&&(l.playbackRate=s.playbackRate)}catch(c){this.config.showWarning&&console.warn(`Failed to replay media interactions: ${c.message||c}`)}break}case Q.StyleSheetRule:case Q.StyleDeclaration:this.usingVirtualDom?s.styleId?this.constructedStyleMutations.push(s):s.id&&((o=this.virtualDom.mirror.getNode(s.id))===null||o===void 0||o.rules.push(s)):this.applyStyleSheetMutation(s);break;case Q.CanvasMutation:if(!this.config.UNSAFE_replayCanvas)return;if(this.usingVirtualDom){const a=this.virtualDom.mirror.getNode(s.id);if(!a)return this.debugNodeNotFound(s,s.id);a.canvasMutations.push({event:t,mutation:s})}else{const a=this.mirror.getNode(s.id);if(!a)return this.debugNodeNotFound(s,s.id);Wo({event:t,mutation:s,target:a,imageMap:this.imageMap,canvasEventMap:this.canvasEventMap,errorHandler:this.warnCanvasMutationFailed.bind(this)})}break;case Q.Font:try{const a=new FontFace(s.family,s.buffer?new Uint8Array(JSON.parse(s.fontSource)):s.fontSource,s.descriptors);(i=this.iframe.contentDocument)===null||i===void 0||i.fonts.add(a)}catch(a){this.config.showWarning&&console.warn(a)}break;case Q.Selection:if(n){this.lastSelectionData=s;break}this.applySelection(s);break;case Q.AdoptedStyleSheet:this.usingVirtualDom?this.adoptedStyleSheets.push(s):this.applyAdoptedStyleSheet(s)}}applyMutation(t,n){if(this.config.useVirtualDom&&!this.usingVirtualDom&&n&&(this.usingVirtualDom=!0,pa(this.iframe.contentDocument,this.mirror,this.virtualDom),Object.keys(this.legacy_missingNodeRetryMap).length))for(const l in this.legacy_missingNodeRetryMap)try{const c=this.legacy_missingNodeRetryMap[l],d=mo(c.node,this.virtualDom,this.mirror);d&&(c.node=d)}catch(c){this.config.showWarning&&console.warn(c)}const r=this.usingVirtualDom?this.virtualDom.mirror:this.mirror;t.removes.forEach(l=>{var c;const d=r.getNode(l.id);if(!d)return t.removes.find(p=>p.id===l.parentId)?void 0:this.warnNodeNotFound(t,l.id);let u=r.getNode(l.parentId);if(!u)return this.warnNodeNotFound(t,l.parentId);if(l.isShadow&&$t(u)&&(u=u.shadowRoot),r.removeNodeFromMap(d),u)try{u.removeChild(d),this.usingVirtualDom&&d.nodeName==="#text"&&u.nodeName==="STYLE"&&((c=u.rules)===null||c===void 0?void 0:c.length)>0&&(u.rules=[])}catch(p){if(!(p instanceof DOMException))throw p;this.warn("parent could not remove child in mutation",u,d,t)}});const o=Object.assign({},this.legacy_missingNodeRetryMap),i=[],s=l=>{var c;if(!this.iframe.contentDocument)return console.warn("Looks like your replayer has been destroyed.");let d=r.getNode(l.parentId);if(!d)return l.node.type===de.Document?this.newDocumentQueue.push(l):i.push(l);l.node.isShadow&&($t(d)||d.attachShadow({mode:"open"}),d=d.shadowRoot);let u=null,p=null;if(l.previousId&&(u=r.getNode(l.previousId)),l.nextId&&(p=r.getNode(l.nextId)),(y=>{let f=null;return y.nextId&&(f=r.getNode(y.nextId)),y.nextId!==null&&y.nextId!==void 0&&y.nextId!==-1&&!f})(l))return i.push(l);if(l.node.rootId&&!r.getNode(l.node.rootId))return;const g=l.node.rootId?r.getNode(l.node.rootId):this.usingVirtualDom?this.virtualDom:this.iframe.contentDocument;if(En(d,r))return void this.attachDocumentToIframe(l,d);const h=(y,f)=>{for(const w of this.config.plugins||[])w.onBuild&&w.onBuild(y,{id:f,replayer:this})},m=Ct(l.node,{doc:g,mirror:r,skipChild:!0,hackCss:!0,cache:this.cache,afterAppend:h});if(l.previousId===-1||l.nextId===-1)return void(o[l.node.id]={node:m,mutation:l});const I=r.getMeta(d);if(I&&I.type===de.Element&&I.tagName==="textarea"&&l.node.type===de.Text){const y=Array.isArray(d.childNodes)?d.childNodes:Array.from(d.childNodes);for(const f of y)f.nodeType===d.TEXT_NODE&&d.removeChild(f)}if(u&&u.nextSibling&&u.nextSibling.parentNode)d.insertBefore(m,u.nextSibling);else if(p&&p.parentNode)d.contains(p)?d.insertBefore(m,p):d.insertBefore(m,null);else{if(d===g)for(;g.firstChild;)g.removeChild(g.firstChild);d.appendChild(m)}if(h(m,l.node.id),this.usingVirtualDom&&m.nodeName==="#text"&&d.nodeName==="STYLE"&&((c=d.rules)===null||c===void 0?void 0:c.length)>0&&(d.rules=[]),En(m,this.mirror)){const y=this.mirror.getId(m),f=this.newDocumentQueue.find(w=>w.parentId===y);f&&(this.attachDocumentToIframe(f,m),this.newDocumentQueue=this.newDocumentQueue.filter(w=>w!==f))}(l.previousId||l.nextId)&&this.legacy_resolveMissingNode(o,d,m,l)};t.adds.forEach(l=>{s(l)});const a=Date.now();for(;i.length;){const l=zs(i);if(i.length=0,Date.now()-a>500){this.warn("Timeout in the loop, please check the resolve tree data:",l);break}for(const c of l)r.getNode(c.value.parentId)?Xr(c,d=>{s(d)}):this.debug("Drop resolve tree since there is no parent for the root node.",c)}Object.keys(o).length&&Object.assign(this.legacy_missingNodeRetryMap,o),function(l){const c=new Set,d=[];for(let u=l.length;u--;){const p=l[u];c.has(p.id)||(d.push(p),c.add(p.id))}return d}(t.texts).forEach(l=>{var c;const d=r.getNode(l.id);if(!d)return t.removes.find(u=>u.id===l.id)?void 0:this.warnNodeNotFound(t,l.id);if(d.textContent=l.value,this.usingVirtualDom){const u=d.parentNode;((c=u==null?void 0:u.rules)===null||c===void 0?void 0:c.length)>0&&(u.rules=[])}}),t.attributes.forEach(l=>{const c=r.getNode(l.id);if(!c)return t.removes.find(d=>d.id===l.id)?void 0:this.warnNodeNotFound(t,l.id);for(const d in l.attributes)if(typeof d=="string"){const u=l.attributes[d];if(u===null)c.removeAttribute(d);else if(typeof u=="string")try{if(d==="_cssText"&&(c.nodeName==="LINK"||c.nodeName==="STYLE"))try{const p=r.getMeta(c);Object.assign(p.attributes,l.attributes);const g=Ct(p,{doc:c.ownerDocument,mirror:r,skipChild:!0,hackCss:!0,cache:this.cache}),h=c.nextSibling,m=c.parentNode;if(g&&m){m.removeChild(c),m.insertBefore(g,h),r.replace(l.id,g);break}}catch{}c.setAttribute(d,u)}catch(p){this.config.showWarning&&console.warn("An error occurred may due to the checkout feature.",p)}else if(d==="style"){const p=u,g=c;for(const h in p)if(p[h]===!1)g.style.removeProperty(h);else if(p[h]instanceof Array){const m=p[h];g.style.setProperty(h,m[0],m[1])}else{const m=p[h];g.style.setProperty(h,m)}}}})}applyScroll(t,n){var r,o;const i=this.mirror.getNode(t.id);if(!i)return this.debugNodeNotFound(t,t.id);const s=this.mirror.getMeta(i);if(i===this.iframe.contentDocument)(r=this.iframe.contentWindow)===null||r===void 0||r.scrollTo({top:t.y,left:t.x,behavior:n?"auto":"smooth"});else if((s==null?void 0:s.type)===de.Document)(o=i.defaultView)===null||o===void 0||o.scrollTo({top:t.y,left:t.x,behavior:n?"auto":"smooth"});else try{i.scrollTo({top:t.y,left:t.x,behavior:n?"auto":"smooth"})}catch{}}applyInput(t){const n=this.mirror.getNode(t.id);if(!n)return this.debugNodeNotFound(t,t.id);try{n.checked=t.isChecked,n.value=t.text}catch{}}applySelection(t){try{const n=new Set,r=t.ranges.map(({start:o,startOffset:i,end:s,endOffset:a})=>{const l=this.mirror.getNode(o),c=this.mirror.getNode(s);if(!l||!c)return;const d=new Range;d.setStart(l,i),d.setEnd(c,a);const u=l.ownerDocument,p=u==null?void 0:u.getSelection();return p&&n.add(p),{range:d,selection:p}});n.forEach(o=>o.removeAllRanges()),r.forEach(o=>{var i;return o&&((i=o.selection)===null||i===void 0?void 0:i.addRange(o.range))})}catch{}}applyStyleSheetMutation(t){var n;let r=null;t.styleId?r=this.styleMirror.getStyle(t.styleId):t.id&&(r=((n=this.mirror.getNode(t.id))===null||n===void 0?void 0:n.sheet)||null),r&&(t.source===Q.StyleSheetRule?this.applyStyleSheetRule(t,r):t.source===Q.StyleDeclaration&&this.applyStyleDeclaration(t,r))}applyStyleSheetRule(t,n){var r,o,i,s;if((r=t.adds)===null||r===void 0||r.forEach(({rule:a,index:l})=>{try{if(Array.isArray(l)){const{positions:c,index:d}=eo(l);vt(n.cssRules,c).insertRule(a,d)}else{const c=l===void 0?void 0:Math.min(l,n.cssRules.length);n==null||n.insertRule(a,c)}}catch{}}),(o=t.removes)===null||o===void 0||o.forEach(({index:a})=>{try{if(Array.isArray(a)){const{positions:l,index:c}=eo(a);vt(n.cssRules,l).deleteRule(c||0)}else n==null||n.deleteRule(a)}catch{}}),t.replace)try{(i=n.replace)===null||i===void 0||i.call(n,t.replace)}catch{}if(t.replaceSync)try{(s=n.replaceSync)===null||s===void 0||s.call(n,t.replaceSync)}catch{}}applyStyleDeclaration(t,n){t.set&&vt(n.rules,t.index).style.setProperty(t.set.property,t.set.value,t.set.priority),t.remove&&vt(n.rules,t.index).style.removeProperty(t.remove.property)}applyAdoptedStyleSheet(t){var n;const r=this.mirror.getNode(t.id);if(!r)return;(n=t.styles)===null||n===void 0||n.forEach(s=>{var a;let l=null,c=null;if($t(r)?c=((a=r.ownerDocument)===null||a===void 0?void 0:a.defaultView)||null:r.nodeName==="#document"&&(c=r.defaultView),c)try{l=new c.CSSStyleSheet,this.styleMirror.add(l,s.styleId),this.applyStyleSheetRule({source:Q.StyleSheetRule,adds:s.rules},l)}catch{}});let o=0;const i=(s,a)=>{const l=a.map(c=>this.styleMirror.getStyle(c)).filter(c=>c!==null);$t(s)?s.shadowRoot.adoptedStyleSheets=l:s.nodeName==="#document"&&(s.adoptedStyleSheets=l),l.length!==a.length&&o<10&&(setTimeout(()=>i(s,a),0+100*o),o++)};i(r,t.styleIds)}legacy_resolveMissingNode(t,n,r,o){const{previousId:i,nextId:s}=o,a=i&&t[i],l=s&&t[s];if(a){const{node:c,mutation:d}=a;n.insertBefore(c,r),delete t[d.node.id],delete this.legacy_missingNodeRetryMap[d.node.id],(d.previousId||d.nextId)&&this.legacy_resolveMissingNode(t,n,c,d)}if(l){const{node:c,mutation:d}=l;n.insertBefore(c,r.nextSibling),delete t[d.node.id],delete this.legacy_missingNodeRetryMap[d.node.id],(d.previousId||d.nextId)&&this.legacy_resolveMissingNode(t,n,c,d)}}moveAndHover(t,n,r,o,i){const s=this.mirror.getNode(r);if(!s)return this.debugNodeNotFound(i,r);const a=qr(s,this.iframe),l=t*a.absoluteScale+a.x,c=n*a.absoluteScale+a.y;this.mouse.style.left=`${l}px`,this.mouse.style.top=`${c}px`,o||this.drawMouseTail({x:l,y:c}),this.hoverElements(s)}drawMouseTail(t){if(!this.mouseTail)return;const{lineCap:n,lineWidth:r,strokeStyle:o,duration:i}=this.config.mouseTail===!0?Ln:Object.assign({},Ln,this.config.mouseTail),s=()=>{if(!this.mouseTail)return;const a=this.mouseTail.getContext("2d");a&&this.tailPositions.length&&(a.clearRect(0,0,this.mouseTail.width,this.mouseTail.height),a.beginPath(),a.lineWidth=r,a.lineCap=n,a.strokeStyle=o,a.moveTo(this.tailPositions[0].x,this.tailPositions[0].y),this.tailPositions.forEach(l=>a.lineTo(l.x,l.y)),a.stroke())};this.tailPositions.push(t),s(),setTimeout(()=>{this.tailPositions=this.tailPositions.filter(a=>a!==t),s()},i/this.speedService.state.context.timer.speed)}hoverElements(t){var n;(n=this.iframe.contentDocument)===null||n===void 0||n.querySelectorAll(".\\:hover").forEach(o=>{o.classList.remove(":hover")});let r=t;for(;r;)r.classList&&r.classList.add(":hover"),r=r.parentElement}isUserInteraction(t){return t.type===re.IncrementalSnapshot&&t.data.source>Q.Mutation&&t.data.source<=Q.Input}backToNormal(){this.nextUserInteractionEvent=null,this.speedService.state.matches("normal")||(this.speedService.send({type:"BACK_TO_NORMAL"}),this.emitter.emit(X.SkipEnd,{speed:this.speedService.state.context.normalSpeed}))}warnNodeNotFound(t,n){this.warn(`Node with id '${n}' not found. `,t)}warnCanvasMutationFailed(t,n){this.warn("Has error on canvas update",n,"canvas mutation:",t)}debugNodeNotFound(t,n){this.debug("[replayer]",`Node with id '${n}' not found. `,t)}warn(...t){this.config.showWarning&&console.warn("[replayer]",...t)}debug(...t){this.config.showDebug&&console.log("[replayer]",...t)}}function Po(e){let t="";return Object.keys(e).forEach(n=>{t+=`${n}: ${e[n]};`}),t}function Et(e,t=2){let n=String(e);const r=Math.pow(10,t-1);if(e<r)for(;String(r).length>n.length;)n=`0${e}`;return n}function Jt(e){if(e<=0)return"00:00";const t=Math.floor(e/36e5);e%=36e5;const n=Math.floor(e/6e4);e%=6e4;const r=Math.floor(e/1e3);return t?`${Et(t)}:${Et(n)}:${Et(r)}`:`${Et(n)}:${Et(r)}`}function Vo(){let e=!1;return["fullscreen","webkitIsFullScreen","mozFullScreen","msFullscreenElement"].forEach(t=>{t in document&&(e=e||!!document[t])}),e}function Uo(e){return{"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Function]":"function","[object Array]":"array","[object Date]":"date","[object RegExp]":"regExp","[object Undefined]":"undefined","[object Null]":"null","[object Object]":"object"}[Object.prototype.toString.call(e)]}function Da(e){return e.type===re.IncrementalSnapshot&&e.data.source>Q.Mutation&&e.data.source<=Q.Input}function Fa(e){let t,n,r,o,i,s,a,l,c;return{c(){t=ce("div"),n=ce("input"),r=Ie(),o=ce("label"),i=Ie(),s=ce("span"),a=Ge(e[3]),P(n,"type","checkbox"),P(n,"id",e[2]),n.disabled=e[1],P(n,"class","svelte-9brlez"),P(o,"for",e[2]),P(o,"class","svelte-9brlez"),P(s,"class","label svelte-9brlez"),P(t,"class","switch svelte-9brlez"),nt(t,"disabled",e[1])},m(d,u){De(d,t,u),H(t,n),n.checked=e[0],H(t,r),H(t,o),H(t,i),H(t,s),H(s,a),l||(c=gt(n,"change",e[4]),l=!0)},p(d,[u]){4&u&&P(n,"id",d[2]),2&u&&(n.disabled=d[1]),1&u&&(n.checked=d[0]),4&u&&P(o,"for",d[2]),8&u&&_t(a,d[3]),2&u&&nt(t,"disabled",d[1])},i:Vt,o:Vt,d(d){d&&Te(t),l=!1,c()}}}function xa(e,t,n){let{disabled:r}=t,{checked:o}=t,{id:i}=t,{label:s}=t;return e.$$set=a=>{"disabled"in a&&n(1,r=a.disabled),"checked"in a&&n(0,o=a.checked),"id"in a&&n(2,i=a.id),"label"in a&&n(3,s=a.label)},[o,r,i,s,function(){o=this.checked,n(0,o)}]}class La extends Sn{constructor(t){super(),wn(this,t,xa,Fa,mn,{disabled:1,checked:0,id:2,label:3})}}function _o(e,t,n){const r=e.slice();return r[39]=t[n],r}function Go(e,t,n){const r=e.slice();return r[42]=t[n],r}function Zo(e,t,n){const r=e.slice();return r[45]=t[n],r}function Ko(e){let t,n,r,o,i,s,a,l,c,d,u,p,g,h,m,I,y,f,w,A,L,O,W,k,v,E,C=Jt(e[6])+"",b=Jt(e[8].totalTime)+"",M=e[14],T=[];for(let N=0;N<M.length;N+=1)T[N]=Yo(Zo(e,M,N));let V=e[9],x=[];for(let N=0;N<V.length;N+=1)x[N]=$o(Go(e,V,N));function S(N,_){return N[7]==="playing"?Wa:Oa}let U=S(e),F=U(e),G=e[3],q=[];for(let N=0;N<G.length;N+=1)q[N]=zo(_o(e,G,N));function j(N){e[30](N)}let J={id:"skip",disabled:e[10]==="skipping",label:"skip inactive"};return e[0]!==void 0&&(J.checked=e[0]),A=new La({props:J}),We.push(()=>function(N,_,R){const ne=N.$$.props[_];ne!==void 0&&(N.$$.bound[ne]=R,R(N.$$.ctx[ne]))}(A,"checked",j)),{c(){t=ce("div"),n=ce("div"),r=ce("span"),o=Ge(C),i=Ie(),s=ce("div"),a=ce("div"),l=Ie();for(let N=0;N<T.length;N+=1)T[N].c();c=Ie();for(let N=0;N<x.length;N+=1)x[N].c();d=Ie(),u=ce("div"),p=Ie(),g=ce("span"),h=Ge(b),m=Ie(),I=ce("div"),y=ce("button"),F.c(),f=Ie();for(let N=0;N<q.length;N+=1)q[N].c();w=Ie(),Kr(A.$$.fragment),O=Ie(),W=ce("button"),W.innerHTML=`<svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="16" height="16"><defs><style type="text/css"></style></defs><path d="M916 380c-26.4 0-48-21.6-48-48L868 223.2 613.6 477.6c-18.4
            18.4-48.8 18.4-68 0-18.4-18.4-18.4-48.8 0-68L800 156 692 156c-26.4
            0-48-21.6-48-48 0-26.4 21.6-48 48-48l224 0c26.4 0 48 21.6 48 48l0
            224C964 358.4 942.4 380 916 380zM231.2 860l108.8 0c26.4 0 48 21.6 48
            48s-21.6 48-48 48l-224 0c-26.4 0-48-21.6-48-48l0-224c0-26.4 21.6-48
            48-48 26.4 0 48 21.6 48 48L164 792l253.6-253.6c18.4-18.4 48.8-18.4
            68 0 18.4 18.4 18.4 48.8 0 68L231.2 860z" p-id="1286"></path></svg>`,P(r,"class","rr-timeline__time svelte-19ke1iv"),P(a,"class","rr-progress__step svelte-19ke1iv"),ae(a,"width",e[13]),P(u,"class","rr-progress__handler svelte-19ke1iv"),ae(u,"left",e[13]),P(s,"class","rr-progress svelte-19ke1iv"),nt(s,"disabled",e[10]==="skipping"),P(g,"class","rr-timeline__time svelte-19ke1iv"),P(n,"class","rr-timeline svelte-19ke1iv"),P(y,"class","svelte-19ke1iv"),P(W,"class","svelte-19ke1iv"),P(I,"class","rr-controller__btns svelte-19ke1iv"),P(t,"class","rr-controller svelte-19ke1iv")},m(N,_){De(N,t,_),H(t,n),H(n,r),H(r,o),H(n,i),H(n,s),H(s,a),e[27](a),H(s,l);for(let R=0;R<T.length;R+=1)T[R].m(s,null);H(s,c);for(let R=0;R<x.length;R+=1)x[R].m(s,null);H(s,d),H(s,u),e[28](s),H(n,p),H(n,g),H(g,h),H(t,m),H(t,I),H(I,y),F.m(y,null),H(I,f);for(let R=0;R<q.length;R+=1)q[R].m(I,null);H(I,w),vn(A,I,null),H(I,O),H(I,W),k=!0,v||(E=[gt(s,"click",e[16]),gt(y,"click",e[4]),gt(W,"click",e[31])],v=!0)},p(N,_){if((!k||64&_[0])&&C!==(C=Jt(N[6])+"")&&_t(o,C),(!k||8192&_[0])&&ae(a,"width",N[13]),16384&_[0]){let D;for(M=N[14],D=0;D<M.length;D+=1){const Y=Zo(N,M,D);T[D]?T[D].p(Y,_):(T[D]=Yo(Y),T[D].c(),T[D].m(s,c))}for(;D<T.length;D+=1)T[D].d(1);T.length=M.length}if(512&_[0]){let D;for(V=N[9],D=0;D<V.length;D+=1){const Y=Go(N,V,D);x[D]?x[D].p(Y,_):(x[D]=$o(Y),x[D].c(),x[D].m(s,d))}for(;D<x.length;D+=1)x[D].d(1);x.length=V.length}if((!k||8192&_[0])&&ae(u,"left",N[13]),1024&_[0]&&nt(s,"disabled",N[10]==="skipping"),(!k||256&_[0])&&b!==(b=Jt(N[8].totalTime)+"")&&_t(h,b),U!==(U=S(N))&&(F.d(1),F=U(N),F&&(F.c(),F.m(y,null))),1066&_[0]){let D;for(G=N[3],D=0;D<G.length;D+=1){const Y=_o(N,G,D);q[D]?q[D].p(Y,_):(q[D]=zo(Y),q[D].c(),q[D].m(I,w))}for(;D<q.length;D+=1)q[D].d(1);q.length=G.length}const R={};var ne;1024&_[0]&&(R.disabled=N[10]==="skipping"),!L&&1&_[0]&&(L=!0,R.checked=N[0],ne=()=>L=!1,fn.push(ne)),A.$set(R)},i(N){k||(Fe(A.$$.fragment,N),k=!0)},o(N){rt(A.$$.fragment,N),k=!1},d(N){N&&Te(t),e[27](null),gn(T,N),gn(x,N),e[28](null),F.d(),gn(q,N),bn(A),v=!1,tt(E)}}}function Yo(e){let t,n;return{c(){t=ce("div"),P(t,"title",n=e[45].name),ae(t,"width",e[45].width),ae(t,"height","4px"),ae(t,"position","absolute"),ae(t,"background",e[45].background),ae(t,"left",e[45].position)},m(r,o){De(r,t,o)},p(r,o){16384&o[0]&&n!==(n=r[45].name)&&P(t,"title",n),16384&o[0]&&ae(t,"width",r[45].width),16384&o[0]&&ae(t,"background",r[45].background),16384&o[0]&&ae(t,"left",r[45].position)},d(r){r&&Te(t)}}}function $o(e){let t,n;return{c(){t=ce("div"),P(t,"title",n=e[42].name),ae(t,"width","10px"),ae(t,"height","5px"),ae(t,"position","absolute"),ae(t,"top","2px"),ae(t,"transform","translate(-50%, -50%)"),ae(t,"background",e[42].background),ae(t,"left",e[42].position)},m(r,o){De(r,t,o)},p(r,o){512&o[0]&&n!==(n=r[42].name)&&P(t,"title",n),512&o[0]&&ae(t,"background",r[42].background),512&o[0]&&ae(t,"left",r[42].position)},d(r){r&&Te(t)}}}function Oa(e){let t,n;return{c(){t=Ut("svg"),n=Ut("path"),P(n,"d",`M170.65984 896l0-768 640 384zM644.66944
              512l-388.66944-233.32864 0 466.65728z`),P(t,"class","icon"),P(t,"viewBox","0 0 1024 1024"),P(t,"version","1.1"),P(t,"xmlns","http://www.w3.org/2000/svg"),P(t,"xmlns:xlink","http://www.w3.org/1999/xlink"),P(t,"width","16"),P(t,"height","16")},m(r,o){De(r,t,o),H(t,n)},d(r){r&&Te(t)}}}function Wa(e){let t,n;return{c(){t=Ut("svg"),n=Ut("path"),P(n,"d",`M682.65984 128q53.00224 0 90.50112 37.49888t37.49888 90.50112l0
              512q0 53.00224-37.49888 90.50112t-90.50112
              37.49888-90.50112-37.49888-37.49888-90.50112l0-512q0-53.00224
              37.49888-90.50112t90.50112-37.49888zM341.34016 128q53.00224 0
              90.50112 37.49888t37.49888 90.50112l0 512q0 53.00224-37.49888
              90.50112t-90.50112
              37.49888-90.50112-37.49888-37.49888-90.50112l0-512q0-53.00224
              37.49888-90.50112t90.50112-37.49888zM341.34016 213.34016q-17.67424
              0-30.16704 12.4928t-12.4928 30.16704l0 512q0 17.67424 12.4928
              30.16704t30.16704 12.4928 30.16704-12.4928
              12.4928-30.16704l0-512q0-17.67424-12.4928-30.16704t-30.16704-12.4928zM682.65984
              213.34016q-17.67424 0-30.16704 12.4928t-12.4928 30.16704l0 512q0
              17.67424 12.4928 30.16704t30.16704 12.4928 30.16704-12.4928
              12.4928-30.16704l0-512q0-17.67424-12.4928-30.16704t-30.16704-12.4928z`),P(t,"class","icon"),P(t,"viewBox","0 0 1024 1024"),P(t,"version","1.1"),P(t,"xmlns","http://www.w3.org/2000/svg"),P(t,"xmlns:xlink","http://www.w3.org/1999/xlink"),P(t,"width","16"),P(t,"height","16")},m(r,o){De(r,t,o),H(t,n)},d(r){r&&Te(t)}}}function zo(e){let t,n,r,o,i,s,a=e[39]+"";function l(){return e[29](e[39])}return{c(){t=ce("button"),n=Ge(a),r=Ge("x"),t.disabled=o=e[10]==="skipping",P(t,"class","svelte-19ke1iv"),nt(t,"active",e[39]===e[1]&&e[10]!=="skipping")},m(c,d){De(c,t,d),H(t,n),H(t,r),i||(s=gt(t,"click",l),i=!0)},p(c,d){e=c,8&d[0]&&a!==(a=e[39]+"")&&_t(n,a),1024&d[0]&&o!==(o=e[10]==="skipping")&&(t.disabled=o),1034&d[0]&&nt(t,"active",e[39]===e[1]&&e[10]!=="skipping")},d(c){c&&Te(t),i=!1,s()}}}function Ba(e){let t,n,r=e[2]&&Ko(e);return{c(){r&&r.c(),t=Ge("")},m(o,i){r&&r.m(o,i),De(o,t,i),n=!0},p(o,i){o[2]?r?(r.p(o,i),4&i[0]&&Fe(r,1)):(r=Ko(o),r.c(),Fe(r,1),r.m(t.parentNode,t)):r&&(Gr(),rt(r,1,1,()=>{r=null}),Zr())},i(o){n||(Fe(r),n=!0)},o(o){rt(r),n=!1},d(o){r&&r.d(o),o&&Te(t)}}}function Ho(e,t,n){return(100-(t-n)/(t-e)*100).toFixed(2)}function Pa(e,t,n){const r=Bs();let o,i,s,a,l,c,d,u,p,g,{replayer:h}=t,{showController:m}=t,{autoPlay:I}=t,{skipInactive:y}=t,{speedOption:f}=t,{speed:w=f.length?f[0]:1}=t,{tags:A={}}=t,{inactiveColor:L}=t,O=0,W=null,k=!1,v=null;const E=()=>{W&&(cancelAnimationFrame(W),W=null)},C=()=>{o==="paused"&&(l?(h.play(),l=!1):h.play(O))},b=()=>{o==="playing"&&(h.pause(),k=!1)},M=(S,U)=>{n(6,O=S),k=!1,(typeof U=="boolean"?U:o==="playing")?h.play(S):h.pause(S)},T=(S,U,F=!1,G)=>{v=F?{start:S,end:U}:null,n(6,O=S),k=U,c=G,h.play(S)},V=S=>{let U=o==="playing";n(1,w=S),U&&h.pause(),h.setConfig({speed:w}),U&&h.play(O)};var x;return Vr(()=>{n(7,o=h.service.state.value),n(10,i=h.speedService.state.value),h.on("state-change",S=>{const{player:U,speed:F}=S;if(U!=null&&U.value&&o!==U.value)switch(n(7,o=U.value),o){case"playing":E(),W=requestAnimationFrame(function G(){n(6,O=h.getCurrentTime()),k&&O>=k&&(v?T(v.start,v.end,!0,void 0):(h.pause(),c&&(c(),c=null))),O<d.totalTime&&(W=requestAnimationFrame(G))});break;case"paused":E()}F!=null&&F.value&&i!==F.value&&n(10,i=F.value)}),h.on("finish",()=>{l=!0,c&&(c(),c=null)}),I&&h.play()}),x=()=>{y!==h.config.skipInactive&&h.setConfig({skipInactive:y})},Gt().$$.after_update.push(x),Ur(()=>{h.pause(),E()}),e.$$set=S=>{"replayer"in S&&n(17,h=S.replayer),"showController"in S&&n(2,m=S.showController),"autoPlay"in S&&n(18,I=S.autoPlay),"skipInactive"in S&&n(0,y=S.skipInactive),"speedOption"in S&&n(3,f=S.speedOption),"speed"in S&&n(1,w=S.speed),"tags"in S&&n(19,A=S.tags),"inactiveColor"in S&&n(20,L=S.inactiveColor)},e.$$.update=()=>{if(64&e.$$.dirty[0]&&r("ui-update-current-time",{payload:O}),128&e.$$.dirty[0]&&r("ui-update-player-state",{payload:o}),131072&e.$$.dirty[0]&&n(8,d=h.getMetaData()),320&e.$$.dirty[0]){const S=Math.min(1,O/d.totalTime);n(13,u=100*S+"%"),r("ui-update-progress",{payload:S})}655360&e.$$.dirty[0]&&n(9,p=(()=>{const{context:S}=h.service.state,U=S.events.length,F=S.events[0].timestamp,G=S.events[U-1].timestamp,q=[];return S.events.forEach(j=>{if(j.type===re.Custom){const J={name:j.data.tag,background:A[j.data.tag]||"rgb(73, 80, 246)",position:`${Ho(F,G,j.timestamp)}%`};q.push(J)}}),q})()),1179648&e.$$.dirty[0]&&n(14,g=(()=>{try{const{context:S}=h.service.state,U=S.events.length,F=S.events[0].timestamp,G=S.events[U-1].timestamp,q=function(J){const N=[];let _=J[0].timestamp;for(const R of J)Da(R)&&(R.timestamp-_>1e4&&N.push([_,R.timestamp]),_=R.timestamp);return N}(S.events),j=(J,N,_,R)=>((R-_)/(N-J)*100).toFixed(2);return q.map(J=>({name:"inactive period",background:L,position:`${Ho(F,G,J[0])}%`,width:`${j(F,G,J[0],J[1])}%`}))}catch{return[]}})())},[y,w,m,f,()=>{switch(o){case"playing":b();break;case"paused":C()}},V,O,o,d,p,i,s,a,u,g,r,S=>{if(i==="skipping")return;const U=s.getBoundingClientRect();let F=(S.clientX-U.left)/U.width;F<0?F=0:F>1&&(F=1);const G=d.totalTime*F;l=!1,M(G)},h,I,A,L,C,b,M,T,()=>{n(0,y=!y)},()=>Promise.resolve().then(()=>{n(8,d=h.getMetaData())}),function(S){We[S?"unshift":"push"](()=>{a=S,n(12,a)})},function(S){We[S?"unshift":"push"](()=>{s=S,n(11,s)})},S=>V(S),function(S){y=S,n(0,y)},()=>r("fullscreen")]}class Va extends Sn{constructor(t){super(),wn(this,t,Pa,Ba,mn,{replayer:17,showController:2,autoPlay:18,skipInactive:0,speedOption:3,speed:1,tags:19,inactiveColor:20,toggle:4,play:21,pause:22,goto:23,playRange:24,setSpeed:5,toggleSkipInactive:25,triggerUpdateMeta:26},null,[-1,-1])}get toggle(){return this.$$.ctx[4]}get play(){return this.$$.ctx[21]}get pause(){return this.$$.ctx[22]}get goto(){return this.$$.ctx[23]}get playRange(){return this.$$.ctx[24]}get setSpeed(){return this.$$.ctx[5]}get toggleSkipInactive(){return this.$$.ctx[25]}get triggerUpdateMeta(){return this.$$.ctx[26]}}function Qo(e){let t,n,r={replayer:e[7],showController:e[3],autoPlay:e[1],speedOption:e[2],skipInactive:e[0],tags:e[4],inactiveColor:e[5]};return t=new Va({props:r}),e[32](t),t.$on("fullscreen",e[33]),{c(){Kr(t.$$.fragment)},m(o,i){vn(t,o,i),n=!0},p(o,i){const s={};128&i[0]&&(s.replayer=o[7]),8&i[0]&&(s.showController=o[3]),2&i[0]&&(s.autoPlay=o[1]),4&i[0]&&(s.speedOption=o[2]),1&i[0]&&(s.skipInactive=o[0]),16&i[0]&&(s.tags=o[4]),32&i[0]&&(s.inactiveColor=o[5]),t.$set(s)},i(o){n||(Fe(t.$$.fragment,o),n=!0)},o(o){rt(t.$$.fragment,o),n=!1},d(o){e[32](null),bn(t,o)}}}function Ua(e){let t,n,r,o,i=e[7]&&Qo(e);return{c(){t=ce("div"),n=ce("div"),r=Ie(),i&&i.c(),P(n,"class","rr-player__frame"),P(n,"style",e[11]),P(t,"class","rr-player"),P(t,"style",e[12])},m(s,a){De(s,t,a),H(t,n),e[31](n),H(t,r),i&&i.m(t,null),e[34](t),o=!0},p(s,a){(!o||2048&a[0])&&P(n,"style",s[11]),s[7]?i?(i.p(s,a),128&a[0]&&Fe(i,1)):(i=Qo(s),i.c(),Fe(i,1),i.m(t,null)):i&&(Gr(),rt(i,1,1,()=>{i=null}),Zr()),(!o||4096&a[0])&&P(t,"style",s[12])},i(s){o||(Fe(i),o=!0)},o(s){rt(i),o=!1},d(s){s&&Te(t),e[31](null),i&&i.d(),e[34](null)}}}function _a(e,t,n){let r,{width:o=1024}=t,{height:i=576}=t,{maxScale:s=1}=t,{events:a=[]}=t,{skipInactive:l=!0}=t,{autoPlay:c=!0}=t,{speedOption:d=[1,2,4,8]}=t,{speed:u=1}=t,{showController:p=!0}=t,{tags:g={}}=t,{inactiveColor:h="#D4D4D4"}=t,m,I,y,f,w,A,L=o,O=i;const W=(v,E)=>{const C=[o/E.width,i/E.height];s&&C.push(s),v.style.transform=`scale(${Math.min(...C)})translate(-50%, -50%)`},k=()=>{var v;m&&(Vo()?document.exitFullscreen?document.exitFullscreen():document.mozExitFullscreen?document.mozExitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen():(v=m).requestFullscreen?v.requestFullscreen():v.mozRequestFullScreen?v.mozRequestFullScreen():v.webkitRequestFullscreen?v.webkitRequestFullscreen():v.msRequestFullscreen&&v.msRequestFullscreen())};return Vr(()=>{if(d!==void 0&&Uo(d)!=="array")throw new Error("speedOption must be array");if(d.forEach(E=>{if(Uo(E)!=="number")throw new Error("item of speedOption must be number")}),d.indexOf(u)<0)throw new Error(`speed must be one of speedOption,
        current config:
        {
          ...
          speed: ${u},
          speedOption: [${d.toString()}]
          ...
        }
        `);var v;n(7,r=new ka(a,Object.assign({speed:u,root:I,unpackFn:ba},t))),r.on("resize",E=>{W(r.wrapper,E)}),v=()=>{Vo()?setTimeout(()=>{L=o,O=i,n(13,o=m.offsetWidth),n(14,i=m.offsetHeight-(p?80:0)),W(r.wrapper,{width:r.iframe.offsetWidth,height:r.iframe.offsetHeight})},0):(n(13,o=L),n(14,i=O),W(r.wrapper,{width:r.iframe.offsetWidth,height:r.iframe.offsetHeight}))},document.addEventListener("fullscreenchange",v),document.addEventListener("webkitfullscreenchange",v),document.addEventListener("mozfullscreenchange",v),document.addEventListener("MSFullscreenChange",v),y=()=>{document.removeEventListener("fullscreenchange",v),document.removeEventListener("webkitfullscreenchange",v),document.removeEventListener("mozfullscreenchange",v),document.removeEventListener("MSFullscreenChange",v)}}),Ur(()=>{y&&y()}),e.$$set=v=>{n(39,t=Or(Or({},t),Pr(v))),"width"in v&&n(13,o=v.width),"height"in v&&n(14,i=v.height),"maxScale"in v&&n(15,s=v.maxScale),"events"in v&&n(16,a=v.events),"skipInactive"in v&&n(0,l=v.skipInactive),"autoPlay"in v&&n(1,c=v.autoPlay),"speedOption"in v&&n(2,d=v.speedOption),"speed"in v&&n(17,u=v.speed),"showController"in v&&n(3,p=v.showController),"tags"in v&&n(4,g=v.tags),"inactiveColor"in v&&n(5,h=v.inactiveColor)},e.$$.update=()=>{24576&e.$$.dirty[0]&&n(11,w=Po({width:`${o}px`,height:`${i}px`})),24584&e.$$.dirty[0]&&n(12,A=Po({width:`${o}px`,height:`${i+(p?80:0)}px`}))},t=Pr(t),[l,c,d,p,g,h,k,r,m,I,f,w,A,o,i,s,a,u,()=>r.getMirror(),()=>{W(r.wrapper,{width:r.iframe.offsetWidth,height:r.iframe.offsetHeight})},(v,E)=>{switch(r.on(v,E),v){case"ui-update-current-time":case"ui-update-progress":case"ui-update-player-state":f.$on(v,({detail:C})=>E(C))}},v=>{r.addEvent(v),f.triggerUpdateMeta()},()=>r.getMetaData(),()=>r,()=>{f.toggle()},v=>{f.setSpeed(v)},()=>{f.toggleSkipInactive()},()=>{f.play()},()=>{f.pause()},(v,E)=>{f.goto(v,E)},(v,E,C=!1,b)=>{f.playRange(v,E,C,b)},function(v){We[v?"unshift":"push"](()=>{I=v,n(9,I)})},function(v){We[v?"unshift":"push"](()=>{f=v,n(10,f)})},()=>k(),function(v){We[v?"unshift":"push"](()=>{m=v,n(8,m)})}]}class Ga extends Sn{constructor(t){super(),wn(this,t,_a,Ua,mn,{width:13,height:14,maxScale:15,events:16,skipInactive:0,autoPlay:1,speedOption:2,speed:17,showController:3,tags:4,inactiveColor:5,getMirror:18,triggerResize:19,toggleFullscreen:6,addEventListener:20,addEvent:21,getMetaData:22,getReplayer:23,toggle:24,setSpeed:25,toggleSkipInactive:26,play:27,pause:28,goto:29,playRange:30},null,[-1,-1])}get getMirror(){return this.$$.ctx[18]}get triggerResize(){return this.$$.ctx[19]}get toggleFullscreen(){return this.$$.ctx[6]}get addEventListener(){return this.$$.ctx[20]}get addEvent(){return this.$$.ctx[21]}get getMetaData(){return this.$$.ctx[22]}get getReplayer(){return this.$$.ctx[23]}get toggle(){return this.$$.ctx[24]}get setSpeed(){return this.$$.ctx[25]}get toggleSkipInactive(){return this.$$.ctx[26]}get play(){return this.$$.ctx[27]}get pause(){return this.$$.ctx[28]}get goto(){return this.$$.ctx[29]}get playRange(){return this.$$.ctx[30]}}class Za extends Ga{constructor(t){super({target:t.target,props:t.data||t.props})}}const il="";let jt=[],Jo=null;const jo=document.createElement("div");jo.classList.add("recording-frame");const Ka=()=>{Ha(),Xo(),Jo=mt({emit(e){jt.push(e)},recordCanvas:!0})},Ya=()=>{qo(),Jo();const e=document.getElementById("record-player");za(e),setTimeout(()=>{new Za({target:e,props:{events:jt,height:qo(),skipInactive:!0}})},200),Qa()},Xo=()=>{jt=[]},$a=()=>{var n;const e=be(),t={eventType:ve.ScreenRecordDone,payload:{recorderedEvent:jt}};(n=e.panelIframe.contentWindow)==null||n.postMessage(t,ze)};function za(e){for(;e.firstChild;)e.removeChild(e.firstChild)}const Ha=()=>{document.body.classList.add(Yn),document.body.appendChild(jo)},qo=()=>{const e=window.innerHeight,t=document.querySelector(".record-player-frame");if(t){const n=window.getComputedStyle(t),r=parseInt(n.getPropertyValue("padding-top"),10);return e-(r*2+60+20)}return 0},Qa=()=>{document.body.classList.remove(Yn)},Ja=()=>{kt(n=>{const r=n(B.modules.widget.state).isControllerVisible;if(!B.modules.widget.state.isElementsMounted)return;const o=be();r?o.controllerWapper.style.visibility="visible":o.controllerWapper.style.visibility="hidden"});const{controllerFrameWrapperId:e,controllerFrameId:t}=B.modules.widget.state;return`<div id="${e}" class="controller-frame crowd-block rr-block " style="visibility: hidden;">
            <div class="controller-wrapper" style="background-color: white !important;">
              <div class="controller-drag">
                  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 3.75v4.5m0-4.5h4.5m-4.5 0L9 9M3.75 20.25v-4.5m0 4.5h4.5m-4.5 0L9 15M20.25 3.75h-4.5m4.5 0v4.5m0-4.5L15 9m5.25 11.25h-4.5m4.5 0v-4.5m0 4.5L15 15" />
                  </svg>
              </div>
              <iframe id="${t}" frameborder="0" allowtransparency="true"></iframe>
            </div>
        </div>`},ja=()=>{kt(t=>{const n=t(B.modules.widget.state).isRecordPlayerVisible;if(!B.modules.widget.state.isElementsMounted)return;const r=be();n?r.playerFrame.style.visibility="visible":r.playerFrame.style.visibility="hidden"});const{screenRecordPlayerFrameId:e}=B.modules.widget.state;return`<div id="${e}" class="record-player-frame" style="visibility: hidden;">
            <div class="player-action">
                <button type="button" id="delete-screen-record">Cancel</button>
                <button type="button" id="save-screen-record">Save video</button>
            </div>
            <div class="crowd-player-container" id="record-player"></div>
        </div>`},Xa=()=>{var e,t;(e=document.getElementById("delete-screen-record"))==null||e.addEventListener("click",()=>{Xo(),document.body.classList.remove("show-crowd-player"),B.modules.widget.action.updateWidgetSectionVisibility({isRecordPlayerVisible:!1,isPanelVisible:!0})}),(t=document.getElementById("save-screen-record"))==null||t.addEventListener("click",()=>{$a(),document.body.classList.remove("show-crowd-player"),B.modules.widget.action.updateWidgetSectionVisibility({isRecordPlayerVisible:!1,isPanelVisible:!0})})},ei=ze,qa=()=>{if(!document.getElementsByClassName("crowd-widget").length)if(window.CrowdApp&&window.CrowdApp.crowd_token){const t=window.CrowdApp.crowd_token;new el(t).setupWidgetContainer()}else console.error("Crowd App installation failed. Please ensure that you are using the correct code snippet")};class el{constructor(t){Ee(this,"integrationToken","");Ee(this,"widgetParentContainer",null);this.integrationToken=t}setupWidgetContainer(){B.modules.widget.action.generateElementIds(rn),this.widgetParentContainer=document.createElement("div"),this.widgetParentContainer.classList.add("crowd-widget"),this.widgetParentContainer.setAttribute("id",B.modules.widget.state.widgetContainerId),this.widgetParentContainer.innerHTML+=Si(),this.widgetParentContainer.innerHTML+=Ai(),this.widgetParentContainer.innerHTML+=Ja(),this.widgetParentContainer.innerHTML+=ja(),document.body.appendChild(this.widgetParentContainer),setTimeout(()=>{B.modules.widget.action.updateWidgetSectionVisibility({isElementsMounted:!0})},100),Ei(),window.addEventListener("message",t=>{t.origin===ei&&this.listenAndExecutePostMessageInteration(t)}),this.assignWidgetPanelAndLauncherEndpoints(),wi(),Xa(),window.addEventListener("popstate",sn.bind(this))}assignWidgetPanelAndLauncherEndpoints(){const t=be(),n=$n(this.integrationToken);if(t.launcherIframe&&t.panelIframe&&t.launcherIframe.contentWindow&&t.panelIframe.contentWindow){const{launcherEndpoint:r,panelEndpoint:o}=n;t.launcherIframe.contentWindow.location.href=r,t.panelIframe.contentWindow.location.href=o}}assignWidgetControllerEndpoints(){var r;const t=be(),n=$n(this.integrationToken);(r=t.controllerIframe)!=null&&r.contentWindow&&(t.controllerIframe.contentWindow.location.href=n.controllerEndpoint)}listenAndExecutePostMessageInteration(t){if(t.origin===ei)switch(t.data.eventType){case ve.LauncherLoaded:{if(B.modules.widget.action.updateIframeLoaded({isLauncherFrameLoaded:!0}),!t.data.payload.showFeedbackWidget){this.clearWidgetOnDeactivation();return}B.modules.widget.action.updateShouldShowLauncher(!t.data.payload.hideLauncherButton),B.modules.widget.action.updateDisplayRules(t.data.payload.displayRules),zn();break}case ve.LauncherResize:{Hn("Resize",t.data.payload);break}case ve.ImpressionRecorded:{Ci();break}case ve.PanelLoaded:{B.modules.widget.action.updateIframeLoaded({isPanelFrameLoaded:!0}),Jn("Position",t.data.payload),sn(),this.assignWidgetControllerEndpoints(),B.modules.widget.action.updateIframeLoaded({isControllerFrameLoaded:!0});break}case ve.PanelResize:{Jn("Resize",t.data.payload);break}case ve.OpenPanel:{B.modules.widget.action.updateWidgetSectionVisibility({isPanelVisible:!0,isLauncherVisible:!1});break}case ve.StartScreenRecord:{Ka(),B.modules.widget.action.updateWidgetSectionVisibility({isControllerVisible:!0,isPanelVisible:!1});break}case ve.StopScreenRecord:Ya(),document.body.classList.add("show-crowd-player"),B.modules.widget.action.updateWidgetSectionVisibility({isControllerVisible:!1,isRecordPlayerVisible:!0})}}clearWidgetOnDeactivation(){this.widgetParentContainer.remove()}}ci(),qa()});
